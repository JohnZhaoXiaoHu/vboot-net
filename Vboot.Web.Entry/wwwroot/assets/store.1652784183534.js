var tg=Object.defineProperty;var bl=Object.getOwnPropertySymbols;var ng=Object.prototype.hasOwnProperty,ig=Object.prototype.propertyIsEnumerable;var xl=(e,t,n)=>t in e?tg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ei=(e,t)=>{for(var n in t||(t={}))ng.call(t,n)&&xl(e,n,t[n]);if(bl)for(var n of bl(t))ig.call(t,n)&&xl(e,n,t[n]);return e};import{a as bi,z as vs}from"./index.1652784183534.js";import{a3 as rg,n as _l,ap as ag}from"./vue.1652784183534.js";var fA=(e,t)=>`<?xml version="1.0" encoding="UTF-8"?>
  <bpmn2:definitions 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL"
    xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
    xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
    xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
    xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"
    id="sample-diagram"
    targetNamespace="http://activiti.org/bpmn">
    <bpmn2:process id="Process_${e}" name="${t}" isExecutable="true">
    </bpmn2:process>
    <bpmndi:BPMNDiagram id="BPMNDiagram_1">
      <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_${e}">
      </bpmndi:BPMNPlane>
    </bpmndi:BPMNDiagram>
  </bpmn2:definitions>`;const og="Activiti",sg="http://activiti.org/bpmn",ug="activiti",cg={tagAlias:"lowerCase"},lg=[],pg=[{name:"Definitions",isAbstract:!0,extends:["bpmn:Definitions"],properties:[{name:"diagramRelationId",isAttr:!0,type:"String"}]},{name:"InOutBinding",superClass:["Element"],isAbstract:!0,properties:[{name:"source",isAttr:!0,type:"String"},{name:"sourceExpression",isAttr:!0,type:"String"},{name:"target",isAttr:!0,type:"String"},{name:"businessKey",isAttr:!0,type:"String"},{name:"local",isAttr:!0,type:"Boolean",default:!1},{name:"variables",isAttr:!0,type:"String"}]},{name:"In",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"Out",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"AsyncCapable",isAbstract:!0,extends:["bpmn:Activity","bpmn:Gateway","bpmn:Event"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1},{name:"asyncBefore",isAttr:!0,type:"Boolean",default:!1},{name:"asyncAfter",isAttr:!0,type:"Boolean",default:!1},{name:"exclusive",isAttr:!0,type:"Boolean",default:!0}]},{name:"JobPriorized",isAbstract:!0,extends:["bpmn:Process","activiti:AsyncCapable"],properties:[{name:"jobPriority",isAttr:!0,type:"String"}]},{name:"SignalEventDefinition",isAbstract:!0,extends:["bpmn:SignalEventDefinition"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1}]},{name:"ErrorEventDefinition",isAbstract:!0,extends:["bpmn:ErrorEventDefinition"],properties:[{name:"errorCodeVariable",isAttr:!0,type:"String"},{name:"errorMessageVariable",isAttr:!0,type:"String"}]},{name:"Error",isAbstract:!0,extends:["bpmn:Error"],properties:[{name:"activiti:errorMessage",isAttr:!0,type:"String"}]},{name:"PotentialStarter",superClass:["Element"],properties:[{name:"resourceAssignmentExpression",type:"bpmn:ResourceAssignmentExpression"}]},{name:"FormSupported",isAbstract:!0,extends:["bpmn:StartEvent","bpmn:UserTask"],properties:[{name:"formHandlerClass",isAttr:!0,type:"String"},{name:"formKey",isAttr:!0,type:"String"}]},{name:"TemplateSupported",isAbstract:!0,extends:["bpmn:Process","bpmn:FlowElement"],properties:[{name:"modelerTemplate",isAttr:!0,type:"String"}]},{name:"Initiator",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"initiator",isAttr:!0,type:"String"}]},{name:"ScriptTask",isAbstract:!0,extends:["bpmn:ScriptTask"],properties:[{name:"resultVariable",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"}]},{name:"Process",isAbstract:!0,extends:["bpmn:Process"],properties:[{name:"candidateStarterGroups",isAttr:!0,type:"String"},{name:"candidateStarterUsers",isAttr:!0,type:"String"},{name:"versionTag",isAttr:!0,type:"String"},{name:"historyTimeToLive",isAttr:!0,type:"String"},{name:"isStartableInTasklist",isAttr:!0,type:"Boolean",default:!0},{name:"executionListener",isAbstract:!0,type:"Expression"}]},{name:"EscalationEventDefinition",isAbstract:!0,extends:["bpmn:EscalationEventDefinition"],properties:[{name:"escalationCodeVariable",isAttr:!0,type:"String"}]},{name:"FormalExpression",isAbstract:!0,extends:["bpmn:FormalExpression"],properties:[{name:"resource",isAttr:!0,type:"String"}]},{name:"multiinstance_type",superClass:["Element"]},{name:"multiinstance_condition",superClass:["Element"]},{name:"Assignable",extends:["bpmn:UserTask"],properties:[{name:"assignee",isAttr:!0,type:"String"},{name:"candidateUsers",isAttr:!0,type:"String"},{name:"candidateGroups",isAttr:!0,type:"String"},{name:"dueDate",isAttr:!0,type:"String"},{name:"followUpDate",isAttr:!0,type:"String"},{name:"priority",isAttr:!0,type:"String"},{name:"multiinstance_condition",isAttr:!0,type:"String"}]},{name:"CallActivity",extends:["bpmn:CallActivity"],properties:[{name:"calledElementBinding",isAttr:!0,type:"String",default:"latest"},{name:"calledElementVersion",isAttr:!0,type:"String"},{name:"calledElementVersionTag",isAttr:!0,type:"String"},{name:"calledElementTenantId",isAttr:!0,type:"String"},{name:"caseRef",isAttr:!0,type:"String"},{name:"caseBinding",isAttr:!0,type:"String",default:"latest"},{name:"caseVersion",isAttr:!0,type:"String"},{name:"caseTenantId",isAttr:!0,type:"String"},{name:"variableMappingClass",isAttr:!0,type:"String"},{name:"variableMappingDelegateExpression",isAttr:!0,type:"String"}]},{name:"ServiceTaskLike",extends:["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"resultVariable",isAttr:!0,type:"String"}]},{name:"DmnCapable",extends:["bpmn:BusinessRuleTask"],properties:[{name:"decisionRef",isAttr:!0,type:"String"},{name:"decisionRefBinding",isAttr:!0,type:"String",default:"latest"},{name:"decisionRefVersion",isAttr:!0,type:"String"},{name:"mapDecisionResult",isAttr:!0,type:"String",default:"resultList"},{name:"decisionRefTenantId",isAttr:!0,type:"String"}]},{name:"ExternalCapable",extends:["activiti:ServiceTaskLike"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"topic",isAttr:!0,type:"String"}]},{name:"TaskPriorized",extends:["bpmn:Process","activiti:ExternalCapable"],properties:[{name:"taskPriority",isAttr:!0,type:"String"}]},{name:"Properties",superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"Property",isMany:!0}]},{name:"Property",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0}]},{name:"Connector",superClass:["Element"],meta:{allowedIn:["activiti:ServiceTaskLike"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"}]},{name:"InputOutput",superClass:["Element"],meta:{allowedIn:["bpmn:FlowNode","activiti:Connector"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"},{name:"inputParameters",isMany:!0,type:"InputParameter"},{name:"outputParameters",isMany:!0,type:"OutputParameter"}]},{name:"InputOutputParameter",properties:[{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"InputOutputParameterDefinition",isAbstract:!0},{name:"List",superClass:["InputOutputParameterDefinition"],properties:[{name:"items",isMany:!0,type:"InputOutputParameterDefinition"}]},{name:"Map",superClass:["InputOutputParameterDefinition"],properties:[{name:"entries",isMany:!0,type:"Entry"}]},{name:"Entry",properties:[{name:"key",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"Value",superClass:["InputOutputParameterDefinition"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Script",superClass:["InputOutputParameterDefinition"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Field",superClass:["Element"],meta:{allowedIn:["activiti:ServiceTaskLike","activiti:ExecutionListener","activiti:TaskListener"]},properties:[{name:"name",isAttr:!0,type:"String"},{name:"expression",type:"String"},{name:"stringValue",isAttr:!0,type:"String"},{name:"string",type:"String"}]},{name:"InputParameter",superClass:["InputOutputParameter"]},{name:"OutputParameter",superClass:["InputOutputParameter"]},{name:"Collectable",isAbstract:!0,extends:["bpmn:MultiInstanceLoopCharacteristics"],superClass:["activiti:AsyncCapable"],properties:[{name:"collection",isAttr:!0,type:"String"},{name:"elementVariable",isAttr:!0,type:"String"}]},{name:"FailedJobRetryTimeCycle",superClass:["Element"],meta:{allowedIn:["activiti:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"ExecutionListener",superClass:["Element"],meta:{allowedIn:["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"TaskListener",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"FormProperty",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"required",type:"String",isAttr:!0},{name:"readable",type:"String",isAttr:!0},{name:"writable",type:"String",isAttr:!0},{name:"variable",type:"String",isAttr:!0},{name:"expression",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"default",type:"String",isAttr:!0},{name:"values",type:"Value",isMany:!0}]},{name:"FormProperty",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"label",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"defaultValue",type:"String",isAttr:!0},{name:"properties",type:"Properties"},{name:"validation",type:"Validation"},{name:"values",type:"Value",isMany:!0}]},{name:"Validation",superClass:["Element"],properties:[{name:"constraints",type:"Constraint",isMany:!0}]},{name:"Constraint",superClass:["Element"],properties:[{name:"name",type:"String",isAttr:!0},{name:"config",type:"String",isAttr:!0}]},{name:"ConditionalEventDefinition",isAbstract:!0,extends:["bpmn:ConditionalEventDefinition"],properties:[{name:"variableName",isAttr:!0,type:"String"},{name:"variableEvent",isAttr:!0,type:"String"}]}],fg=[];var hA={name:og,uri:sg,prefix:ug,xml:cg,associations:lg,types:pg,emumerations:fg},hg={"Append EndEvent":"\u8FFD\u52A0\u7ED3\u675F\u4E8B\u4EF6","Append Gateway":"\u8FFD\u52A0\u7F51\u5173","Append Task":"\u8FFD\u52A0\u4EFB\u52A1","Append Intermediate/Boundary Event":"\u8FFD\u52A0\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6/\u8FB9\u754C\u4E8B\u4EF6","Activate the global connect tool":"\u6FC0\u6D3B\u5168\u5C40\u8FDE\u63A5\u5DE5\u5177","Append {type}":"\u6DFB\u52A0 {type}","Add Lane above":"\u5728\u4E0A\u9762\u6DFB\u52A0\u9053","Divide into two Lanes":"\u5206\u5272\u6210\u4E24\u4E2A\u9053","Divide into three Lanes":"\u5206\u5272\u6210\u4E09\u4E2A\u9053","Add Lane below":"\u5728\u4E0B\u9762\u6DFB\u52A0\u9053","Append compensation activity":"\u8FFD\u52A0\u8865\u507F\u6D3B\u52A8","Change type":"\u4FEE\u6539\u7C7B\u578B","Connect using Association":"\u4F7F\u7528\u5173\u8054\u8FDE\u63A5","Connect using Sequence/MessageFlow or Association":"\u4F7F\u7528\u987A\u5E8F/\u6D88\u606F\u6D41\u6216\u8005\u5173\u8054\u8FDE\u63A5","Connect using DataInputAssociation":"\u4F7F\u7528\u6570\u636E\u8F93\u5165\u5173\u8054\u8FDE\u63A5",Remove:"\u79FB\u9664","Activate the hand tool":"\u6FC0\u6D3B\u6293\u624B\u5DE5\u5177","Activate the lasso tool":"\u6FC0\u6D3B\u5957\u7D22\u5DE5\u5177","Activate the create/remove space tool":"\u6FC0\u6D3B\u521B\u5EFA/\u5220\u9664\u7A7A\u95F4\u5DE5\u5177","Create expanded SubProcess":"\u521B\u5EFA\u6269\u5C55\u5B50\u8FC7\u7A0B","Create IntermediateThrowEvent/BoundaryEvent":"\u521B\u5EFA\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6/\u8FB9\u754C\u4E8B\u4EF6","Create Pool/Participant":"\u521B\u5EFA\u6C60/\u53C2\u4E0E\u8005","Parallel Multi Instance":"\u5E76\u884C\u591A\u91CD\u4E8B\u4EF6","Sequential Multi Instance":"\u65F6\u5E8F\u591A\u91CD\u4E8B\u4EF6",DataObjectReference:"\u6570\u636E\u5BF9\u8C61\u53C2\u8003",DataStoreReference:"\u6570\u636E\u5B58\u50A8\u53C2\u8003",Loop:"\u5FAA\u73AF","Ad-hoc":"\u5373\u5E2D","Create {type}":"\u521B\u5EFA {type}",Task:"\u4EFB\u52A1","Send Task":"\u53D1\u9001\u4EFB\u52A1","Receive Task":"\u63A5\u6536\u4EFB\u52A1","User Task":"\u7528\u6237\u4EFB\u52A1","Manual Task":"\u624B\u5DE5\u4EFB\u52A1","Business Rule Task":"\u4E1A\u52A1\u89C4\u5219\u4EFB\u52A1","Service Task":"\u670D\u52A1\u4EFB\u52A1","Script Task":"\u811A\u672C\u4EFB\u52A1","Call Activity":"\u8C03\u7528\u6D3B\u52A8","Sub Process (collapsed)":"\u5B50\u6D41\u7A0B\uFF08\u6298\u53E0\u7684\uFF09","Sub Process (expanded)":"\u5B50\u6D41\u7A0B\uFF08\u5C55\u5F00\u7684\uFF09","Start Event":"\u5F00\u59CB\u4E8B\u4EF6",StartEvent:"\u5F00\u59CB\u4E8B\u4EF6","Intermediate Throw Event":"\u4E2D\u95F4\u4E8B\u4EF6","End Event":"\u7ED3\u675F\u4E8B\u4EF6",EndEvent:"\u7ED3\u675F\u4E8B\u4EF6","Create StartEvent":"\u521B\u5EFA\u5F00\u59CB\u4E8B\u4EF6","Create EndEvent":"\u521B\u5EFA\u7ED3\u675F\u4E8B\u4EF6","Create Task":"\u521B\u5EFA\u4EFB\u52A1","Create Gateway":"\u521B\u5EFA\u7F51\u5173","Create DataObjectReference":"\u521B\u5EFA\u6570\u636E\u5BF9\u8C61","Create DataStoreReference":"\u521B\u5EFA\u6570\u636E\u5B58\u50A8","Create Group":"\u521B\u5EFA\u5206\u7EC4","Create Intermediate/Boundary Event":"\u521B\u5EFA\u4E2D\u95F4/\u8FB9\u754C\u4E8B\u4EF6","Message Start Event":"\u6D88\u606F\u5F00\u59CB\u4E8B\u4EF6","Timer Start Event":"\u5B9A\u65F6\u5F00\u59CB\u4E8B\u4EF6","Conditional Start Event":"\u6761\u4EF6\u5F00\u59CB\u4E8B\u4EF6","Signal Start Event":"\u4FE1\u53F7\u5F00\u59CB\u4E8B\u4EF6","Error Start Event":"\u9519\u8BEF\u5F00\u59CB\u4E8B\u4EF6","Escalation Start Event":"\u5347\u7EA7\u5F00\u59CB\u4E8B\u4EF6","Compensation Start Event":"\u8865\u507F\u5F00\u59CB\u4E8B\u4EF6","Message Start Event (non-interrupting)":"\u6D88\u606F\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Timer Start Event (non-interrupting)":"\u5B9A\u65F6\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Conditional Start Event (non-interrupting)":"\u6761\u4EF6\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Signal Start Event (non-interrupting)":"\u4FE1\u53F7\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Escalation Start Event (non-interrupting)":"\u5347\u7EA7\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Message Intermediate Catch Event":"\u6D88\u606F\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Message Intermediate Throw Event":"\u6D88\u606F\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Timer Intermediate Catch Event":"\u5B9A\u65F6\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Escalation Intermediate Throw Event":"\u5347\u7EA7\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Conditional Intermediate Catch Event":"\u6761\u4EF6\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Link Intermediate Catch Event":"\u94FE\u63A5\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Link Intermediate Throw Event":"\u94FE\u63A5\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Compensation Intermediate Throw Event":"\u8865\u507F\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Signal Intermediate Catch Event":"\u4FE1\u53F7\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Signal Intermediate Throw Event":"\u4FE1\u53F7\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Message End Event":"\u6D88\u606F\u7ED3\u675F\u4E8B\u4EF6","Escalation End Event":"\u5B9A\u65F6\u7ED3\u675F\u4E8B\u4EF6","Error End Event":"\u9519\u8BEF\u7ED3\u675F\u4E8B\u4EF6","Cancel End Event":"\u53D6\u6D88\u7ED3\u675F\u4E8B\u4EF6","Compensation End Event":"\u8865\u507F\u7ED3\u675F\u4E8B\u4EF6","Signal End Event":"\u4FE1\u53F7\u7ED3\u675F\u4E8B\u4EF6","Terminate End Event":"\u7EC8\u6B62\u7ED3\u675F\u4E8B\u4EF6","Message Boundary Event":"\u6D88\u606F\u8FB9\u754C\u4E8B\u4EF6","Message Boundary Event (non-interrupting)":"\u6D88\u606F\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Timer Boundary Event":"\u5B9A\u65F6\u8FB9\u754C\u4E8B\u4EF6","Timer Boundary Event (non-interrupting)":"\u5B9A\u65F6\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Escalation Boundary Event":"\u5347\u7EA7\u8FB9\u754C\u4E8B\u4EF6","Escalation Boundary Event (non-interrupting)":"\u5347\u7EA7\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Conditional Boundary Event":"\u6761\u4EF6\u8FB9\u754C\u4E8B\u4EF6","Conditional Boundary Event (non-interrupting)":"\u6761\u4EF6\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Error Boundary Event":"\u9519\u8BEF\u8FB9\u754C\u4E8B\u4EF6","Cancel Boundary Event":"\u53D6\u6D88\u8FB9\u754C\u4E8B\u4EF6","Signal Boundary Event":"\u4FE1\u53F7\u8FB9\u754C\u4E8B\u4EF6","Signal Boundary Event (non-interrupting)":"\u4FE1\u53F7\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Compensation Boundary Event":"\u8865\u507F\u8FB9\u754C\u4E8B\u4EF6","Exclusive Gateway":"\u4E92\u65A5\u7F51\u5173","Parallel Gateway":"\u5E76\u884C\u7F51\u5173","Inclusive Gateway":"\u76F8\u5BB9\u7F51\u5173","Complex Gateway":"\u590D\u6742\u7F51\u5173","Event based Gateway":"\u4E8B\u4EF6\u7F51\u5173",Transaction:"\u8F6C\u8FD0","Sub Process":"\u5B50\u6D41\u7A0B","Event Sub Process":"\u4E8B\u4EF6\u5B50\u6D41\u7A0B","Collapsed Pool":"\u6298\u53E0\u6C60","Expanded Pool":"\u5C55\u5F00\u6C60","no parent for {element} in {parent}":"\u5728{parent}\u91CC\uFF0C{element}\u6CA1\u6709\u7236\u7C7B","no shape type specified":"\u6CA1\u6709\u6307\u5B9A\u7684\u5F62\u72B6\u7C7B\u578B","flow elements must be children of pools/participants":"\u6D41\u5143\u7D20\u5FC5\u987B\u662F\u6C60/\u53C2\u4E0E\u8005\u7684\u5B50\u7C7B","out of bounds release":"out of bounds release","more than {count} child lanes":"\u5B50\u9053\u5927\u4E8E{count} ","element required":"\u5143\u7D20\u4E0D\u80FD\u4E3A\u7A7A","diagram not part of bpmn:Definitions":"\u6D41\u7A0B\u56FE\u4E0D\u7B26\u5408bpmn\u89C4\u8303","no diagram to display":"\u6CA1\u6709\u53EF\u5C55\u793A\u7684\u6D41\u7A0B\u56FE","no process or collaboration to display":"\u6CA1\u6709\u53EF\u5C55\u793A\u7684\u6D41\u7A0B/\u534F\u4F5C","element {element} referenced by {referenced}#{property} not yet drawn":"\u7531{referenced}#{property}\u5F15\u7528\u7684{element}\u5143\u7D20\u4ECD\u672A\u7ED8\u5236","already rendered {element}":"{element} \u5DF2\u88AB\u6E32\u67D3","failed to import {element}":"\u5BFC\u5165{element}\u5931\u8D25",Id:"\u7F16\u53F7",Name:"\u540D\u79F0",General:"\u5E38\u89C4",Details:"\u8BE6\u60C5","Message Name":"\u6D88\u606F\u540D\u79F0",Message:"\u6D88\u606F",Initiator:"\u521B\u5EFA\u8005","Asynchronous Continuations":"\u6301\u7EED\u5F02\u6B65","Asynchronous Before":"\u5F02\u6B65\u524D","Asynchronous After":"\u5F02\u6B65\u540E","Job Configuration":"\u5DE5\u4F5C\u914D\u7F6E",Exclusive:"\u6392\u9664","Job Priority":"\u5DE5\u4F5C\u4F18\u5148\u7EA7","Retry Time Cycle":"\u91CD\u8BD5\u65F6\u95F4\u5468\u671F",Documentation:"\u6587\u6863","Element Documentation":"\u5143\u7D20\u6587\u6863","History Configuration":"\u5386\u53F2\u914D\u7F6E","History Time To Live":"\u5386\u53F2\u7684\u751F\u5B58\u65F6\u95F4",Forms:"\u8868\u5355","Form Key":"\u8868\u5355key","Form Fields":"\u8868\u5355\u5B57\u6BB5","Business Key":"\u4E1A\u52A1key","Form Field":"\u8868\u5355\u5B57\u6BB5",ID:"\u7F16\u53F7",Type:"\u7C7B\u578B",Label:"\u540D\u79F0","Default Value":"\u9ED8\u8BA4\u503C","Default Flow":"\u9ED8\u8BA4\u6D41\u8F6C\u8DEF\u5F84","Conditional Flow":"\u6761\u4EF6\u6D41\u8F6C\u8DEF\u5F84","Sequence Flow":"\u666E\u901A\u6D41\u8F6C\u8DEF\u5F84",Validation:"\u6821\u9A8C","Add Constraint":"\u6DFB\u52A0\u7EA6\u675F",Config:"\u914D\u7F6E",Properties:"\u5C5E\u6027","Add Property":"\u6DFB\u52A0\u5C5E\u6027",Value:"\u503C",Listeners:"\u76D1\u542C\u5668","Execution Listener":"\u6267\u884C\u76D1\u542C","Event Type":"\u4E8B\u4EF6\u7C7B\u578B","Listener Type":"\u76D1\u542C\u5668\u7C7B\u578B","Java Class":"Java\u7C7B",Expression:"\u8868\u8FBE\u5F0F","Must provide a value":"\u5FC5\u987B\u63D0\u4F9B\u4E00\u4E2A\u503C","Delegate Expression":"\u4EE3\u7406\u8868\u8FBE\u5F0F",Script:"\u811A\u672C","Script Format":"\u811A\u672C\u683C\u5F0F","Script Type":"\u811A\u672C\u7C7B\u578B","Inline Script":"\u5185\u8054\u811A\u672C","External Script":"\u5916\u90E8\u811A\u672C",Resource:"\u8D44\u6E90","Field Injection":"\u5B57\u6BB5\u6CE8\u5165",Extensions:"\u6269\u5C55","Input/Output":"\u8F93\u5165/\u8F93\u51FA","Input Parameters":"\u8F93\u5165\u53C2\u6570","Output Parameters":"\u8F93\u51FA\u53C2\u6570",Parameters:"\u53C2\u6570","Output Parameter":"\u8F93\u51FA\u53C2\u6570","Timer Definition Type":"\u5B9A\u65F6\u5668\u5B9A\u4E49\u7C7B\u578B","Timer Definition":"\u5B9A\u65F6\u5668\u5B9A\u4E49",Date:"\u65E5\u671F",Duration:"\u6301\u7EED",Cycle:"\u5FAA\u73AF",Signal:"\u4FE1\u53F7","Signal Name":"\u4FE1\u53F7\u540D\u79F0",Escalation:"\u5347\u7EA7",Error:"\u9519\u8BEF","Link Name":"\u94FE\u63A5\u540D\u79F0",Condition:"\u6761\u4EF6\u540D\u79F0","Variable Name":"\u53D8\u91CF\u540D\u79F0","Variable Event":"\u53D8\u91CF\u4E8B\u4EF6","Specify more than one variable change event as a comma separated list.":"\u591A\u4E2A\u53D8\u91CF\u4E8B\u4EF6\u4EE5\u9017\u53F7\u9694\u5F00","Wait for Completion":"\u7B49\u5F85\u5B8C\u6210","Activity Ref":"\u6D3B\u52A8\u53C2\u8003","Version Tag":"\u7248\u672C\u6807\u7B7E",Executable:"\u53EF\u6267\u884C\u6587\u4EF6","External Task Configuration":"\u6269\u5C55\u4EFB\u52A1\u914D\u7F6E","Task Priority":"\u4EFB\u52A1\u4F18\u5148\u7EA7",External:"\u5916\u90E8",Connector:"\u8FDE\u63A5\u5668","Must configure Connector":"\u5FC5\u987B\u914D\u7F6E\u8FDE\u63A5\u5668","Connector Id":"\u8FDE\u63A5\u5668\u7F16\u53F7",Implementation:"\u5B9E\u73B0\u65B9\u5F0F","Field Injections":"\u5B57\u6BB5\u6CE8\u5165",Fields:"\u5B57\u6BB5","Result Variable":"\u7ED3\u679C\u53D8\u91CF",Topic:"\u4E3B\u9898","Configure Connector":"\u914D\u7F6E\u8FDE\u63A5\u5668","Input Parameter":"\u8F93\u5165\u53C2\u6570",Assignee:"\u4EE3\u7406\u4EBA","Candidate Users":"\u5019\u9009\u7528\u6237","Candidate Groups":"\u5019\u9009\u7EC4","Due Date":"\u5230\u671F\u65F6\u95F4","Follow Up Date":"\u8DDF\u8E2A\u65E5\u671F",Priority:"\u4F18\u5148\u7EA7","The follow up date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"\u8DDF\u8E2A\u65E5\u671F\u5FC5\u987B\u7B26\u5408EL\u8868\u8FBE\u5F0F\uFF0C\u5982\uFF1A ${someDate} ,\u6216\u8005\u4E00\u4E2AISO\u6807\u51C6\u65E5\u671F\uFF0C\u5982\uFF1A2015-06-26T09:54:00","The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"\u8DDF\u8E2A\u65E5\u671F\u5FC5\u987B\u7B26\u5408EL\u8868\u8FBE\u5F0F\uFF0C\u5982\uFF1A ${someDate} ,\u6216\u8005\u4E00\u4E2AISO\u6807\u51C6\u65E5\u671F\uFF0C\u5982\uFF1A2015-06-26T09:54:00",Variables:"\u53D8\u91CF","Candidate Starter Configuration":"\u5019\u9009\u4EBA\u8D77\u52A8\u5668\u914D\u7F6E","Candidate Starter Groups":"\u5019\u9009\u4EBA\u8D77\u52A8\u5668\u7EC4","This maps to the process definition key.":"\u8FD9\u6620\u5C04\u5230\u6D41\u7A0B\u5B9A\u4E49\u952E\u3002","Candidate Starter Users":"\u5019\u9009\u4EBA\u8D77\u52A8\u5668\u7684\u7528\u6237","Specify more than one user as a comma separated list.":"\u6307\u5B9A\u591A\u4E2A\u7528\u6237\u4F5C\u4E3A\u9017\u53F7\u5206\u9694\u7684\u5217\u8868\u3002","Tasklist Configuration":"Tasklist\u914D\u7F6E",Startable:"\u542F\u52A8","Specify more than one group as a comma separated list.":"\u6307\u5B9A\u591A\u4E2A\u7EC4\u4F5C\u4E3A\u9017\u53F7\u5206\u9694\u7684\u5217\u8868\u3002"};const dg={zh:hg};function dA(e){const t=dg[e];return function(i,r){return r=r||{},i=t[i]||i,i.replace(/{([^}]+)}/g,function(a,o){return r[o]||"{"+o+"}"})}}const wl={"./modules/Event.tsx":()=>bi(()=>import("./Event.1652784183534.js"),["assets/Event.1652784183534.js","assets/common.1652784183534.js","assets/common.1652784183534.css","assets/index.1652784183534.js","assets/index.165278418353429.css","assets/vue.1652784183534.js"]),"./modules/Flow.tsx":()=>bi(()=>import("./Flow.1652784183534.js"),["assets/Flow.1652784183534.js","assets/common.1652784183534.js","assets/common.1652784183534.css","assets/index.1652784183534.js","assets/index.165278418353429.css","assets/vue.1652784183534.js","assets/PrefixLabelSelect.1652784183534.js","assets/PrefixLabelSelect.1652784183534.css"]),"./modules/Gateway.tsx":()=>bi(()=>import("./Gateway.1652784183534.js"),["assets/Gateway.1652784183534.js","assets/common.1652784183534.js","assets/common.1652784183534.css","assets/index.1652784183534.js","assets/index.165278418353429.css","assets/vue.1652784183534.js"]),"./modules/Other.tsx":()=>bi(()=>import("./Other.1652784183534.js"),["assets/Other.1652784183534.js","assets/common.1652784183534.js","assets/common.1652784183534.css","assets/index.1652784183534.js","assets/index.165278418353429.css","assets/vue.1652784183534.js"]),"./modules/Process.tsx":()=>bi(()=>import("./Process.1652784183534.js"),["assets/Process.1652784183534.js","assets/common.1652784183534.js","assets/common.1652784183534.css","assets/index.1652784183534.js","assets/index.165278418353429.css","assets/vue.1652784183534.js"]),"./modules/Task.tsx":()=>bi(()=>import("./Task.1652784183534.js"),["assets/Task.1652784183534.js","assets/common.1652784183534.js","assets/common.1652784183534.css","assets/index.1652784183534.js","assets/index.165278418353429.css","assets/vue.1652784183534.js","assets/PrefixLabelSelect.1652784183534.js","assets/PrefixLabelSelect.1652784183534.css"])},mg=()=>{const e={};for(const t in wl)wl[t]().then(n=>{const i=n.default;for(const r in i)e[r]=i[r]});return e};var vg=mg();const gg={"bpmn:Process":"\u6D41\u7A0B","bpmn:SubProcess":"\u5B50\u6D41\u7A0B"},yg={"bpmn:StartEvent":"\u5F00\u59CB\u4E8B\u4EF6","bpmn:EndEvent":"\u7ED3\u675F\u4E8B\u4EF6","bpmn:MessageEventDefinition":"\u6D88\u606F","bpmn:TimerEventDefinition":"\u5B9A\u65F6","bpmn:ConditionalEventDefinition":"\u6761\u4EF6","bpmn:SignalEventDefinition":"\u4FE1\u53F7"},Eg={"bpmn:SequenceFlow":e=>{const t="\u987A\u5E8F\u6D41";return e.conditionExpression?"\u6761\u4EF6"+t:e.sourceRef.default?"\u9ED8\u8BA4"+t:t}},bg={"bpmn:ExclusiveGateway":"\u4E92\u65A5\u7F51\u5173","bpmn:ParallelGateway":"\u5E76\u884C\u7F51\u5173","bpmn:ComplexGateway":"\u590D\u6742\u7F51\u5173","bpmn:EventBasedGateway":"\u4E8B\u4EF6\u7F51\u5173"},xg={"bpmn:Task":"\u666E\u901A\u4EFB\u52A1","bpmn:UserTask":"\u7528\u6237\u4EFB\u52A1","bpmn:ReceiveTask":"\u63A5\u6536\u4EFB\u52A1","bpmn:SendTask":"\u53D1\u9001\u4EFB\u52A1","bpmn:ManualTask":"\u624B\u5DE5\u4EFB\u52A1","bpmn:BusinessRuleTask":"\u4E1A\u52A1\u89C4\u5219\u4EFB\u52A1","bpmn:ServiceTask":"\u670D\u52A1\u4EFB\u52A1","bpmn:ScriptTask":"\u811A\u672C\u4EFB\u52A1","bpmn:CallActivity":"\u8C03\u7528\u4EFB\u52A1"},_g={"bpmn:Participant":"\u6C60/\u53C2\u4E0E\u8005","bpmn:Group":"\u5206\u7EC4","bpmn:DataStoreReference":"\u6570\u636E\u5B58\u50A8","bpmn:DataObjectReference":"\u6570\u636E\u5BF9\u8C61"},Sl=ei(ei(ei(ei(ei(ei({},gg),yg),Eg),bg),xg),_g),wg=e=>{const t=e.eventDefinitions,n=Sl[e.$type];return typeof n=="function"?n(e):t?Sl[t[0].$type]+n:n};var Ls={exports:{}};typeof Object.create=="function"?Ls.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Ls.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}};var Z=Ls.exports;function Sg(e,t){return t={exports:{}},e(t,t.exports),t.exports}var Cg=Sg(function(e){var t=e.exports=function(n,i){if(i||(i=16),n===void 0&&(n=128),n<=0)return"0";for(var r=Math.log(Math.pow(2,n))/Math.log(i),a=2;r===1/0;a*=2)r=Math.log(Math.pow(2,n/a))/Math.log(i)*a;for(var o=r-Math.floor(r),s="",a=0;a<Math.floor(r);a++){var u=Math.floor(Math.random()*i).toString(i);s=u+s}if(o){var c=Math.pow(i,o),u=Math.floor(Math.random()*c).toString(i);s=u+s}var l=parseInt(s,i);return l!==1/0&&l>=Math.pow(2,n)?t(n,i):s};t.rack=function(n,i,r){var a=function(s){var u=0;do{if(u++>10)if(r)n+=r;else throw new Error("too many ID collisions, use more bits");var c=t(n,i)}while(Object.hasOwnProperty.call(o,c));return o[c]=s,c},o=a.hats={};return a.get=function(s){return a.hats[s]},a.set=function(s,u){return a.hats[s]=u,a},a.bits=n||128,a.base=i||16,a}});function an(e){if(!(this instanceof an))return new an(e);e=e||[128,36,1],this._seed=e.length?Cg.rack(e[0],e[1],e[2]):e}an.prototype.next=function(e){return this._seed(e||!0)};an.prototype.nextPrefixed=function(e,t){var n;do n=e+this.next(!0);while(this.assigned(n));return this.claim(n,t),n};an.prototype.claim=function(e,t){this._seed.set(e,t||!0)};an.prototype.assigned=function(e){return this._seed.get(e)||!1};an.prototype.unclaim=function(e){delete this._seed.hats[e]};an.prototype.clear=function(){var e=this._seed.hats,t;for(t in e)this.unclaim(t)};function Ya(e){return Array.prototype.concat.apply([],e)}var Pr=Object.prototype.toString,Tg=Object.prototype.hasOwnProperty;function Dr(e){return e===void 0}function tn(e){return e!==void 0}function Cl(e){return e==null}function he(e){return Pr.call(e)==="[object Array]"}function Qe(e){return Pr.call(e)==="[object Object]"}function ae(e){return Pr.call(e)==="[object Number]"}function ot(e){var t=Pr.call(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object AsyncGeneratorFunction]"||t==="[object Proxy]"}function Dt(e){return Pr.call(e)==="[object String]"}function Ag(e){if(!he(e))throw new Error("must supply array")}function mn(e,t){return Tg.call(e,t)}function _e(e,t){t=Cu(t);var n;return A(e,function(i,r){if(t(i,r))return n=i,!1}),n}function Rg(e,t){t=Cu(t);var n=he(e)?-1:void 0;return A(e,function(i,r){if(t(i,r))return n=r,!1}),n}function se(e,t){var n=[];return A(e,function(i,r){t(i,r)&&n.push(i)}),n}function A(e,t){var n,i;if(!Dr(e)){var r=he(e)?Bg:Mg;for(var a in e)if(mn(e,a)&&(n=e[a],i=t(n,r(a)),i===!1))return n}}function Pg(e,t){return Dr(e)?[]:(Ag(e),t=Cu(t),e.filter(function(n,i){return!t(n,i)}))}function wt(e,t,n){return A(e,function(i,r){n=t(n,i,r)}),n}function Fi(e,t){return!!wt(e,function(n,i,r){return n&&t(i,r)},!0)}function ci(e,t){return!!_e(e,t)}function Ye(e,t){var n=[];return A(e,function(i,r){n.push(t(i,r))}),n}function qa(e){return e&&Object.keys(e)||[]}function _r(e){return qa(e).length}function wu(e){return Ye(e,function(t){return t})}function ki(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t=Su(t),A(e,function(i){var r=t(i)||"_",a=n[r];a||(a=n[r]=[]),a.push(i)}),n}function fh(e){e=Su(e);for(var t={},n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];A(i,function(o){return ki(o,e,t)});var a=Ye(t,function(o,s){return o[0]});return a}var Dg=fh;function Vt(e,t){t=Su(t);var n=[];return A(e,function(i,r){for(var a=t(i,r),o={d:a,v:i},s=0;s<n.length;s++){var u=n[s].d;if(a<u){n.splice(s,0,o);return}}n.push(o)}),Ye(n,function(i){return i.v})}function Gt(e){return function(t){return Fi(e,function(n,i){return t[i]===n})}}function Su(e){return ot(e)?e:function(t){return t[e]}}function Cu(e){return ot(e)?e:function(t){return t===e}}function Mg(e){return e}function Bg(e){return Number(e)}function hh(e,t){var n,i,r,a;function o(p){var h=Date.now(),f=p?0:a+t-h;if(f>0)return s(f);e.apply(r,i),u()}function s(p){n=setTimeout(o,p)}function u(){n&&clearTimeout(n),n=a=i=r=void 0}function c(){n&&o(!0),u()}function l(){a=Date.now();for(var p=arguments.length,h=new Array(p),f=0;f<p;f++)h[f]=arguments[f];i=h,r=this,n||s(t)}return l.flush=c,l.cancel=u,l}function ft(e,t){return e.bind(t)}function $s(){return $s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},$s.apply(this,arguments)}function I(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return $s.apply(void 0,[e].concat(n))}function Wt(e,t){var n={},i=Object(e);return A(t,function(r){r in i&&(n[r]=e[r])}),n}function $n(e,t){var n={},i=Object(e);return A(i,function(r,a){t.indexOf(a)===-1&&(n[a]=r)}),n}function St(e,t,n){return arguments.length==2?e.getAttribute(t):n===null?e.removeAttribute(t):(e.setAttribute(t,n),e)}var Og=[].indexOf,Tu=function(e,t){if(Og)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},Ig=/\s+/,Ng=Object.prototype.toString;function ze(e){return new In(e)}function In(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}In.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=Tu(t,e);return~n||t.push(e),this.el.className=t.join(" "),this};In.prototype.remove=function(e){if(Ng.call(e)=="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=Tu(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this};In.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};In.prototype.toggle=function(e,t){return this.list?(typeof t!="undefined"?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(typeof t!="undefined"?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};In.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(Ig);return n[0]===""&&n.shift(),n};In.prototype.has=In.prototype.contains=function(e){return this.list?this.list.contains(e):!!~Tu(this.array(),e)};function fo(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e}var xi=typeof Element!="undefined"?Element.prototype:{},Tl=xi.matches||xi.matchesSelector||xi.webkitMatchesSelector||xi.mozMatchesSelector||xi.msMatchesSelector||xi.oMatchesSelector,Ka=Fg;function Fg(e,t){if(!e||e.nodeType!==1)return!1;if(Tl)return Tl.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1}function li(e,t,n){for(var i=n?e:e.parentNode;i&&i.nodeType!==document.DOCUMENT_NODE&&i.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if(Ka(i,t))return i;i=i.parentNode}return Ka(i,t)?i:null}var dh=window.addEventListener?"addEventListener":"attachEvent",kg=window.removeEventListener?"removeEventListener":"detachEvent",mh=dh!=="addEventListener"?"on":"",Lg=function(e,t,n,i){return e[dh](mh+t,n,i||!1),n},$g=function(e,t,n,i){return e[kg](mh+t,n,i||!1),n},te={bind:Lg,unbind:$g},vh=["focus","blur"];function jg(e,t,n,i,r){return vh.indexOf(n)!==-1&&(r=!0),te.bind(e,n,function(a){var o=a.target||a.srcElement;a.delegateTarget=li(o,t,!0),a.delegateTarget&&i.call(e,a)},r)}function Hg(e,t,n,i){return vh.indexOf(t)!==-1&&(i=!0),te.unbind(e,t,n,i)}var xt={bind:jg,unbind:Hg},Ae=zg,gh=!1,ha;typeof document!="undefined"&&(ha=document.createElement("div"),ha.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',gh=!ha.getElementsByTagName("link").length,ha=void 0);var je={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:gh?[1,"X<div>","</div>"]:[0,"",""]};je.td=je.th=[3,"<table><tbody><tr>","</tr></tbody></table>"];je.option=je.optgroup=[1,'<select multiple="multiple">',"</select>"];je.thead=je.tbody=je.colgroup=je.caption=je.tfoot=[1,"<table>","</table>"];je.polyline=je.ellipse=je.polygon=je.circle=je.text=je.line=je.path=je.rect=je.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function zg(e,t){if(typeof e!="string")throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if(i=="body"){var u=t.createElement("html");return u.innerHTML=e,u.removeChild(u.lastChild)}var r=je[i]||je._default,a=r[0],o=r[1],s=r[2],u=t.createElement("div");for(u.innerHTML=o+e+s;a--;)u=u.lastChild;if(u.firstChild==u.lastChild)return u.removeChild(u.firstChild);for(var c=t.createDocumentFragment();u.firstChild;)c.appendChild(u.removeChild(u.firstChild));return c}function Oe(e,t){return t=t||document,t.querySelector(e)}function js(e,t){return t=t||document,t.querySelectorAll(e)}function on(e){e.parentNode&&e.parentNode.removeChild(e)}function Gg(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch{}return e}function yh(e,t){return t.appendChild(Gg(e,t))}function ne(e,t){return yh(t,e),e}var Hs=2,Eh={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":Hs,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":Hs,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function Vg(e,t){return Eh[t]?e.style[t]:e.getAttributeNS(null,t)}function bh(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=Eh[i];r?(r===Hs&&typeof n=="number"&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function Wg(e,t){var n=Object.keys(t),i,r;for(i=0,r;r=n[i];i++)bh(e,r,t[r])}function H(e,t,n){if(typeof t=="string")if(n!==void 0)bh(e,t,n);else return Vg(e,t);else Wg(e,t);return e}function Au(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var Ug=/\s+/,Yg=Object.prototype.toString;function zs(e){return typeof e!="undefined"}function fe(e){return new Nn(e)}function Nn(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}Nn.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=Au(t,e);return~n||t.push(e),zs(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this};Nn.prototype.remove=function(e){if(Yg.call(e)==="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=Au(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this};Nn.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};Nn.prototype.toggle=function(e,t){return this.list?(zs(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(zs(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};Nn.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(Ug);return n[0]===""&&n.shift(),n};Nn.prototype.has=Nn.prototype.contains=function(e){return this.list?this.list.contains(e):!!~Au(this.array(),e)};function ke(e){var t=e.parentNode;return t&&t.removeChild(e),e}function Ru(e){for(var t;t=e.firstChild;)ke(t);return e}function xh(e){return e.cloneNode(!0)}var Pu={svg:"http://www.w3.org/2000/svg"},Al='<svg xmlns="'+Pu.svg+'"';function _h(e){var t=!1;e.substring(0,4)==="<svg"?e.indexOf(Pu.svg)===-1&&(e=Al+e.substring(4)):(e=Al+">"+e+"</svg>",t=!0);var n=qg(e);if(!t)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function qg(e){var t;return t=new DOMParser,t.async=!1,t.parseFromString(e,"text/xml")}function J(e,t){var n;return e.charAt(0)==="<"?(n=_h(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(Pu.svg,e),t&&H(n,t),n}var Gs=J("svg");function Rl(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)e[i]=t[i];return e}function Kg(e,t,n,i,r,a){var o=Gs.createSVGMatrix();switch(arguments.length){case 0:return o;case 1:return Rl(o,e);case 6:return Rl(o,{a:e,b:t,c:n,d:i,e:r,f:a})}}function dr(e){return e?Gs.createSVGTransformFromMatrix(e):Gs.createSVGTransform()}var Pl=/([&<>]{1})/g,Xg=/([\n\r"]{1})/g,Zg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function gs(e,t){function n(i,r){return Zg[r]||r}return e.replace(t,n)}function wh(e,t){var n,i,r,a,o;switch(e.nodeType){case 3:t.push(gs(e.textContent,Pl));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(r=e.attributes,n=0,i=r.length;n<i;++n)a=r.item(n),t.push(" ",a.name,'="',gs(a.value,Xg),'"');if(e.hasChildNodes()){for(t.push(">"),o=e.childNodes,n=0,i=o.length;n<i;++n)wh(o.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("<!--",gs(e.nodeValue,Pl),"-->");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function Jg(e,t){var n=_h(t);if(Ru(e),!!t){ey(n)||(n=n.documentElement);for(var i=ty(n.childNodes),r=0;r<i.length;r++)yh(i[r],e)}}function Qg(e){for(var t=e.firstChild,n=[];t;)wh(t,n),t=t.nextSibling;return n.join("")}function ey(e){return e.nodeName==="#document-fragment"}function Dl(e,t){if(t!==void 0){try{Jg(e,t)}catch(n){throw new Error("error parsing SVG: "+n.message)}return e}else return Qg(e)}function ty(e){return Array.prototype.slice.call(e)}function ny(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}function iy(e,t){var n,i;for(e.clear(),n=0;i=t[n];n++)e.appendItem(ny(e,i))}function wr(e,t){var n=e.transform.baseVal;return t&&(Array.isArray(t)||(t=[t]),iy(n,t)),n.consolidate()}var ry=/^class /;function ay(e){return ry.test(e.toString())}function Vs(e){return Object.prototype.toString.call(e)==="[object Array]"}function ys(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function da(){var e=Array.prototype.slice.call(arguments);e.length===1&&Vs(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var oy=/constructor\s*[^(]*\(\s*([^)]*)\)/m,sy=/^(?:async )?(?:function\s*)?[^(]*\(\s*([^)]*)\)/m,uy=/\/\*([^*]*)\*\//m;function cy(e){if(typeof e!="function")throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(ay(e)?oy:sy);return t?t[1]&&t[1].split(",").map(function(n){return t=n.match(uy),t?t[1].trim():n.trim()})||[]:[]}function ly(){var e=[];this.factory=function(t,n){return e.push([t,"factory",n]),this},this.value=function(t,n){return e.push([t,"value",n]),this},this.type=function(t,n){return e.push([t,"type",n]),this},this.forEach=function(t){e.forEach(t)}}function Ws(e,t){t=t||{get:function(d,y){if(n.push(d),y===!1)return null;throw o('No provider for "'+d+'"!')}};var n=[],i=this._providers=Object.create(t._providers||null),r=this._instances=Object.create(null),a=r.injector=this,o=function(d){var y=n.join(" -> ");return n.length=0,new Error(y?d+" (Resolving: "+y+")":d)},s=function(d,y){if(!i[d]&&d.indexOf(".")!==-1){for(var x=d.split("."),M=s(x.shift());x.length;)M=M[x.shift()];return M}if(ys(r,d))return r[d];if(ys(i,d)){if(n.indexOf(d)!==-1)throw n.push(d),o("Cannot resolve circular dependency!");return n.push(d),r[d]=i[d][0](i[d][1]),n.pop(),r[d]}return t.get(d,y)},u=function(d,y){if(typeof y=="undefined"&&(y={}),typeof d!="function")if(Vs(d))d=da(d.slice());else throw new Error('Cannot invoke "'+d+'". Expected a function!');var x=d.$inject||cy(d),M=x.map(function(P){return ys(y,P)?y[P]:s(P)});return{fn:d,dependencies:M}},c=function(d){var y=u(d),x=y.fn,M=y.dependencies,P=Function.prototype.bind.apply(x,[null].concat(M));return new P},l=function(d,y,x){var M=u(d,x),P=M.fn,w=M.dependencies;return P.apply(y,w)},p=function(d){return da(function(y){return d.get(y)})},h=function(d,y){if(y&&y.length){var x=Object.create(null),M=Object.create(null),P=[],w=[],b=[],_,D,B,R;for(var L in i)_=i[L],y.indexOf(L)!==-1&&(_[2]==="private"?(D=P.indexOf(_[3]),D===-1?(B=_[3].createChild([],y),R=p(B),P.push(_[3]),w.push(B),b.push(R),x[L]=[R,L,"private",B]):x[L]=[b[D],L,"private",w[D]]):x[L]=[_[2],_[1]],M[L]=!0),(_[2]==="factory"||_[2]==="type")&&_[1].$scope&&y.forEach(function(z){_[1].$scope.indexOf(z)!==-1&&(x[L]=[_[2],_[1]],M[z]=!0)});y.forEach(function(z){if(!M[z])throw new Error('No provider for "'+z+'". Cannot use provider from the parent!')}),d.unshift(x)}return new Ws(d,a)},f={factory:l,type:c,value:function(d){return d}};e.forEach(function(d){function y(w,b){return w!=="value"&&Vs(b)&&(b=da(b.slice())),b}if(d instanceof ly)d.forEach(function(w){var b=w[0],_=w[1],D=w[2];i[b]=[f[_],y(_,D),_]});else if(typeof d=="object")if(d.__exports__){var x=Object.keys(d).reduce(function(w,b){return b.substring(0,2)!=="__"&&(w[b]=d[b]),w},Object.create(null)),M=new Ws((d.__modules__||[]).concat([x]),a),P=da(function(w){return M.get(w)});d.__exports__.forEach(function(w){i[w]=[P,w,"private",M]})}else Object.keys(d).forEach(function(w){if(d[w][2]==="private"){i[w]=d[w];return}var b=d[w][0],_=d[w][1];i[w]=[f[b],y(b,_),b]})}),this.get=s,this.invoke=l,this.instantiate=c,this.createChild=h}var py=1e3;function En(e,t){var n=this;t=t||py,e.on(["render.shape","render.connection"],t,function(i,r){var a=i.type,o=r.element,s=r.gfx,u=r.attrs;if(n.canRender(o))return a==="render.shape"?n.drawShape(s,o,u):n.drawConnection(s,o,u)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(i,r){if(n.canRender(r))return i.type==="render.getShapePath"?n.getShapePath(r):n.getConnectionPath(r)})}En.prototype.canRender=function(){};En.prototype.drawShape=function(){};En.prototype.drawConnection=function(){};En.prototype.getShapePath=function(){};En.prototype.getConnectionPath=function(){};function Li(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")}function Sh(e){for(var t="",n=0,i;i=e[n];n++)t+=i.x+","+i.y+" ";return t}function Du(e,t){var n=J("polyline");return H(n,{points:Sh(e)}),t&&H(n,t),n}function fy(e,t){return H(e,{points:Sh(t)}),e}function Ch(e){return se(e,function(t){return!_e(e,function(n){return n!==t&&Th(t,n)})})}function Th(e,t){if(!!t){if(e===t)return t;if(!!e.parent)return Th(e.parent,t)}}function Ml(e,t,n){var i=!n||e.indexOf(t)===-1;return i&&e.push(t),i}function pi(e,t,n){n=n||0,he(e)||(e=[e]),A(e,function(i,r){var a=t(i,r,n);he(a)&&a.length&&pi(a,t,n+1)})}function hy(e,t,n){var i=[],r=[];return pi(e,function(a,o,s){Ml(i,a,t);var u=a.children;if((n===-1||s<n)&&u&&Ml(r,u,t))return u}),i}function ho(e,t){return hy(e,!t,-1)}function dy(e,t,n){Dr(t)&&(t=!0),Qe(t)&&(n=t,t=!0),n=n||{};var i=ir(n.allShapes),r=ir(n.allConnections),a=ir(n.enclosedElements),o=ir(n.enclosedConnections),s=ir(n.topLevel,t&&ki(e,function(l){return l.id}));function u(l){s[l.source.id]&&s[l.target.id]&&(s[l.id]=[l]),i[l.source.id]&&i[l.target.id]&&(o[l.id]=a[l.id]=l),r[l.id]=l}function c(l){if(a[l.id]=l,l.waypoints)o[l.id]=r[l.id]=l;else return i[l.id]=l,A(l.incoming,u),A(l.outgoing,u),l.children}return pi(e,c),{allShapes:i,allConnections:r,topLevel:s,enclosedConnections:o,enclosedElements:a}}function et(e,t){t=!!t,he(e)||(e=[e]);var n,i,r,a;return A(e,function(o){var s=o;o.waypoints&&!t&&(s=et(o.waypoints,!0));var u=s.x,c=s.y,l=s.height||0,p=s.width||0;(u<n||n===void 0)&&(n=u),(c<i||i===void 0)&&(i=c),(u+p>r||r===void 0)&&(r=u+p),(c+l>a||a===void 0)&&(a=c+l)}),{x:n,y:i,height:a-i,width:r-n}}function my(e,t){var n={};return A(e,function(i){var r=i;r.waypoints&&(r=et(r)),!ae(t.y)&&r.x>t.x&&(n[i.id]=i),!ae(t.x)&&r.y>t.y&&(n[i.id]=i),r.x>t.x&&r.y>t.y&&(ae(t.width)&&ae(t.height)&&r.width+r.x<t.width+t.x&&r.height+r.y<t.height+t.y||!ae(t.width)||!ae(t.height))&&(n[i.id]=i)}),n}function Ah(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}function Rh(e){return!!(e&&e.isFrame)}function ir(e,t){return I({},e||{},t||{})}var vy=1;function jn(e,t){En.call(this,e,vy),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}Z(jn,En);jn.prototype.canRender=function(){return!0};jn.prototype.drawShape=function(t,n,i){var r=J("rect");return H(r,{x:0,y:0,width:n.width||0,height:n.height||0}),Rh(n)?H(r,I({},this.FRAME_STYLE,i||{})):H(r,I({},this.SHAPE_STYLE,i||{})),ne(t,r),r};jn.prototype.drawConnection=function(t,n,i){var r=Du(n.waypoints,I({},this.CONNECTION_STYLE,i||{}));return ne(t,r),r};jn.prototype.getShapePath=function(t){var n=t.x,i=t.y,r=t.width,a=t.height,o=[["M",n,i],["l",r,0],["l",0,a],["l",-r,0],["z"]];return Li(o)};jn.prototype.getConnectionPath=function(t){var n=t.waypoints,i,r,a=[];for(i=0;r=n[i];i++)r=r.original||r,a.push([i===0?"M":"L",r.x,r.y]);return Li(a)};jn.$inject=["eventBus","styles"];function gy(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(n,i,r){var a=this.style(i,r);return I(a,{class:n})},this.style=function(n,i){!he(n)&&!i&&(i=n,n=[]);var r=wt(n,function(a,o){return I(a,e[o]||{})},{});return i?I(r,i):r},this.computeStyle=function(n,i,r){return he(i)||(r=i,i=[]),t.style(i||[],I({},r,n||{}))}}var yy={__init__:["defaultRenderer"],defaultRenderer:["type",jn],styles:["type",gy]};function Ne(e,t){if(!e||!t)return-1;var n=e.indexOf(t);return n!==-1&&e.splice(n,1),n}function Fe(e,t,n){if(!(!e||!t)){typeof n!="number"&&(n=-1);var i=e.indexOf(t);if(i!==-1){if(i===n)return;if(n!==-1)e.splice(i,1);else return}n!==-1?e.splice(n,0,t):e.push(t)}}function Mu(e,t){return!e||!t?-1:e.indexOf(t)}function Mr(e,t){return!e||!t?-1:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Bu(e,t,n,i){if(typeof i=="undefined"&&(i=5),!e||!t||!n)return!1;var r=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),a=Mr(e,t);return Math.abs(r/a)<=i}var Ph=2;function vn(e,t){var n;return he(e)?n=e:n=[e,t],Ey(n)?"h":by(n)?"v":!1}function Ey(e,t){var n;he(e)?n=e:n=[e,t];var i=n.slice().shift();return Fi(n,function(r){return Math.abs(i.y-r.y)<=Ph})}function by(e,t){var n;he(e)?n=e:n=[e,t];var i=n.slice().shift();return Fi(n,function(r){return Math.abs(i.x-r.x)<=Ph})}function Bl(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n}function Us(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}var xy=/,?([a-z]),?/gi,Ol=parseFloat,Ie=Math,Pn=Ie.PI,Jt=Ie.min,Qt=Ie.max,Il=Ie.pow,Bn=Ie.abs,_y=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/ig,wy=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/ig,Xa=Array.isArray||function(e){return e instanceof Array};function Ou(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function mr(e){if(typeof e=="function"||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)Ou(e,n)&&(t[n]=mr(e[n]));return t}function Sy(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function Cy(e){function t(){var n=Array.prototype.slice.call(arguments,0),i=n.join("\u2400"),r=t.cache=t.cache||{},a=t.count=t.count||[];return Ou(r,i)?(Sy(a,i),r[i]):(a.length>=1e3&&delete r[a.shift()],a.push(i),r[i]=e.apply(0,n),r[i])}return t}function Ty(e){if(!e)return null;var t=Ri(e);if(t.arr)return mr(t.arr);var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=[];return Xa(e)&&Xa(e[0])&&(i=mr(e)),i.length||String(e).replace(_y,function(r,a,o){var s=[],u=a.toLowerCase();for(o.replace(wy,function(c,l){l&&s.push(+l)}),u=="m"&&s.length>2&&(i.push([a].concat(s.splice(0,2))),u="l",a=a=="m"?"l":"L");s.length>=n[u]&&(i.push([a].concat(s.splice(0,n[u]))),!!n[u]););}),i.toString=Ri.toString,t.arr=mr(i),i}function Ri(e){var t=Ri.ps=Ri.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)Ou(t,n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function Ys(e,t,n,i){return arguments.length===1&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,height:i,x2:e+n,y2:t+i}}function Dh(){return this.join(",").replace(xy,"$1")}function Za(e){var t=mr(e);return t.toString=Dh,t}function Nl(e,t,n,i,r,a,o,s,u){var c=1-u,l=Il(c,3),p=Il(c,2),h=u*u,f=h*u,d=l*e+p*3*u*n+c*3*u*u*r+f*o,y=l*t+p*3*u*i+c*3*u*u*a+f*s;return{x:Ja(d),y:Ja(y)}}function Fl(e){var t=By.apply(null,e);return Ys(t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)}function Dn(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Ay(e,t){return e=Ys(e),t=Ys(t),Dn(t,e.x,e.y)||Dn(t,e.x2,e.y)||Dn(t,e.x,e.y2)||Dn(t,e.x2,e.y2)||Dn(e,t.x,t.y)||Dn(e,t.x2,t.y)||Dn(e,t.x,t.y2)||Dn(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}function kl(e,t,n,i,r){var a=-3*t+9*n-9*i+3*r,o=e*a+6*t-12*n+6*i;return e*o-3*t+3*n}function Ll(e,t,n,i,r,a,o,s,u){u==null&&(u=1),u=u>1?1:u<0?0:u;for(var c=u/2,l=12,p=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,d=0;d<l;d++){var y=c*p[d]+c,x=kl(y,e,n,r,o),M=kl(y,t,i,a,s),P=x*x+M*M;f+=h[d]*Ie.sqrt(P)}return c*f}function Ry(e,t,n,i,r,a,o,s){if(!(Qt(e,n)<Jt(r,o)||Jt(e,n)>Qt(r,o)||Qt(t,i)<Jt(a,s)||Jt(t,i)>Qt(a,s))){var u=(e*i-t*n)*(r-o)-(e-n)*(r*s-a*o),c=(e*i-t*n)*(a-s)-(t-i)*(r*s-a*o),l=(e-n)*(a-s)-(t-i)*(r-o);if(!!l){var p=Ja(u/l),h=Ja(c/l),f=+p.toFixed(2),d=+h.toFixed(2);if(!(f<+Jt(e,n).toFixed(2)||f>+Qt(e,n).toFixed(2)||f<+Jt(r,o).toFixed(2)||f>+Qt(r,o).toFixed(2)||d<+Jt(t,i).toFixed(2)||d>+Qt(t,i).toFixed(2)||d<+Jt(a,s).toFixed(2)||d>+Qt(a,s).toFixed(2)))return{x:p,y:h}}}}function Ja(e){return Math.round(e*1e11)/1e11}function Py(e,t,n){var i=Fl(e),r=Fl(t);if(!Ay(i,r))return n?0:[];for(var a=Ll.apply(0,e),o=Ll.apply(0,t),s=$l(e)?1:~~(a/5)||1,u=$l(t)?1:~~(o/5)||1,c=[],l=[],p={},h=n?0:[],f=0;f<s+1;f++){var d=Nl.apply(0,e.concat(f/s));c.push({x:d.x,y:d.y,t:f/s})}for(f=0;f<u+1;f++)d=Nl.apply(0,t.concat(f/u)),l.push({x:d.x,y:d.y,t:f/u});for(f=0;f<s;f++)for(var y=0;y<u;y++){var x=c[f],M=c[f+1],P=l[y],w=l[y+1],b=Bn(M.x-x.x)<.01?"y":"x",_=Bn(w.x-P.x)<.01?"y":"x",D=Ry(x.x,x.y,M.x,M.y,P.x,P.y,w.x,w.y),B;if(D){if(B=D.x.toFixed(9)+"#"+D.y.toFixed(9),p[B])continue;p[B]=!0;var R=x.t+Bn((D[b]-x[b])/(M[b]-x[b]))*(M.t-x.t),L=P.t+Bn((D[_]-P[_])/(w[_]-P[_]))*(w.t-P.t);R>=0&&R<=1&&L>=0&&L<=1&&(n?h++:h.push({x:D.x,y:D.y,t1:R,t2:L}))}}return h}function Dy(e,t,n){e=Hl(e),t=Hl(t);for(var i,r,a,o,s,u,c,l,p,h,f=n?0:[],d=0,y=e.length;d<y;d++){var x=e[d];if(x[0]=="M")i=s=x[1],r=u=x[2];else{x[0]=="C"?(p=[i,r].concat(x.slice(1)),i=p[6],r=p[7]):(p=[i,r,i,r,s,u,s,u],i=s,r=u);for(var M=0,P=t.length;M<P;M++){var w=t[M];if(w[0]=="M")a=c=w[1],o=l=w[2];else{w[0]=="C"?(h=[a,o].concat(w.slice(1)),a=h[6],o=h[7]):(h=[a,o,a,o,c,l,c,l],a=c,o=l);var b=Py(p,h,n);if(n)f+=b;else{for(var _=0,D=b.length;_<D;_++)b[_].segment1=d,b[_].segment2=M,b[_].bez1=p,b[_].bez2=h;f=f.concat(b)}}}}}return f}function My(e){var t=Ri(e);if(t.abs)return Za(t.abs);if((!Xa(e)||!Xa(e&&e[0]))&&(e=Ty(e)),!e||!e.length)return[["M",0,0]];var n=[],i=0,r=0,a=0,o=0,s=0,u;e[0][0]=="M"&&(i=+e[0][1],r=+e[0][2],a=i,o=r,s++,n[0]=["M",i,r]);for(var c,l,p=s,h=e.length;p<h;p++){if(n.push(c=[]),l=e[p],u=l[0],u!=u.toUpperCase())switch(c[0]=u.toUpperCase(),c[0]){case"A":c[1]=l[1],c[2]=l[2],c[3]=l[3],c[4]=l[4],c[5]=l[5],c[6]=+l[6]+i,c[7]=+l[7]+r;break;case"V":c[1]=+l[1]+r;break;case"H":c[1]=+l[1]+i;break;case"M":a=+l[1]+i,o=+l[2]+r;default:for(var f=1,d=l.length;f<d;f++)c[f]=+l[f]+(f%2?i:r)}else for(var y=0,x=l.length;y<x;y++)c[y]=l[y];switch(u=u.toUpperCase(),c[0]){case"Z":i=+a,r=+o;break;case"H":i=c[1];break;case"V":r=c[1];break;case"M":a=c[c.length-2],o=c[c.length-1];default:i=c[c.length-2],r=c[c.length-1]}}return n.toString=Dh,t.abs=Za(n),n}function $l(e){return e[0]===e[2]&&e[1]===e[3]&&e[4]===e[6]&&e[5]===e[7]}function ma(e,t,n,i){return[e,t,n,i,n,i]}function jl(e,t,n,i,r,a){var o=.3333333333333333,s=2/3;return[o*e+s*n,o*t+s*i,o*r+s*n,o*a+s*i,r,a]}function Mh(e,t,n,i,r,a,o,s,u,c){var l=Pn*120/180,p=Pn/180*(+r||0),h=[],f,d=Cy(function(oe,Te,pe){var de=oe*Ie.cos(pe)-Te*Ie.sin(pe),Ve=oe*Ie.sin(pe)+Te*Ie.cos(pe);return{x:de,y:Ve}});if(c)B=c[0],R=c[1],_=c[2],D=c[3];else{f=d(e,t,-p),e=f.x,t=f.y,f=d(s,u,-p),s=f.x,u=f.y;var y=(e-s)/2,x=(t-u)/2,M=y*y/(n*n)+x*x/(i*i);M>1&&(M=Ie.sqrt(M),n=M*n,i=M*i);var P=n*n,w=i*i,b=(a==o?-1:1)*Ie.sqrt(Bn((P*w-P*x*x-w*y*y)/(P*x*x+w*y*y))),_=b*n*x/i+(e+s)/2,D=b*-i*y/n+(t+u)/2,B=Ie.asin(((t-D)/i).toFixed(9)),R=Ie.asin(((u-D)/i).toFixed(9));B=e<_?Pn-B:B,R=s<_?Pn-R:R,B<0&&(B=Pn*2+B),R<0&&(R=Pn*2+R),o&&B>R&&(B=B-Pn*2),!o&&R>B&&(R=R-Pn*2)}var L=R-B;if(Bn(L)>l){var z=R,q=s,W=u;R=B+l*(o&&R>B?1:-1),s=_+n*Ie.cos(R),u=D+i*Ie.sin(R),h=Mh(s,u,n,i,r,0,o,q,W,[R,z,_,D])}L=R-B;var X=Ie.cos(B),ge=Ie.sin(B),Lt=Ie.cos(R),be=Ie.sin(R),le=Ie.tan(L/4),S=4/3*n*le,m=4/3*i*le,T=[e,t],O=[e+S*ge,t-m*X],$=[s+S*be,u-m*Lt],N=[s,u];if(O[0]=2*T[0]-O[0],O[1]=2*T[1]-O[1],c)return[O,$,N].concat(h);h=[O,$,N].concat(h).join().split(",");for(var k=[],G=0,re=h.length;G<re;G++)k[G]=G%2?d(h[G-1],h[G],p).y:d(h[G],h[G+1],p).x;return k}function By(e,t,n,i,r,a,o,s){for(var u=[],c=[[],[]],l,p,h,f,d,y,x,M,P=0;P<2;++P){if(P==0?(p=6*e-12*n+6*r,l=-3*e+9*n-9*r+3*o,h=3*n-3*e):(p=6*t-12*i+6*a,l=-3*t+9*i-9*a+3*s,h=3*i-3*t),Bn(l)<1e-12){if(Bn(p)<1e-12)continue;f=-h/p,0<f&&f<1&&u.push(f);continue}x=p*p-4*h*l,M=Ie.sqrt(x),!(x<0)&&(d=(-p+M)/(2*l),0<d&&d<1&&u.push(d),y=(-p-M)/(2*l),0<y&&y<1&&u.push(y))}for(var w=u.length,b=w,_;w--;)f=u[w],_=1-f,c[0][w]=_*_*_*e+3*_*_*f*n+3*_*f*f*r+f*f*f*o,c[1][w]=_*_*_*t+3*_*_*f*i+3*_*f*f*a+f*f*f*s;return c[0][b]=e,c[1][b]=t,c[0][b+1]=o,c[1][b+1]=s,c[0].length=c[1].length=b+2,{x0:Jt.apply(0,c[0]),y0:Jt.apply(0,c[1]),x1:Qt.apply(0,c[0]),y1:Qt.apply(0,c[1])}}function Hl(e){var t=Ri(e);if(t.curve)return Za(t.curve);for(var n=My(e),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r=function(f,d,y){var x,M;if(!f)return["C",d.x,d.y,d.x,d.y,d.x,d.y];switch(!(f[0]in{T:1,Q:1})&&(d.qx=d.qy=null),f[0]){case"M":d.X=f[1],d.Y=f[2];break;case"A":f=["C"].concat(Mh.apply(0,[d.x,d.y].concat(f.slice(1))));break;case"S":y=="C"||y=="S"?(x=d.x*2-d.bx,M=d.y*2-d.by):(x=d.x,M=d.y),f=["C",x,M].concat(f.slice(1));break;case"T":y=="Q"||y=="T"?(d.qx=d.x*2-d.qx,d.qy=d.y*2-d.qy):(d.qx=d.x,d.qy=d.y),f=["C"].concat(jl(d.x,d.y,d.qx,d.qy,f[1],f[2]));break;case"Q":d.qx=f[1],d.qy=f[2],f=["C"].concat(jl(d.x,d.y,f[1],f[2],f[3],f[4]));break;case"L":f=["C"].concat(ma(d.x,d.y,f[1],f[2]));break;case"H":f=["C"].concat(ma(d.x,d.y,f[1],d.y));break;case"V":f=["C"].concat(ma(d.x,d.y,d.x,f[1]));break;case"Z":f=["C"].concat(ma(d.x,d.y,d.X,d.Y));break}return f},a=function(f,d){if(f[d].length>7){f[d].shift();for(var y=f[d];y.length;)o[d]="A",f.splice(d++,0,["C"].concat(y.splice(0,6)));f.splice(d,1),l=n.length}},o=[],s="",u="",c=0,l=n.length;c<l;c++){n[c]&&(s=n[c][0]),s!="C"&&(o[c]=s,c&&(u=o[c-1])),n[c]=r(n[c],i,u),o[c]!="A"&&s=="C"&&(o[c]="C"),a(n,c);var p=n[c],h=p.length;i.x=p[h-2],i.y=p[h-1],i.bx=Ol(p[h-4])||i.x,i.by=Ol(p[h-3])||i.y}return t.curve=Za(n),n}var Oy=Dy,Bh=Oy;function Oh(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}}function On(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function ee(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function Iu(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}}function ue(e){return On({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function tt(e,t,n){n=n||0,Qe(n)||(n={x:n,y:n});var i=ee(e),r=ee(t),a=i.bottom+n.y<=r.top,o=i.left-n.x>=r.right,s=i.top-n.y>=r.bottom,u=i.right+n.x<=r.left,c=a?"top":s?"bottom":null,l=u?"left":o?"right":null;return l&&c?c+"-"+l:l||c||"intersect"}function qs(e,t,n){var i=Iy(e,t);return i.length===1||i.length===2&&Mr(i[0],i[1])<1?On(i[0]):i.length>1?(i=Vt(i,function(r){var a=Math.floor(r.t2*100)||1;return a=100-a,a=(a<10?"0":"")+a,r.segment2+"#"+a}),On(i[n?0:i.length-1])):null}function Iy(e,t){return Bh(e,t)}function Ny(e){e=e.slice();for(var t=0,n,i,r;e[t];)n=e[t],i=e[t-1],r=e[t+1],Mr(n,r)===0||Bu(i,r,n)?e.splice(t,1):t++;return e}function $a(e,t){return Math.round(e*t)/t}function zl(e){return ae(e)?e+"px":e}function Fy(e){for(;e.parent;)e=e.parent;return e}function ky(e){e=I({},{width:"100%",height:"100%"},e);var t=e.container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),I(n.style,{position:"relative",overflow:"hidden",width:zl(e.width),height:zl(e.height)}),t.appendChild(n),n}function Ih(e,t,n){var i=J("g");fe(i).add(t);var r=n!==void 0?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[r]||null),i}var Qa="base",Ks="djs-element-hidden",Nh=0,Ly=1,$y={shape:["x","y","width","height"],connection:["waypoints"]};function ce(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._init(e||{})}ce.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"];ce.prototype._init=function(e){var t=this._eventBus,n=this._container=ky(e),i=this._svg=J("svg");H(i,{width:"100%",height:"100%"}),ne(n,i);var r=this._viewport=Ih(i,"viewport");this._layers={},this._planes={},e.deferUpdate!==!1&&(this._viewboxChanged=hh(ft(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:i,viewport:r})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","plane.set"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)};ce.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._activePlane,delete this._viewport};ce.prototype._clear=function(){var e=this,t=this._elementRegistry.getAll();t.forEach(function(n){var i=Ah(n);i==="root"?e.setRootElementForPlane(null,e.findPlane(n),!0):e._removeElement(n,i)}),this._activePlane=null,this._planes={},delete this._cachedViewbox};ce.prototype.getDefaultLayer=function(){return this.getLayer(Qa,Nh)};ce.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),typeof t!="undefined"&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group};ce.prototype._createLayer=function(e,t){typeof t=="undefined"&&(t=Ly);var n=wt(this._layers,function(i,r){return t>=r.index&&i++,i},0);return{group:Ih(this._viewport,"layer-"+e,n),index:t}};ce.prototype.getPlane=function(e){if(!e)throw new Error("must specify a name");return this._planes[e]};ce.prototype.createPlane=function(e,t){if(!e)throw new Error("must specify a name");if(this._planes[e])throw new Error("plane "+e+" already exists");t||(t={id:"__implicitroot"+e,children:[],isImplicit:!0});var n=this.getLayer(e,Nh);fe(n).add(Ks);var i=this._planes[e]={layer:n,name:e,rootElement:null};return this.setRootElementForPlane(t,i),i};ce.prototype.setActivePlane=function(e){if(!e)throw new Error("must specify a plane");return typeof e=="string"&&(e=this.getPlane(e)),this._activePlane&&fe(this._activePlane.layer).add(Ks),this._activePlane=e,fe(e.layer).remove(Ks),e.rootElement&&this._elementRegistry.updateGraphics(e.rootElement,this._svg,!0),this._eventBus.fire("plane.set",{plane:e}),e};ce.prototype.getActiveLayer=function(){return this.getActivePlane().layer};ce.prototype.getActivePlane=function(){var e=this._activePlane;return e||(e=this.createPlane(Qa),this.setActivePlane(Qa)),e};ce.prototype.findPlane=function(e){typeof e=="string"&&(e=this._elementRegistry.get(e));var t=Fy(e);return _e(this._planes,function(n){return n.rootElement===t})};ce.prototype.getContainer=function(){return this._container};ce.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),i=this._elementRegistry._elements[e.id],i&&(A([i.gfx,i.secondaryGfx],function(r){r&&(n?fe(r).add(t):fe(r).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))};ce.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)};ce.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)};ce.prototype.hasMarker=function(e,t){e.id||(e=this._elementRegistry.get(e));var n=this.getGraphics(e);return fe(n).has(t)};ce.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)};ce.prototype.getRootElement=function(){var e=this.getActivePlane();return e.rootElement};ce.prototype.setRootElement=function(e,t){var n=this._activePlane;if(n)return this.setRootElementForPlane(e,n,t);var i=this.createPlane(Qa,e);return this.setActivePlane(i),i.rootElement};ce.prototype.setRootElementForPlane=function(e,t,n){typeof t=="string"&&(t=this.getPlane(t)),e&&this._ensureValid("root",e);var i=t.rootElement,r=this._elementRegistry,a=this._eventBus;if(i){if(!n)throw new Error("rootElement already set, need to specify override");a.fire("root.remove",{element:i}),a.fire("root.removed",{element:i}),r.remove(i)}if(e){var o=t.layer;a.fire("root.add",{element:e}),r.add(e,o),a.fire("root.added",{element:e,gfx:o}),t===this._activePlane&&this._elementRegistry.updateGraphics(e,this._svg,!0)}return t.rootElement=e,e};ce.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element with id "+t.id+" already exists");var n=$y[e],i=Fi(n,function(r){return typeof t[r]!="undefined"});if(!i)throw new Error("must supply { "+n.join(", ")+" } with "+e)};ce.prototype._setParent=function(e,t,n){Fe(t.children,e,n),e.parent=t};ce.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var r=this._eventBus,a=this._graphicsFactory;this._ensureValid(e,t),r.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);var o=a.create(e,t,i);return this._elementRegistry.add(t,o),a.update(e,t,o),r.fire(e+".added",{element:t,gfx:o}),t};ce.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)};ce.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)};ce.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(e=n.get(e.id||e),!!e)return r.fire(t+".remove",{element:e}),i.remove(e),Ne(e.parent&&e.parent.children,e),e.parent=null,r.fire(t+".removed",{element:e}),n.remove(e),e};ce.prototype.removeShape=function(e){return this._removeElement(e,"shape")};ce.prototype.removeConnection=function(e){return this._removeElement(e,"connection")};ce.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)};ce.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()};ce.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})};ce.prototype.viewbox=function(e){if(e===void 0&&this._cachedViewbox)return this._cachedViewbox;var t=this._viewport,n,i=this.getSize(),r,a,o,s,u;if(e)this._changeViewbox(function(){o=Math.min(i.width/e.width,i.height/e.height);var c=this._svg.createSVGMatrix().scale(o).translate(-e.x,-e.y);wr(t,c)});else return n=this._activePlane&&this._activePlane.layer.getBBox()||{},a=wr(t),r=a?a.matrix:Kg(),o=$a(r.a,1e3),s=$a(-r.e||0,1e3),u=$a(-r.f||0,1e3),e=this._cachedViewbox={x:s?s/o:0,y:u?u/o:0,width:i.width/o,height:i.height/o,scale:o,inner:{width:n.width||0,height:n.height||0,x:n.x||0,y:n.y||0},outer:i},e;return e};ce.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=I({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),Fh(t,n)}),{x:n.e,y:n.f}};ce.prototype.scrollToElement=function(e,t){var n=100;typeof e=="string"&&(e=this._elementRegistry.get(e));var i=this.findPlane(e);i!==this._activePlane&&this.setActivePlane(i),t||(t={}),typeof t=="number"&&(n=t),t={top:t.top||n,right:t.right||n,bottom:t.bottom||n,left:t.left||n};var r=et(e),a=ee(r),o=this.viewbox(),s=this.zoom(),u,c;o.y+=t.top/s,o.x+=t.left/s,o.width-=(t.right+t.left)/s,o.height-=(t.bottom+t.top)/s;var l=ee(o),p=r.width<o.width&&r.height<o.height;if(!p)u=r.x-o.x,c=r.y-o.y;else{var h=Math.max(0,a.right-l.right),f=Math.min(0,a.left-l.left),d=Math.max(0,a.bottom-l.bottom),y=Math.min(0,a.top-l.top);u=h||f,c=d||y}this.scroll({dx:-u*s,dy:-c*s})};ce.prototype.zoom=function(e,t){if(!e)return this.viewbox(e).scale;if(e==="fit-viewport")return this._fitViewport(t);var n,i;return this._changeViewbox(function(){typeof t!="object"&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),$a(i.a,1e3)};function Fh(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}ce.prototype._fitViewport=function(e){var t=this.viewbox(),n=t.outer,i=t.inner,r,a;return i.x>=0&&i.y>=0&&i.x+i.width<=n.width&&i.y+i.height<=n.height&&!e?a={x:0,y:0,width:Math.max(i.width+i.x,n.width),height:Math.max(i.height+i.y,n.height)}:(r=Math.min(1,n.width/i.width,n.height/i.height),a={x:i.x+(e?i.width/2-n.width/r/2:0),y:i.y+(e?i.height/2-n.height/r/2:0),width:n.width/r,height:n.height/r}),this.viewbox(a),this.viewbox(!1).scale};ce.prototype._setZoom=function(e,t){var n=this._svg,i=this._viewport,r=n.createSVGMatrix(),a=n.createSVGPoint(),o,s,u,c,l;u=i.getCTM();var p=u.a;return t?(o=I(a,t),s=o.matrixTransform(u.inverse()),c=r.translate(s.x,s.y).scale(1/p*e).translate(-s.x,-s.y),l=u.multiply(c)):l=r.scale(e),Fh(this._viewport,l),l};ce.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}};ce.prototype.getAbsoluteBBox=function(e){var t=this.viewbox(),n;if(e.waypoints){var i=this.getGraphics(e);n=i.getBBox()}else n=e;var r=n.x*t.scale-t.x*t.scale,a=n.y*t.scale-t.y*t.scale,o=n.width*t.scale,s=n.height*t.scale;return{x:r,y:a,width:o,height:s}};ce.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var Pi="data-element-id";function Ct(e){this._elements={},this._eventBus=e}Ct.$inject=["eventBus"];Ct.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),H(t,Pi,i),n&&H(n,Pi,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}};Ct.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&(H(i.gfx,Pi,""),i.secondaryGfx&&H(i.secondaryGfx,Pi,""),delete t[n])};Ct.prototype.updateId=function(e,t){this._validateId(t),typeof e=="string"&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)};Ct.prototype.updateGraphics=function(e,t,n){var i=e.id||e,r=this._elements[i];return n?r.secondaryGfx=t:r.gfx=t,H(t,Pi,i),t};Ct.prototype.get=function(e){var t;typeof e=="string"?t=e:t=e&&H(e,Pi);var n=this._elements[t];return n&&n.element};Ct.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t};Ct.prototype.find=function(e){for(var t=this._elements,n=Object.keys(t),i=0;i<n.length;i++){var r=n[i],a=t[r],o=a.element,s=a.gfx;if(e(o,s))return o}};Ct.prototype.getAll=function(){return this.filter(function(e){return e})};Ct.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n],r=i.element,a=i.gfx;return e(r,a)})};Ct.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)};Ct.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var Nu={exports:{}},mo={};function jy(e,t,n,i){var r=n.inverse;return Object.defineProperty(e,"remove",{value:function(a){var o=this.indexOf(a);return o!==-1&&(this.splice(o,1),t.unset(a,r,i)),a}}),Object.defineProperty(e,"contains",{value:function(a){return this.indexOf(a)!==-1}}),Object.defineProperty(e,"add",{value:function(a,o){var s=this.indexOf(a);if(typeof o=="undefined"){if(s!==-1)return;o=this.length}s!==-1&&this.splice(s,1),this.splice(o,0,a),s===-1&&t.set(a,r,i)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e}function Hy(e){return e.__refs_collection===!0}mo.extend=jy;mo.isExtended=Hy;var kh=mo;function zy(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)}function Lh(e,t,n){var i=kh.extend(n[t.name]||[],e,t,n);Object.defineProperty(n,t.name,{enumerable:t.enumerable,value:i}),i.length&&i.forEach(function(r){e.set(r,t.inverse,n)})}function Gy(e,t,n){var i=t.inverse,r=n[t.name];Object.defineProperty(n,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return r},set:function(a){if(a!==r){var o=r;r=null,o&&e.unset(o,i,n),r=a,e.set(r,i,n)}}})}function Fn(e,t){if(!(this instanceof Fn))return new Fn(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}Fn.prototype.bind=function(e,t){if(typeof t=="string"){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?Lh(this,t,e):Gy(this,t,e)};Fn.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return kh.isExtended(n)||Lh(this,t,e),n};Fn.prototype.ensureBound=function(e,t){zy(e,t)||this.bind(e,t)};Fn.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)};Fn.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var Vy=Fn;Nu.exports=Vy;Nu.exports.Collection=mo;var $i=Nu.exports,$h=new $i({name:"children",enumerable:!0,collection:!0},{name:"parent"}),jh=new $i({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),Gl=new $i({name:"attachers",collection:!0},{name:"host"}),Hh=new $i({name:"outgoing",collection:!0},{name:"source"}),zh=new $i({name:"incoming",collection:!0},{name:"target"});function Br(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),$h.bind(this,"parent"),jh.bind(this,"labels"),Hh.bind(this,"outgoing"),zh.bind(this,"incoming")}function ji(){Br.call(this),$h.bind(this,"children"),Gl.bind(this,"host"),Gl.bind(this,"attachers")}Z(ji,Br);function Gh(){ji.call(this)}Z(Gh,ji);function vo(){ji.call(this),jh.bind(this,"labelTarget")}Z(vo,ji);function Vh(){Br.call(this),Hh.bind(this,"source"),zh.bind(this,"target")}Z(Vh,Br);var Wy={connection:Vh,shape:ji,label:vo,root:Gh};function Uy(e,t){var n=Wy[e];if(!n)throw new Error("unknown type: <"+e+">");return I(new n,t)}function bn(){this._uid=12}bn.prototype.createRoot=function(e){return this.create("root",e)};bn.prototype.createLabel=function(e){return this.create("label",e)};bn.prototype.createShape=function(e){return this.create("shape",e)};bn.prototype.createConnection=function(e){return this.create("connection",e)};bn.prototype.create=function(e,t){return t=I({},t||{}),t.id||(t.id=e+"_"+this._uid++),Uy(e,t)};var eo="__fn",Wh=1e3,Yy=Array.prototype.slice;function vt(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}vt.prototype.on=function(e,t,n,i){if(e=he(e)?e:[e],ot(t)&&(i=n,n=t,t=Wh),!ae(t))throw new Error("priority must be a number");var r=n;i&&(r=ft(n,i),r[eo]=n[eo]||n);var a=this;e.forEach(function(o){a._addListener(o,{priority:t,callback:r,next:null})})};vt.prototype.once=function(e,t,n,i){var r=this;if(ot(t)&&(i=n,n=t,t=Wh),!ae(t))throw new Error("priority must be a number");function a(){a.__isTomb=!0;var o=n.apply(i,arguments);return r.off(e,a),o}a[eo]=n,this.on(e,t,a)};vt.prototype.off=function(e,t){e=he(e)?e:[e];var n=this;e.forEach(function(i){n._removeListener(i,t)})};vt.prototype.createEvent=function(e){var t=new Or;return t.init(e),t};vt.prototype.fire=function(e,t){var n,i,r,a;if(a=Yy.call(arguments),typeof e=="object"&&(t=e,e=t.type),!e)throw new Error("no event type specified");if(i=this._listeners[e],!!i){t instanceof Or?n=t:n=this.createEvent(t),a[0]=n;var o=n.type;e!==o&&(n.type=e);try{r=this._invokeListeners(n,a,i)}finally{e!==o&&(n.type=o)}return r===void 0&&n.defaultPrevented&&(r=!1),r}};vt.prototype.handleError=function(e){return this.fire("error",{error:e})===!1};vt.prototype._destroy=function(){this._listeners={}};vt.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i};vt.prototype._invokeListener=function(e,t,n){var i;if(n.callback.__isTomb)return i;try{i=qy(n.callback,t),i!==void 0&&(e.returnValue=i,e.stopPropagation()),i===!1&&e.preventDefault()}catch(r){if(!this.handleError(r))throw console.error("unhandled error in event listener",r),r}return i};vt.prototype._addListener=function(e,t){var n=this._getListeners(e),i;if(!n){this._setListeners(e,t);return}for(;n;){if(n.priority<t.priority){t.next=n,i?i.next=t:this._setListeners(e,t);return}i=n,n=n.next}i.next=t};vt.prototype._getListeners=function(e){return this._listeners[e]};vt.prototype._setListeners=function(e,t){this._listeners[e]=t};vt.prototype._removeListener=function(e,t){var n=this._getListeners(e),i,r,a;if(!t){this._setListeners(e,null);return}for(;n;)i=n.next,a=n.callback,(a===t||a[eo]===t)&&(r?r.next=i:this._setListeners(e,i)),r=n,n=i};function Or(){}Or.prototype.stopPropagation=function(){this.cancelBubble=!0};Or.prototype.preventDefault=function(){this.defaultPrevented=!0};Or.prototype.init=function(e){I(this,e||{})};function qy(e,t){return e.apply(null,t)}function to(e){return e.childNodes[0]}function Ky(e){return e.parentNode.childNodes[1]}function Xs(e,t,n,i,r){var a=dr();a.setTranslate(t,n);var o=dr();o.setRotate(i||0,0,0);var s=dr();s.setScale(r||1,r||1),wr(e,[a,o,s])}function mt(e,t,n){var i=dr();i.setTranslate(t,n),wr(e,i)}function Uh(e,t){var n=dr();n.setRotate(t,0,0),wr(e,n)}function Tt(e,t){this._eventBus=e,this._elementRegistry=t}Tt.$inject=["eventBus","elementRegistry"];Tt.prototype._getChildrenContainer=function(e){var t=this._elementRegistry.getGraphics(e),n;return e.parent?(n=Ky(t),n||(n=J("g"),fe(n).add("djs-children"),ne(t.parentNode,n))):n=t,n};Tt.prototype._clear=function(e){var t=to(e);return fo(t),t};Tt.prototype._createContainer=function(e,t,n,i){var r=J("g");fe(r).add("djs-group"),typeof n!="undefined"?Yh(r,t,t.childNodes[n]):ne(t,r);var a=J("g");fe(a).add("djs-element"),fe(a).add("djs-"+e),i&&fe(a).add("djs-frame"),ne(r,a);var o=J("g");return fe(o).add("djs-visual"),ne(a,o),a};Tt.prototype.create=function(e,t,n){var i=this._getChildrenContainer(t.parent);return this._createContainer(e,i,n,Rh(t))};Tt.prototype.updateContainments=function(e){var t=this,n=this._elementRegistry,i;i=wt(e,function(r,a){return a.parent&&(r[a.parent.id]=a.parent),r},{}),A(i,function(r){var a=r.children;if(!!a){var o=t._getChildrenContainer(r);A(a.slice().reverse(),function(s){var u=n.getGraphics(s);Yh(u.parentNode,o)})}})};Tt.prototype.drawShape=function(e,t){var n=this._eventBus;return n.fire("render.shape",{gfx:e,element:t})};Tt.prototype.getShapePath=function(e){var t=this._eventBus;return t.fire("render.getShapePath",e)};Tt.prototype.drawConnection=function(e,t){var n=this._eventBus;return n.fire("render.connection",{gfx:e,element:t})};Tt.prototype.getConnectionPath=function(e){var t=this._eventBus;return t.fire("render.getConnectionPath",e)};Tt.prototype.update=function(e,t,n){if(!!t.parent){var i=this._clear(n);if(e==="shape")this.drawShape(i,t),mt(n,t.x,t.y);else if(e==="connection")this.drawConnection(i,t);else throw new Error("unknown type: "+e);t.hidden?H(n,"display","none"):H(n,"display","block")}};Tt.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);ke(t.parentNode)};function Yh(e,t,n){var i=n||t.firstChild;e!==i&&t.insertBefore(e,i)}var Xy={__depends__:[yy],__init__:["canvas"],canvas:["type",ce],elementRegistry:["type",Ct],elementFactory:["type",bn],eventBus:["type",vt],graphicsFactory:["type",Tt]};function Zy(e){var t=[],n=[];function i(s){return t.indexOf(s)>=0}function r(s){t.push(s)}function a(s){i(s)||((s.__depends__||[]).forEach(a),!i(s)&&(r(s),(s.__init__||[]).forEach(function(u){n.push(u)})))}e.forEach(a);var o=new Ws(t);return n.forEach(function(s){try{o[typeof s=="string"?"get":"invoke"](s)}catch(u){throw console.error("Failed to instantiate component"),console.error(u.stack),u}}),o}function Jy(e){e=e||{};var t={config:["value",e]},n=[t,Xy].concat(e.modules||[]);return Zy(n)}function Hi(e,t){this.injector=t=t||Jy(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}Hi.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")};Hi.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};function Fu(){}Fu.prototype.get=function(e){return this.$model.properties.get(this,e)};Fu.prototype.set=function(e,t){this.$model.properties.set(this,e,t)};function qh(e,t){this.model=e,this.properties=t}qh.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(Fu.prototype);A(e.properties,function(o){!o.isMany&&o.default!==void 0&&(i[o.name]=o.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var r=e.ns.name;function a(o){n.define(this,"$type",{value:r,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),A(o,ft(function(s,u){this.set(u,s)},this))}return a.prototype=i,a.hasType=i.$instanceOf=this.model.hasType,n.defineModel(a,t),n.defineDescriptor(a,e),a};var Qy={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},Kh={String:function(e){return e},Boolean:function(e){return e==="true"},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e)}};function ku(e,t){var n=Kh[e];return n?n(t):t}function Zs(e){return!!Qy[e]}function Xh(e){return!!Kh[e]}function pt(e,t){var n=e.split(/:/),i,r;if(n.length===1)i=e,r=t;else if(n.length===2)i=n[1],r=n[0];else throw new Error("expected <prefix:localName> or <localName>, got "+e);return e=(r?r+":":"")+i,{name:e,prefix:r,localName:i}}function Mt(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}Mt.prototype.build=function(){return Wt(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])};Mt.prototype.addProperty=function(e,t,n){typeof t=="boolean"&&(n=t,t=void 0),this.addNamedProperty(e,n!==!1);var i=this.properties;t!==void 0?i.splice(t,0,e):i.push(e)};Mt.prototype.replaceProperty=function(e,t,n){var i=e.ns,r=this.properties,a=this.propertiesByName,o=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=r.indexOf(e);if(s===-1)throw new Error("property <"+i.name+"> not found in property list");r.splice(s,1),this.addProperty(t,n?void 0:s,o),a[i.name]=a[i.localName]=t};Mt.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,r=t.split("#"),a=pt(r[0],i),o=pt(r[1],a.prefix).name,s=this.propertiesByName[o];if(s)this.replaceProperty(s,e,n);else throw new Error("refined property <"+o+"> not found");delete e.redefines};Mt.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e};Mt.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]};Mt.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e};Mt.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e};Mt.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")};Mt.prototype.hasProperty=function(e){return this.propertiesByName[e]};Mt.prototype.addTrait=function(e,t){var n=this.allTypesByName,i=this.allTypes,r=e.name;r in n||(A(e.properties,ft(function(a){a=I({},a,{name:a.ns.localName,inherited:t}),Object.defineProperty(a,"definedBy",{value:e});var o=a.replaces,s=a.redefines;o||s?this.redefineProperty(a,o||s,o):(a.isBody&&this.setBodyProperty(a),a.isId&&this.setIdProperty(a),this.addProperty(a))},this)),i.push(e),n[r]=e)};function Hn(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,A(e,ft(this.registerPackage,this))}Hn.prototype.getPackage=function(e){return this.packageMap[e]};Hn.prototype.getPackages=function(){return this.packages};Hn.prototype.registerPackage=function(e){e=I({},e);var t=this.packageMap;Vl(t,e,"prefix"),Vl(t,e,"uri"),A(e.types,ft(function(n){this.registerType(n,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)};Hn.prototype.registerType=function(e,t){e=I({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:I(e.meta||{})});var n=pt(e.name,t.prefix),i=n.name,r={};A(e.properties,ft(function(a){var o=pt(a.name,n.prefix),s=o.name;Zs(a.type)||(a.type=pt(a.type,o.prefix).name),I(a,{ns:o,name:s}),r[s]=a},this)),I(e,{ns:n,name:i,propertiesByName:r}),A(e.extends,ft(function(a){var o=this.typeMap[a];o.traits=o.traits||[],o.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e};Hn.prototype.mapTypes=function(e,t,n){var i=Zs(e.name)?{name:e.name}:this.typeMap[e.name],r=this;function a(s){return o(s,!0)}function o(s,u){var c=pt(s,Zs(s)?"":e.prefix);r.mapTypes(c,t,u)}if(!i)throw new Error("unknown type <"+e.name+">");A(i.superClass,n?a:o),t(i,!n),A(i.traits,a)};Hn.prototype.getEffectiveDescriptor=function(e){var t=pt(e),n=new Mt(t);this.mapTypes(t,function(r,a){n.addTrait(r,a)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i};Hn.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})};function Vl(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}function zi(e){this.model=e}zi.prototype.set=function(e,t,n){var i=this.model.getPropertyDescriptor(e,t),r=i&&i.name;eE(n)?i?delete e[r]:delete e.$attrs[t]:i?r in e?e[r]=n:Zh(e,i,n):e.$attrs[t]=n};zi.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var i=n.name;return!e[i]&&n.isMany&&Zh(e,n,[]),e[i]};zi.prototype.define=function(e,t,n){if(!n.writable){var i=n.value;n=I({},n,{get:function(){return i}}),delete n.value}Object.defineProperty(e,t,n)};zi.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})};zi.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})};function eE(e){return typeof e=="undefined"}function Zh(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function Bt(e){this.properties=new zi(this),this.factory=new qh(this,this.properties),this.registry=new Hn(e,this.properties),this.typeCache={}}Bt.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)};Bt.prototype.getType=function(e){var t=this.typeCache,n=Dt(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i};Bt.prototype.createAny=function(e,t,n){var i=pt(e),r={$type:e,$instanceOf:function(o){return o===this.$type}},a={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(r,a),this.properties.defineModel(r,this),this.properties.define(r,"$parent",{enumerable:!1,writable:!0}),this.properties.define(r,"$instanceOf",{enumerable:!1,writable:!0}),A(n,function(o,s){Qe(o)&&o.value!==void 0?r[o.name]=o.value:r[s]=o}),r};Bt.prototype.getPackage=function(e){return this.registry.getPackage(e)};Bt.prototype.getPackages=function(){return this.registry.getPackages()};Bt.prototype.getElementDescriptor=function(e){return e.$descriptor};Bt.prototype.hasType=function(e,t){t===void 0&&(t=e,e=this);var n=e.$model.getElementDescriptor(e);return t in n.allTypesByName};Bt.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]};Bt.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var Wl=String.fromCharCode,tE=Object.prototype.hasOwnProperty,nE=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/ig,vr={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};Object.keys(vr).forEach(function(e){vr[e.toUpperCase()]=vr[e]});function iE(e,t,n,i){return i?tE.call(vr,i)?vr[i]:"&"+i+";":Wl(t||parseInt(n,16))}function ti(e){return e.length>3&&e.indexOf("&")!==-1?e.replace(nE,iE):e}var rE="http://www.w3.org/2001/XMLSchema-instance",aE="xsi",Ul="xsi:type",Yl="non-whitespace outside of root node";function _i(e){return new Error(e)}function ql(e){return"missing namespace for prefix <"+e+">"}function va(e){return{get:e,enumerable:!0}}function oE(e){var t={},n;for(n in e)t[n]=e[n];return t}function Js(e){return e+"$uri"}function sE(e){var t={},n,i;for(n in e)i=e[n],t[i]=i,t[Js(i)]=n;return t}function Kl(){return{line:0,column:0}}function uE(e){throw e}function Jh(e){if(!this)return new Jh(e);var t=e&&e.proxy,n,i,r,a,o=uE,s,u,c,l,p=Kl,h=!1,f=!1,d=null,y=!1,x;function M(b){b instanceof Error||(b=_i(b)),d=b,o(b,p)}function P(b){!s||(b instanceof Error||(b=_i(b)),s(b,p))}this.on=function(b,_){if(typeof _!="function")throw _i("required args <name, cb>");switch(b){case"openTag":i=_;break;case"text":n=_;break;case"closeTag":r=_;break;case"error":o=_;break;case"warn":s=_;break;case"cdata":a=_;break;case"attention":l=_;break;case"question":c=_;break;case"comment":u=_;break;default:throw _i("unsupported event: "+b)}return this},this.ns=function(b){if(typeof b=="undefined"&&(b={}),typeof b!="object")throw _i("required args <nsMap={}>");var _={},D;for(D in b)_[D]=b[D];return _[rE]=aE,f=!0,x=_,this},this.parse=function(b){if(typeof b!="string")throw _i("required args <xml=string>");return d=null,w(b),p=Kl,y=!1,d},this.stop=function(){y=!0};function w(b){var _=f?[]:null,D=f?sE(x):null,B,R=[],L=0,z=!1,q=!1,W=0,X=0,ge,Lt,be,le,S,m,T,O,$,N="",k=0,G;function re(){if(G!==null)return G;var Te,pe,de,Ve=f&&D.xmlns,We=f&&h?[]:null,we=k,Re=N,ut=Re.length,ct,rt,Be,yt,Ee,Ge={},ra={},Et,Q,xe;e:for(;we<ut;we++)if(Et=!1,Q=Re.charCodeAt(we),!(Q===32||Q<14&&Q>8)){for((Q<65||Q>122||Q>90&&Q<97)&&Q!==95&&Q!==58&&(P("illegal first char attribute name"),Et=!0),xe=we+1;xe<ut;xe++)if(Q=Re.charCodeAt(xe),!(Q>96&&Q<123||Q>64&&Q<91||Q>47&&Q<59||Q===46||Q===45||Q===95)){if(Q===32||Q<14&&Q>8){P("missing attribute value"),we=xe;continue e}if(Q===61)break;P("illegal attribute name char"),Et=!0}if(Ee=Re.substring(we,xe),Ee==="xmlns:xmlns"&&(P("illegal declaration of xmlns"),Et=!0),Q=Re.charCodeAt(xe+1),Q===34)xe=Re.indexOf('"',we=xe+2),xe===-1&&(xe=Re.indexOf("'",we),xe!==-1&&(P("attribute value quote missmatch"),Et=!0));else if(Q===39)xe=Re.indexOf("'",we=xe+2),xe===-1&&(xe=Re.indexOf('"',we),xe!==-1&&(P("attribute value quote missmatch"),Et=!0));else for(P("missing attribute value quotes"),Et=!0,xe=xe+1;xe<ut&&(Q=Re.charCodeAt(xe+1),!(Q===32||Q<14&&Q>8));xe++);for(xe===-1&&(P("missing closing quotes"),xe=ut,Et=!0),Et||(Be=Re.substring(we,xe)),we=xe;xe+1<ut&&(Q=Re.charCodeAt(xe+1),!(Q===32||Q<14&&Q>8));xe++)we===xe&&(P("illegal character after attribute end"),Et=!0);if(we=xe+1,Et)continue e;if(Ee in ra){P("attribute <"+Ee+"> already defined");continue}if(ra[Ee]=!0,!f){Ge[Ee]=Be;continue}if(h){if(rt=Ee==="xmlns"?"xmlns":Ee.charCodeAt(0)===120&&Ee.substr(0,6)==="xmlns:"?Ee.substr(6):null,rt!==null){if(Te=ti(Be),pe=Js(rt),yt=x[Te],!yt){if(rt==="xmlns"||pe in D&&D[pe]!==Te)do yt="ns"+L++;while(typeof D[yt]!="undefined");else yt=rt;x[Te]=yt}D[rt]!==yt&&(ct||(D=oE(D),ct=!0),D[rt]=yt,rt==="xmlns"&&(D[Js(yt)]=Te,Ve=yt),D[pe]=Te),Ge[Ee]=Be;continue}We.push(Ee,Be);continue}if(Q=Ee.indexOf(":"),Q===-1){Ge[Ee]=Be;continue}if(!(de=D[Ee.substring(0,Q)])){P(ql(Ee.substring(0,Q)));continue}Ee=Ve===de?Ee.substr(Q+1):de+Ee.substr(Q),Ee===Ul&&(Q=Be.indexOf(":"),Q!==-1?(de=Be.substring(0,Q),de=D[de]||de,Be=de+Be.substring(Q)):Be=Ve+":"+Be),Ge[Ee]=Be}if(h)for(we=0,ut=We.length;we<ut;we++){if(Ee=We[we++],Be=We[we],Q=Ee.indexOf(":"),Q!==-1){if(!(de=D[Ee.substring(0,Q)])){P(ql(Ee.substring(0,Q)));continue}Ee=Ve===de?Ee.substr(Q+1):de+Ee.substr(Q),Ee===Ul&&(Q=Be.indexOf(":"),Q!==-1?(de=Be.substring(0,Q),de=D[de]||de,Be=de+Be.substring(Q)):Be=Ve+":"+Be)}Ge[Ee]=Be}return G=Ge}function oe(){for(var Te=/(\r\n|\r|\n)/g,pe=0,de=0,Ve=0,We=X,we,Re;W>=Ve&&(we=Te.exec(b),!(!we||(We=we[0].length+we.index,We>W)));)pe+=1,Ve=We;return W==-1?(de=We,Re=b.substring(X)):X===0?Re=b.substring(X,W):(de=W-Ve,Re=X==-1?b.substring(W):b.substring(W,X+1)),{data:Re,line:pe,column:de}}for(p=oe,t&&($=Object.create({},{name:va(function(){return T}),originalName:va(function(){return O}),attrs:va(re),ns:va(function(){return D})}));X!==-1;){if(b.charCodeAt(X)===60?W=X:W=b.indexOf("<",X),W===-1){if(R.length)return M("unexpected end of file");if(X===0)return M("missing start tag");X<b.length&&b.substring(X).trim()&&P(Yl);return}if(X!==W){if(R.length){if(n&&(n(b.substring(X,W),ti,p),y))return}else if(b.substring(X,W).trim()&&(P(Yl),y))return}if(le=b.charCodeAt(W+1),le===33){if(be=b.charCodeAt(W+2),be===91&&b.substr(W+3,6)==="CDATA["){if(X=b.indexOf("]]>",W),X===-1)return M("unclosed cdata");if(a&&(a(b.substring(W+9,X),p),y))return;X+=3;continue}if(be===45&&b.charCodeAt(W+3)===45){if(X=b.indexOf("-->",W),X===-1)return M("unclosed comment");if(u&&(u(b.substring(W+4,X),ti,p),y))return;X+=3;continue}}if(le===63){if(X=b.indexOf("?>",W),X===-1)return M("unclosed question");if(c&&(c(b.substring(W,X+2),p),y))return;X+=2;continue}for(ge=W+1;;ge++){if(S=b.charCodeAt(ge),isNaN(S))return X=-1,M("unclosed tag");if(S===34)be=b.indexOf('"',ge+1),ge=be!==-1?be:ge;else if(S===39)be=b.indexOf("'",ge+1),ge=be!==-1?be:ge;else if(S===62){X=ge;break}}if(le===33){if(l&&(l(b.substring(W,X+1),ti,p),y))return;X+=1;continue}if(G={},le===47){if(z=!1,q=!0,!R.length)return M("missing open tag");if(ge=T=R.pop(),be=W+2+ge.length,b.substring(W+2,be)!==ge)return M("closing tag mismatch");for(;be<X;be++)if(le=b.charCodeAt(be),!(le===32||le>8&&le<14))return M("close tag")}else{if(b.charCodeAt(X-1)===47?(ge=T=b.substring(W+1,X-1),z=!0,q=!0):(ge=T=b.substring(W+1,X),z=!0,q=!1),!(le>96&&le<123||le>64&&le<91||le===95||le===58))return M("illegal first char nodeName");for(be=1,Lt=ge.length;be<Lt;be++)if(le=ge.charCodeAt(be),!(le>96&&le<123||le>64&&le<91||le>47&&le<59||le===45||le===95||le==46)){if(le===32||le<14&&le>8){T=ge.substring(0,be),G=null;break}return M("invalid nodeName")}q||R.push(T)}if(f){if(B=D,z&&(q||_.push(B),G===null&&(h=ge.indexOf("xmlns",be)!==-1)&&(k=be,N=ge,re(),h=!1)),O=T,le=T.indexOf(":"),le!==-1){if(m=D[T.substring(0,le)],!m)return M("missing namespace on <"+O+">");T=T.substr(le+1)}else m=D.xmlns;m&&(T=m+":"+T)}if(z&&(k=be,N=ge,i&&(t?i($,ti,q,p):i(T,re,ti,q,p),y)))return;if(q){if(r&&(r(t?$:T,ti,z,p),y))return;f&&(z?D=B:D=_.pop())}X+=1}}}function Qh(e){return e.xml&&e.xml.tagAlias==="lowerCase"}var cE={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"},go="xsi:type";function ed(e){return e.xml&&e.xml.serialize}function td(e){return ed(e)===go}function lE(e){return ed(e)==="property"}function pE(e){return e.charAt(0).toUpperCase()+e.slice(1)}function nd(e,t){return Qh(t)?e.prefix+":"+pE(e.localName):e.name}function fE(e,t){var n=e.name,i=e.localName,r=t.xml&&t.xml.typePrefix;return r&&i.indexOf(r)===0?e.prefix+":"+i.slice(r.length):n}function hE(e,t){var n=pt(e),i=t.getPackage(n.prefix);return fE(n,i)}function kn(e){return new Error(e)}function gn(e){return e.$descriptor}function dE(e){I(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(t){this.references.push(t)},this.addElement=function(t){if(!t)throw kn("expected element");var n=this.elementsById,i=gn(t),r=i.idProperty,a;if(r&&(a=t.get(r.name),a)){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(a))throw new Error("illegal ID <"+a+">");if(n[a])throw kn("duplicate ID <"+a+">");n[a]=t}},this.addWarning=function(t){this.warnings.push(t)}}function Ir(){}Ir.prototype.handleEnd=function(){};Ir.prototype.handleText=function(){};Ir.prototype.handleNode=function(){};function Lu(){}Lu.prototype=Object.create(Ir.prototype);Lu.prototype.handleNode=function(){return this};function Gi(){}Gi.prototype=Object.create(Ir.prototype);Gi.prototype.handleText=function(e){this.body=(this.body||"")+e};function Nr(e,t){this.property=e,this.context=t}Nr.prototype=Object.create(Gi.prototype);Nr.prototype.handleNode=function(e){if(this.element)throw kn("expected no sub nodes");return this.element=this.createReference(e),this};Nr.prototype.handleEnd=function(){this.element.id=this.body};Nr.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}};function $u(e,t){this.element=t,this.propertyDesc=e}$u.prototype=Object.create(Gi.prototype);$u.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=ku(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)};function yo(){}yo.prototype=Object.create(Gi.prototype);yo.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t};function st(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}st.prototype=Object.create(yo.prototype);st.prototype.addReference=function(e){this.context.addReference(e)};st.prototype.handleText=function(e){var t=this.element,n=gn(t),i=n.bodyProperty;if(!i)throw kn("unexpected body text <"+e+">");Gi.prototype.handleText.call(this,e)};st.prototype.handleEnd=function(){var e=this.body,t=this.element,n=gn(t),i=n.bodyProperty;i&&e!==void 0&&(e=ku(i.type,e),t.set(i.name,e))};st.prototype.createElement=function(e){var t=e.attributes,n=this.type,i=gn(n),r=this.context,a=new n({}),o=this.model,s;return A(t,function(u,c){var l=i.propertiesByName[c],p;l&&l.isReference?l.isMany?(p=u.split(" "),A(p,function(h){r.addReference({element:a,property:l.ns.name,id:h})})):r.addReference({element:a,property:l.ns.name,id:u}):(l?u=ku(l.type,u):c!=="xmlns"&&(s=pt(c,i.ns.prefix),o.getPackage(s.prefix)&&r.addWarning({message:"unknown attribute <"+c+">",element:a,property:c,value:u})),a.set(c,u))}),a};st.prototype.getPropertyForNode=function(e){var t=e.name,n=pt(t),i=this.type,r=this.model,a=gn(i),o=n.name,s=a.propertiesByName[o],u,c;if(s&&!s.isAttr)return td(s)&&(u=e.attributes[go],u)?(u=hE(u,r),c=r.getType(u),I({},s,{effectiveType:gn(c).name})):s;var l=r.getPackage(n.prefix);if(l){if(u=nd(n,l),c=r.getType(u),s=_e(a.properties,function(p){return!p.isVirtual&&!p.isReference&&!p.isAttribute&&c.hasType(p.type)}),s)return I({},s,{effectiveType:gn(c).name})}else if(s=_e(a.properties,function(p){return!p.isReference&&!p.isAttribute&&p.type==="Element"}),s)return s;throw kn("unrecognized element <"+n.name+">")};st.prototype.toString=function(){return"ElementDescriptor["+gn(this.type).name+"]"};st.prototype.valueHandler=function(e,t){return new $u(e,t)};st.prototype.referenceHandler=function(e){return new Nr(e,this.context)};st.prototype.handler=function(e){return e==="Element"?new Di(this.model,e,this.context):new st(this.model,e,this.context)};st.prototype.handleChild=function(e){var t,n,i,r;if(t=this.getPropertyForNode(e),i=this.element,n=t.effectiveType||t.type,Xh(n))return this.valueHandler(t,i);t.isReference?r=this.referenceHandler(t).handleNode(e):r=this.handler(n).handleNode(e);var a=r.element;return a!==void 0&&(t.isMany?i.get(t.name).push(a):i.set(t.name,a),t.isReference?(I(a,{element:i}),this.context.addReference(a)):a.$parent=i),r};function ju(e,t,n){st.call(this,e,t,n)}ju.prototype=Object.create(st.prototype);ju.prototype.createElement=function(e){var t=e.name,n=pt(t),i=this.model,r=this.type,a=i.getPackage(n.prefix),o=a&&nd(n,a)||t;if(!r.hasType(o))throw kn("unexpected element <"+e.originalName+">");return st.prototype.createElement.call(this,e)};function Di(e,t,n){this.model=e,this.context=n}Di.prototype=Object.create(yo.prototype);Di.prototype.createElement=function(e){var t=e.name,n=pt(t),i=n.prefix,r=e.ns[i+"$uri"],a=e.attributes;return this.model.createAny(t,r,a)};Di.prototype.handleChild=function(e){var t=new Di(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element,r;return i!==void 0&&(r=n.$children=n.$children||[],r.push(i),i.$parent=n),t};Di.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)};function Hu(e){e instanceof Bt&&(e={model:e}),I(this,{lax:!1},e)}Hu.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof st?(i=t,t={}):typeof t=="string"?(i=this.handler(t),t={}):typeof i=="string"&&(i=this.handler(i));var r=this.model,a=this.lax,o=new dE(I({},t,{rootHandler:i})),s=new Jh({proxy:!0}),u=mE();i.context=o,u.push(i);function c(_,D,B){var R=D(),L=R.line,z=R.column,q=R.data;q.charAt(0)==="<"&&q.indexOf(" ")!==-1&&(q=q.slice(0,q.indexOf(" "))+">");var W="unparsable content "+(q?q+" ":"")+`detected
	line: `+L+`
	column: `+z+`
	nested error: `+_.message;if(B)return o.addWarning({message:W,error:_}),!0;throw kn(W)}function l(_,D){return c(_,D,!0)}function p(){var _=o.elementsById,D=o.references,B,R;for(B=0;R=D[B];B++){var L=R.element,z=_[R.id],q=gn(L).propertiesByName[R.property];if(z||o.addWarning({message:"unresolved reference <"+R.id+">",element:R.element,property:R.property,value:R.id}),q.isMany){var W=L.get(q.name),X=W.indexOf(R);X===-1&&(X=W.length),z?W[X]=z:W.splice(X,1)}else L.set(q.name,z)}}function h(){u.pop().handleEnd()}var f=/^<\?xml /i,d=/ encoding="([^"]+)"/i,y=/^utf-8$/i;function x(_){if(!!f.test(_)){var D=d.exec(_),B=D&&D[1];!B||y.test(B)||o.addWarning({message:"unsupported document encoding <"+B+">, falling back to UTF-8"})}}function M(_,D){var B=u.peek();try{u.push(B.handleNode(_))}catch(R){c(R,D,a)&&u.push(new Lu)}}function P(_,D){try{u.peek().handleText(_)}catch(B){l(B,D)}}function w(_,D){!_.trim()||P(_,D)}var b=r.getPackages().reduce(function(_,D){return _[D.uri]=D.prefix,_},{"http://www.w3.org/XML/1998/namespace":"xml"});return s.ns(b).on("openTag",function(_,D,B,R){var L=_.attrs||{},z=Object.keys(L).reduce(function(W,X){var ge=D(L[X]);return W[X]=ge,W},{}),q={name:_.name,originalName:_.originalName,attributes:z,ns:_.ns};M(q,R)}).on("question",x).on("closeTag",h).on("cdata",P).on("text",function(_,D,B){w(D(_),B)}).on("error",c).on("warn",l),new Promise(function(_,D){var B;try{s.parse(e),p()}catch(W){B=W}var R=i.element;!B&&!R&&(B=kn("failed to parse document as <"+i.type.$descriptor.name+">"));var L=o.warnings,z=o.references,q=o.elementsById;return B?(B.warnings=L,D(B)):_({rootElement:R,elementsById:q,references:z,warnings:L})})};Hu.prototype.handler=function(e){return new ju(this.model,e)};function mE(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}var vE=`<?xml version="1.0" encoding="UTF-8"?>
`,gE=/<|>|'|"|&|\n\r|\n/g,id=/<|>|&/g;function yE(e){var t={},n={},i={},r=[],a=[];this.byUri=function(o){return n[o]||e&&e.byUri(o)},this.add=function(o,s){n[o.uri]=o,s?r.push(o):a.push(o),this.mapPrefix(o.prefix,o.uri)},this.uriByPrefix=function(o){return t[o||"xmlns"]},this.mapPrefix=function(o,s){t[o||"xmlns"]=s},this.getNSKey=function(o){return o.prefix!==void 0?o.uri+"|"+o.prefix:o.uri},this.logUsed=function(o){var s=o.uri,u=this.getNSKey(o);i[u]=this.byUri(s),e&&e.logUsed(o)},this.getUsed=function(o){function s(l){var p=u.getNSKey(l);return i[p]}var u=this,c=[].concat(r,a);return c.filter(s)}}function EE(e){return e.charAt(0).toLowerCase()+e.slice(1)}function bE(e,t){return Qh(t)?EE(e):e}function rd(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function ad(e){return Dt(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function xE(e){return e.getUsed().filter(function(t){return t.prefix!=="xml"}).map(function(t){var n="xmlns"+(t.prefix?":"+t.prefix:"");return{name:n,value:t.uri}})}function _E(e,t){return t.isGeneric?I({localName:t.ns.localName},e):I({localName:bE(t.ns.localName,t.$pkg)},e)}function wE(e,t){return I({localName:t.ns.localName},e)}function SE(e){var t=e.$descriptor;return se(t.properties,function(n){var i=n.name;if(n.isVirtual||!mn(e,i))return!1;var r=e[i];return r===n.default||r===null?!1:n.isMany?r.length:!0})}var CE={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},TE={"<":"lt",">":"gt","&":"amp"};function od(e,t,n){return e=Dt(e)?e:""+e,e.replace(t,function(i){return"&"+n[i]+";"})}function AE(e){return od(e,gE,CE)}function RE(e){return od(e,id,TE)}function PE(e){return se(e,function(t){return t.isAttr})}function DE(e){return se(e,function(t){return!t.isAttr})}function zu(e){this.tagName=e}zu.prototype.build=function(e){return this.element=e,this};zu.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()};function ui(){}ui.prototype.serializeValue=ui.prototype.serializeTo=function(e){e.append(this.escape?RE(this.value):this.value)};ui.prototype.build=function(e,t){return this.value=t,e.type==="String"&&t.search(id)!==-1&&(this.escape=!0),this};function Gu(e){this.tagName=e}rd(Gu,ui);Gu.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()};function Pe(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}Pe.prototype.build=function(e){this.element=e;var t=e.$descriptor,n=this.propertyDescriptor,i,r,a=t.isGeneric;return a?i=this.parseGeneric(e):i=this.parseNsAttributes(e),n?this.ns=this.nsPropertyTagName(n):this.ns=this.nsTagName(t),this.tagName=this.addTagName(this.ns),a||(r=SE(e),this.parseAttributes(PE(r)),this.parseContainments(DE(r))),this.parseGenericAttributes(e,i),this};Pe.prototype.nsTagName=function(e){var t=this.logNamespaceUsed(e.ns);return _E(t,e)};Pe.prototype.nsPropertyTagName=function(e){var t=this.logNamespaceUsed(e.ns);return wE(t,e)};Pe.prototype.isLocalNs=function(e){return e.uri===this.ns.uri};Pe.prototype.nsAttributeName=function(e){var t;if(Dt(e)?t=pt(e):t=e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:I({localName:t.localName},n)};Pe.prototype.parseGeneric=function(e){var t=this,n=this.body,i=[];return A(e,function(r,a){var o;a==="$body"?n.push(new ui().build({type:"String"},r)):a==="$children"?A(r,function(s){n.push(new Pe(t).build(s))}):a.indexOf("$")!==0&&(o=t.parseNsAttribute(e,a,r),o&&i.push({name:a,value:r}))}),i};Pe.prototype.parseNsAttribute=function(e,t,n){var i=e.$model,r=pt(t),a;if(r.prefix==="xmlns"&&(a={prefix:r.localName,uri:n}),!r.prefix&&r.localName==="xmlns"&&(a={uri:n}),!a)return{name:t,value:n};if(i&&i.getPackage(n))this.logNamespace(a,!0,!0);else{var o=this.logNamespaceUsed(a,!0);this.getNamespaces().logUsed(o)}};Pe.prototype.parseNsAttributes=function(e,t){var n=this,i=e.$attrs,r=[];return A(i,function(a,o){var s=n.parseNsAttribute(e,o,a);s&&r.push(s)}),r};Pe.prototype.parseGenericAttributes=function(e,t){var n=this;A(t,function(i){if(i.name!==go)try{n.addAttribute(n.nsAttributeName(i.name),i.value)}catch(r){console.warn("missing namespace information for ",i.name,"=",i.value,"on",e,r)}})};Pe.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;A(e,function(r){var a=i.get(r.name),o=r.isReference,s=r.isMany;if(s||(a=[a]),r.isBody)n.push(new ui().build(r,a[0]));else if(Xh(r.type))A(a,function(l){n.push(new Gu(t.addTagName(t.nsPropertyTagName(r))).build(r,l))});else if(o)A(a,function(l){n.push(new zu(t.addTagName(t.nsPropertyTagName(r))).build(l))});else{var u=td(r),c=lE(r);A(a,function(l){var p;u?p=new Eo(t,r):c?p=new Pe(t,r):p=new Pe(t),n.push(p.build(l))})}})};Pe.prototype.getNamespaces=function(e){var t=this.namespaces,n=this.parent,i;return t||(i=n&&n.getNamespaces(),e||!i?this.namespaces=t=new yE(i):t=i),t};Pe.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),r=e.uri,a=e.prefix,o=i.byUri(r);return(!o||n)&&i.add(e,t),i.mapPrefix(a,r),e};Pe.prototype.logNamespaceUsed=function(e,t){var n=this.element,i=n.$model,r=this.getNamespaces(t),a=e.prefix,o=e.uri,s,u,c;if(!a&&!o)return{localName:e.localName};if(c=cE[a]||i&&(i.getPackage(a)||{}).uri,o=o||c||r.uriByPrefix(a),!o)throw new Error("no namespace uri given for prefix <"+a+">");if(e=r.byUri(o),!e){for(s=a,u=1;r.uriByPrefix(s);)s=a+"_"+u++;e=this.logNamespace({prefix:s,uri:o},c===o)}return a&&r.mapPrefix(a,o),e};Pe.prototype.parseAttributes=function(e){var t=this,n=this.element;A(e,function(i){var r=n.get(i.name);if(i.isReference)if(!i.isMany)r=r.id;else{var a=[];A(r,function(o){a.push(o.id)}),r=a.join(" ")}t.addAttribute(t.nsAttributeName(i),r)})};Pe.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),ad(e)};Pe.prototype.addAttribute=function(e,t){var n=this.attrs;Dt(t)&&(t=AE(t)),n.push({name:e,value:t})};Pe.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=xE(n).concat(t)),A(t,function(i){e.append(" ").append(ad(i.name)).append('="').append(i.value).append('"')})};Pe.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==ui;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),A(this.body,function(i){i.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()};function Eo(e,t){Pe.call(this,e,t)}rd(Eo,Pe);Eo.prototype.parseNsAttributes=function(e){var t=Pe.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var r=e.$model.getPackage(i.uri),a=r.xml&&r.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(go),(i.prefix?i.prefix+":":"")+a+n.ns.localName),t};Eo.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri};function ME(){this.value="",this.write=function(e){this.value+=e}}function BE(e,t){var n=[""];this.append=function(i){return e.write(i),this},this.appendNewLine=function(){return t&&e.write(`
`),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function OE(e){e=I({format:!1,preamble:!0},e||{});function t(n,i){var r=i||new ME,a=new BE(r,e.format);if(e.preamble&&a.append(vE),new Pe().build(n).serializeTo(a),!i)return r.value}return{toXML:t}}function bo(e,t){Bt.call(this,e,t)}bo.prototype=Object.create(Bt.prototype);bo.prototype.fromXML=function(e,t,n){Dt(t)||(n=t,t="bpmn:Definitions");var i=new Hu(I({model:this,lax:!0},n)),r=i.handler(t);return i.fromXML(e,r)};bo.prototype.toXML=function(e,t){var n=new OE(t);return new Promise(function(i,r){try{var a=n.toXML(e);return i({xml:a})}catch(o){return r(o)}})};var IE="BPMN20",NE="http://www.omg.org/spec/BPMN/20100524/MODEL",FE="bpmn",kE=[],LE=[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",isMany:!0,replaces:"FlowElementsContainer#laneSets",type:"LaneSet"},{name:"flowElements",isMany:!0,replaces:"FlowElementsContainer#flowElements",type:"FlowElement"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}},{name:"assignment",type:"Assignment",isMany:!0}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",isBody:!0,type:"String"}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isMany:!0,isVirtual:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity","InteractionNode"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],$E=[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],jE={tagAlias:"lowerCase",typePrefix:"t"},HE={name:IE,uri:NE,prefix:FE,associations:kE,types:LE,enumerations:$E,xml:jE},zE="BPMNDI",GE="http://www.omg.org/spec/BPMN/20100524/DI",VE="bpmndi",WE=[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],UE=[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],YE=[],qE={name:zE,uri:GE,prefix:VE,types:WE,enumerations:UE,associations:YE},KE="DC",XE="http://www.omg.org/spec/DD/20100524/DC",ZE="dc",JE=[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],QE=[],eb={name:KE,uri:XE,prefix:ZE,types:JE,associations:QE},tb="DI",nb="http://www.omg.org/spec/DD/20100524/DI",ib="di",rb=[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],ab=[],ob={tagAlias:"lowerCase"},sb={name:tb,uri:nb,prefix:ib,types:rb,associations:ab,xml:ob},ub="bpmn.io colors for BPMN",cb="http://bpmn.io/schema/bpmn/biocolor/1.0",lb="bioc",pb=[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],fb=[],hb=[],db={name:ub,uri:cb,prefix:lb,types:pb,enumerations:fb,associations:hb},mb="BPMN in Color",vb="http://www.omg.org/spec/BPMN/non-normative/color/1.0",gb="color",yb=[{name:"ColoredLabel",extends:["bpmndi:BPMNLabel"],properties:[{name:"color",isAttr:!0,type:"String"}]},{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"background-color",isAttr:!0,type:"String"},{name:"border-color",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"border-color",isAttr:!0,type:"String"}]}],Eb=[],bb=[],xb={name:mb,uri:vb,prefix:gb,types:yb,enumerations:Eb,associations:bb},_b={bpmn:HE,bpmndi:qE,dc:eb,di:sb,bioc:db,color:xb};function wb(e,t){var n=I({},_b,e);return new bo(n,t)}function Ze(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}var Sb=new $i({name:"bpmnElement",enumerable:!0},{name:"di",configurable:!0});function dt(e,t){return e.$instanceOf(t)}function Cb(e){return _e(e.rootElements,function(t){return dt(t,"bpmn:Process")||dt(t,"bpmn:Collaboration")})}function Tb(e,t){var n={},i=[];function r(N,k){return function(G){N(G,k)}}function a(N){n[N.id]=N}function o(N){return n[N.id]}function s(N,k){var G=N.gfx;if(G)throw new Error(t("already rendered {element}",{element:Ze(N)}));return e.element(N,k)}function u(N,k){return e.root(N,k)}function c(N,k){try{var G=N.di&&s(N,k);return a(N),G}catch(re){l(re.message,{element:N,error:re}),console.error(t("failed to import {element}",{element:Ze(N)})),console.error(re)}}function l(N,k){e.error(N,k)}function p(N){var k=N.bpmnElement;k?k.di?l(t("multiple DI elements defined for {element}",{element:Ze(k)}),{element:k}):(Sb.bind(k,"di"),k.di=N):l(t("no bpmnElement referenced in {element}",{element:Ze(N)}),{element:N})}function h(N){f(N.plane)}function f(N){p(N),A(N.planeElement,d)}function d(N){p(N)}function y(N,k){var G=N.diagrams;if(k&&G.indexOf(k)===-1)throw new Error(t("diagram not part of bpmn:Definitions"));if(!k&&G&&G.length&&(k=G[0]),!k)throw new Error(t("no diagram to display"));h(k);var re=k.plane;if(!re)throw new Error(t("no plane for {element}",{element:Ze(k)}));var oe=re.bpmnElement;if(!oe)if(oe=Cb(N),oe)l(t("correcting missing bpmnElement on {plane} to {rootElement}",{plane:Ze(re),rootElement:Ze(oe)})),re.bpmnElement=oe,p(re);else throw new Error(t("no process or collaboration to display"));var Te=u(oe,re);if(dt(oe,"bpmn:Process"))M(oe,Te);else if(dt(oe,"bpmn:Collaboration"))O(oe),P(N.rootElements,Te);else throw new Error(t("unsupported bpmnElement for {plane}: {rootElement}",{plane:Ze(re),rootElement:Ze(oe)}));x()}function x(){for(var N;i.length;)N=i.shift(),N()}function M(N,k){S(N,k),z(N.ioSpecification,k),L(N.artifacts,k),a(N)}function P(N,k){var G=se(N,function(re){return!o(re)&&dt(re,"bpmn:Process")&&re.laneSets});G.forEach(r(M,k))}function w(N,k){c(N,k)}function b(N,k){A(N,r(w,k))}function _(N,k){c(N,k)}function D(N,k){c(N,k)}function B(N,k){c(N,k)}function R(N,k){c(N,k)}function L(N,k){A(N,function(G){dt(G,"bpmn:Association")?i.push(function(){R(G,k)}):R(G,k)})}function z(N,k){!N||(A(N.dataInputs,r(D,k)),A(N.dataOutputs,r(B,k)))}function q(N,k){S(N,k),L(N.artifacts,k)}function W(N,k){var G=c(N,k);dt(N,"bpmn:SubProcess")&&q(N,G||k),dt(N,"bpmn:Activity")&&z(N.ioSpecification,k),i.push(function(){A(N.dataInputAssociations,r(_,k)),A(N.dataOutputAssociations,r(_,k))})}function X(N,k){c(N,k)}function ge(N,k){c(N,k)}function Lt(N,k){i.push(function(){var G=c(N,k);N.childLaneSet&&be(N.childLaneSet,G||k),$(N)})}function be(N,k){A(N.lanes,r(Lt,k))}function le(N,k){A(N,r(be,k))}function S(N,k){m(N.flowElements,k),N.laneSets&&le(N.laneSets,k)}function m(N,k){A(N,function(G){dt(G,"bpmn:SequenceFlow")?i.push(function(){X(G,k)}):dt(G,"bpmn:BoundaryEvent")?i.unshift(function(){W(G,k)}):dt(G,"bpmn:FlowNode")?W(G,k):dt(G,"bpmn:DataObject")||(dt(G,"bpmn:DataStoreReference")||dt(G,"bpmn:DataObjectReference")?ge(G,k):l(t("unrecognized flowElement {element} in context {context}",{element:Ze(G),context:k?Ze(k.businessObject):"null"}),{element:G,context:k}))})}function T(N,k){var G=c(N,k),re=N.processRef;re&&M(re,G||k)}function O(N){A(N.participants,r(T)),L(N.artifacts),i.push(function(){b(N.messageFlows)})}function $(N){A(N.flowNodeRef,function(k){var G=k.get("lanes");G&&G.push(N)})}return{handleDeferred:x,handleDefinitions:y,handleSubProcess:q,registerDi:p}}function Ab(e,t,n){var i,r,a,o,s=[];function u(c,l){var p={root:function(f){return i.add(f)},element:function(f,d){return i.add(f,d)},error:function(f,d){s.push({message:f,context:d})}},h=new Tb(p,a);h.handleDefinitions(c,l)}return new Promise(function(c,l){try{return i=e.get("bpmnImporter"),r=e.get("eventBus"),a=e.get("translate"),r.fire("import.render.start",{definitions:t}),u(t,n),r.fire("import.render.complete",{error:o,warnings:s}),c({warnings:s})}catch(p){return p.warnings=s,l(p)}})}function Vi(e){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var t=arguments.length;if(t>=1&&ot(arguments[t-1])){var n=arguments[t-1];console.warn(new Error("Passing callbacks to "+e.name+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html"));var i=Array.prototype.slice.call(arguments,0,-1);e.apply(this,i).then(function(r){var a=Object.keys(r)[0];return n(null,r[a])},function(r){return n(r,r.warnings)})}else return e.apply(this,arguments)}}var Rb='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>',sd=Rb;function xo(e){return e.join(";")}var ud=xo(["color: #404040"]),Pb=xo(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"]),Db=xo(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"]),Mb=xo(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"]),Bb='<div class="bjs-powered-by-lightbox" style="'+Pb+'"><div class="backdrop" style="'+Db+'"></div><div class="notice" style="'+Mb+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;'+ud+'">'+sd+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>',rr;function Ob(){rr||(rr=Ae(Bb),xt.bind(rr,".backdrop","click",function(e){document.body.removeChild(rr)})),document.body.appendChild(rr)}function De(e){e=I({},Nb,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),kb(this._container),this._init(this._container,this._moddle,e)}Z(De,Hi);De.prototype.importXML=Vi(function(t,n){var i=this;function r(a){var o=i.get("eventBus").createEvent(a);return Object.defineProperty(o,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:a.warnings,references:a.references,elementsById:a.elementsById}}}),o}return new Promise(function(a,o){t=i._emit("import.parse.start",{xml:t})||t,i._moddle.fromXML(t,"bpmn:Definitions").then(function(s){var u=s.rootElement,c=s.references,l=s.warnings,p=s.elementsById;u=i._emit("import.parse.complete",r({error:null,definitions:u,elementsById:p,references:c,warnings:l}))||u,i.importDefinitions(u,n).then(function(h){var f=[].concat(l,h.warnings||[]);return i._emit("import.done",{error:null,warnings:f}),a({warnings:f})}).catch(function(h){var f=[].concat(l,h.warnings||[]);return i._emit("import.done",{error:h,warnings:f}),o(ja(h,f))})}).catch(function(s){return i._emit("import.parse.complete",{error:s}),s=Ib(s),i._emit("import.done",{error:s,warnings:s.warnings}),o(s)})})});De.prototype.importDefinitions=Vi(function(t,n){var i=this;return new Promise(function(r,a){i._setDefinitions(t),i.open(n).then(function(o){var s=o.warnings;return r({warnings:s})}).catch(function(o){return a(o)})})});De.prototype.open=Vi(function(t){var n=this._definitions,i=t,r=this;return new Promise(function(a,o){if(!n){var s=new Error("no XML imported");return o(ja(s,[]))}if(typeof t=="string"&&(i=Fb(n,t),!i)){var u=new Error("BPMNDiagram <"+t+"> not found");return o(ja(u,[]))}try{r.clear()}catch(c){return o(ja(c,[]))}Ab(r,n,i).then(function(c){var l=c.warnings;return a({warnings:l})}).catch(function(c){return o(c)})})});De.prototype.saveXML=Vi(function(t){t=t||{};var n=this,i=this._definitions;return new Promise(function(r){if(!i)return r({error:new Error("no definitions loaded")});i=n._emit("saveXML.start",{definitions:i})||i,n._moddle.toXML(i,t).then(function(a){var o=a.xml;return o=n._emit("saveXML.serialized",{xml:o})||o,r({xml:o})})}).catch(function(r){return{error:r}}).then(function(r){n._emit("saveXML.done",r);var a=r.error;return a?Promise.reject(a):r})});De.prototype.saveSVG=Vi(function(t){var n=this;return new Promise(function(i,r){n._emit("saveSVG.start");var a,o;try{var s=n.get("canvas"),u=s.getDefaultLayer(),c=Oe("defs",s._svg),l=Dl(u),p=c?"<defs>"+Dl(c)+"</defs>":"",h=u.getBBox();a=`<?xml version="1.0" encoding="utf-8"?>
<!-- created with bpmn-js / http://bpmn.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="`+h.width+'" height="'+h.height+'" viewBox="'+h.x+" "+h.y+" "+h.width+" "+h.height+'" version="1.1">'+p+l+"</svg>"}catch(f){o=f}return n._emit("saveSVG.done",{error:o,svg:a}),o?r(o):i({svg:a})})});De.prototype._setDefinitions=function(e){this._definitions=e};De.prototype.getModules=function(){return this._modules};De.prototype.clear=function(){!this.getDefinitions()||(this.get("elementRegistry").forEach(function(e){var t=e.businessObject;t&&t.di&&delete t.di}),Hi.prototype.clear.call(this))};De.prototype.destroy=function(){Hi.prototype.destroy.call(this),on(this._container)};De.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)};De.prototype.off=function(e,t){this.get("eventBus").off(e,t)};De.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),typeof e=="string"&&(e=Oe(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()};De.prototype.getDefinitions=function(){return this._definitions};De.prototype.detach=function(){var e=this._container,t=e.parentNode;!t||(this._emit("detach",{}),t.removeChild(e))};De.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),r=n.additionalModules||[],a=[{bpmnjs:["value",this],moddle:["value",t]}],o=[].concat(a,i,r),s=I($n(n,["additionalModules"]),{canvas:I({},n.canvas,{container:e}),modules:o});Hi.call(this,s),n&&n.container&&this.attachTo(n.container)};De.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)};De.prototype._createContainer=function(e){var t=Ae('<div class="bjs-container"></div>');return I(t.style,{width:Xl(e.width),height:Xl(e.height),position:e.position}),t};De.prototype._createModdle=function(e){var t=I({},this._moddleExtensions,e.moddleExtensions);return new wb(t)};De.prototype._modules=[];function ja(e,t){return e.warnings=t,e}function Ib(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/,n=t.exec(e.message);return n&&(e.message="unparsable content <"+n[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+n[2]),e}var Nb={width:"100%",height:"100%",position:"relative"};function Xl(e){return e+(ae(e)?"px":"")}function Fb(e,t){return t&&_e(e.diagrams,function(n){return n.id===t})||null}function kb(e){var t=sd,n='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100; '+ud+'">'+t+"</a>",i=Ae(n);e.appendChild(i),te.bind(i,"click",function(r){Ob(),r.preventDefault()})}function Fr(e){De.call(this,e),this.on("import.parse.complete",function(t){t.error||this._collectIds(t.definitions,t.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}Z(Fr,De);Fr.prototype._createModdle=function(e){var t=De.prototype._createModdle.call(this,e);return t.ids=new an([32,36,1]),t};Fr.prototype._collectIds=function(e,t){var n=e.$model,i=n.ids,r;i.clear();for(r in t)i.claim(r,t[r])};function v(e,t){var n=Y(e);return n&&typeof n.$instanceOf=="function"&&n.$instanceOf(t)}function ye(e,t){return ci(t,function(n){return v(e,n)})}function Y(e){return e&&e.businessObject||e}function Se(e){return v(e,"bpmn:CallActivity")?!1:v(e,"bpmn:SubProcess")?Y(e).di&&!!Y(e).di.isExpanded:v(e,"bpmn:Participant")?!!Y(e).processRef:!0}function Lb(e){return e&&Y(e).isInterrupting!==!1}function _t(e){return e&&!!Y(e).triggeredByEvent}function _o(e,t){var n=Y(e),i=!1;return n.eventDefinitions&&A(n.eventDefinitions,function(r){v(r,t)&&(i=!0)}),i}function $b(e){return _o(e,"bpmn:ErrorEventDefinition")}function jb(e){return _o(e,"bpmn:EscalationEventDefinition")}function Hb(e){return _o(e,"bpmn:CompensateEventDefinition")}function cd(e){if(v(e,"bpmn:FlowElement")||v(e,"bpmn:Participant")||v(e,"bpmn:Lane")||v(e,"bpmn:SequenceFlow")||v(e,"bpmn:MessageFlow")||v(e,"bpmn:DataInput")||v(e,"bpmn:DataOutput"))return"name";if(v(e,"bpmn:TextAnnotation"))return"text";if(v(e,"bpmn:Group"))return"categoryValueRef"}function zb(e){var t=e.categoryValueRef;return t&&t.value||""}function Ut(e){var t=e.businessObject,n=cd(t);if(n)return n==="categoryValueRef"?zb(t):t[n]||""}function Gb(e,t,n){var i=e.businessObject,r=cd(i);return r&&(r==="categoryValueRef"?i.categoryValueRef.value=t:i[r]=t),e}function Zt(e,t,n){function i(r,a){return Fi(a,function(o,s){return r[s]==o})}return ci(e.eventDefinitions,function(r){return r.$type===t&&i(e,n)})}function Vb(e){return e.$type==="bpmn:IntermediateThrowEvent"||e.$type==="bpmn:EndEvent"}function Wb(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}function Mi(e){return e.businessObject.di}function at(e){return e.businessObject}function me(e,t){var n=Mi(e);return n.get("color:background-color")||n.get("bioc:fill")||t||"white"}function V(e,t){var n=Mi(e);return n.get("color:border-color")||n.get("bioc:stroke")||t||"black"}function ar(e,t,n){var i=Mi(e),r=i.get("label");return r&&r.get("color:color")||t||V(e,n)}function Ub(e){var t=e.x+e.width/2,n=e.y+e.height/2,i=e.width/2,r=[["M",t,n],["m",0,-i],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]];return Li(r)}function Yb(e,t){var n=e.x,i=e.y,r=e.width,a=e.height,o=[["M",n+t,i],["l",r-t*2,0],["a",t,t,0,0,1,t,t],["l",0,a-t*2],["a",t,t,0,0,1,-t,t],["l",t*2-r,0],["a",t,t,0,0,1,-t,-t],["l",0,t*2-a],["a",t,t,0,0,1,t,-t],["z"]];return Li(o)}function qb(e){var t=e.width,n=e.height,i=e.x,r=e.y,a=t/2,o=n/2,s=[["M",i+a,r],["l",a,o],["l",-a,o],["l",-a,-o],["z"]];return Li(s)}function Kb(e){var t=e.x,n=e.y,i=e.width,r=e.height,a=[["M",t,n],["l",i,0],["l",0,r],["l",-i,0],["z"]];return Li(a)}var Xb=new an,Ha=10,Es=3,wi=.95,Zb=.35,Jb=10;function fi(e,t,n,i,r,a,o){En.call(this,t,o);var s=e&&e.defaultFillColor,u=e&&e.defaultStrokeColor,c=e&&e.defaultLabelColor,l=Xb.next(),p={},h=n.computeStyle;function f(S,m){var T=I({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},m.attrs),O=m.ref||{x:0,y:0},$=m.scale||1;T.strokeDasharray==="none"&&(T.strokeDasharray=[1e4,1]);var N=J("marker");H(m.element,T),ne(N,m.element),H(N,{id:S,viewBox:"0 0 20 20",refX:O.x,refY:O.y,markerWidth:20*$,markerHeight:20*$,orient:"auto"});var k=Oe("defs",r._svg);k||(k=J("defs"),ne(r._svg,k)),ne(k,N),p[S]=N}function d(S){return S.replace(/[^0-9a-zA-z]+/g,"_")}function y(S,m,T){var O=S+"-"+d(m)+"-"+d(T)+"-"+l;return p[O]||x(O,S,m,T),"url(#"+O+")"}function x(S,m,T,O){if(m==="sequenceflow-end"){var $=J("path");H($,{d:"M 1 5 L 11 10 L 1 15 Z"}),f(S,{element:$,ref:{x:11,y:10},scale:.5,attrs:{fill:O,stroke:O}})}if(m==="messageflow-start"){var N=J("circle");H(N,{cx:6,cy:6,r:3.5}),f(S,{element:N,attrs:{fill:T,stroke:O},ref:{x:6,y:6}})}if(m==="messageflow-end"){var k=J("path");H(k,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),f(S,{element:k,attrs:{fill:T,stroke:O,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if(m==="association-start"){var G=J("path");H(G,{d:"M 11 5 L 1 10 L 11 15"}),f(S,{element:G,attrs:{fill:"none",stroke:O,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if(m==="association-end"){var re=J("path");H(re,{d:"M 1 5 L 11 10 L 1 15"}),f(S,{element:re,attrs:{fill:"none",stroke:O,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if(m==="conditional-flow-marker"){var oe=J("path");H(oe,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),f(S,{element:oe,attrs:{fill:T,stroke:O},ref:{x:-1,y:10},scale:.5})}if(m==="conditional-default-flow-marker"){var Te=J("path");H(Te,{d:"M 6 4 L 10 16"}),f(S,{element:Te,attrs:{stroke:O},ref:{x:0,y:10},scale:.5})}}function M(S,m,T,O,$){Qe(O)&&($=O,O=0),O=O||0,$=h($,{stroke:"black",strokeWidth:2,fill:"white"}),$.fill==="none"&&delete $.fillOpacity;var N=m/2,k=T/2,G=J("circle");return H(G,{cx:N,cy:k,r:Math.round((m+T)/4-O)}),H(G,$),ne(S,G),G}function P(S,m,T,O,$,N){Qe($)&&(N=$,$=0),$=$||0,N=h(N,{stroke:"black",strokeWidth:2,fill:"white"});var k=J("rect");return H(k,{x:$,y:$,width:m-$*2,height:T-$*2,rx:O,ry:O}),H(k,N),ne(S,k),k}function w(S,m,T,O){var $=m/2,N=T/2,k=[{x:$,y:0},{x:m,y:N},{x:$,y:T},{x:0,y:N}],G=k.map(function(oe){return oe.x+","+oe.y}).join(" ");O=h(O,{stroke:"black",strokeWidth:2,fill:"white"});var re=J("polygon");return H(re,{points:G}),H(re,O),ne(S,re),re}function b(S,m,T){T=h(T,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var O=Du(m,T);return ne(S,O),O}function _(S,m,T){T=h(T,["no-fill"],{strokeWidth:2,stroke:"black"});var O=J("path");return H(O,{d:m}),H(O,T),ne(S,O),O}function D(S,m,T,O){return _(m,T,I({"data-marker":S},O))}function B(S){return function(m,T){return Lt[S](m,T)}}function R(S){return Lt[S]}function L(S,m){var T=at(S),O=Vb(T);return T.eventDefinitions&&T.eventDefinitions.length>1?T.parallelMultiple?R("bpmn:ParallelMultipleEventDefinition")(m,S,O):R("bpmn:MultipleEventDefinition")(m,S,O):Zt(T,"bpmn:MessageEventDefinition")?R("bpmn:MessageEventDefinition")(m,S,O):Zt(T,"bpmn:TimerEventDefinition")?R("bpmn:TimerEventDefinition")(m,S,O):Zt(T,"bpmn:ConditionalEventDefinition")?R("bpmn:ConditionalEventDefinition")(m,S):Zt(T,"bpmn:SignalEventDefinition")?R("bpmn:SignalEventDefinition")(m,S,O):Zt(T,"bpmn:EscalationEventDefinition")?R("bpmn:EscalationEventDefinition")(m,S,O):Zt(T,"bpmn:LinkEventDefinition")?R("bpmn:LinkEventDefinition")(m,S,O):Zt(T,"bpmn:ErrorEventDefinition")?R("bpmn:ErrorEventDefinition")(m,S,O):Zt(T,"bpmn:CancelEventDefinition")?R("bpmn:CancelEventDefinition")(m,S,O):Zt(T,"bpmn:CompensateEventDefinition")?R("bpmn:CompensateEventDefinition")(m,S,O):Zt(T,"bpmn:TerminateEventDefinition")?R("bpmn:TerminateEventDefinition")(m,S,O):null}function z(S,m,T){T=I({size:{width:100}},T);var O=a.createText(m||"",T);return fe(O).add("djs-label"),ne(S,O),O}function q(S,m,T){var O=at(m);return z(S,O.name,{box:m,align:T,padding:5,style:{fill:ar(m,c,u)}})}function W(S,m){var T={width:90,height:30,x:m.width/2+m.x,y:m.height/2+m.y};return z(S,Ut(m),{box:T,fitBox:!0,style:I({},a.getExternalStyle(),{fill:ar(m,c,u)})})}function X(S,m,T){var O=z(S,m,{box:{height:30,width:T.height},align:"center-middle",style:{fill:ar(T,c,u)}}),$=-1*T.height;Xs(O,0,-$,270)}function ge(S){for(var m=S.waypoints,T="m  "+m[0].x+","+m[0].y,O=1;O<m.length;O++)T+="L"+m[O].x+","+m[O].y+" ";return T}var Lt=this.handlers={"bpmn:Event":function(S,m,T){return"fillOpacity"in T||(T.fillOpacity=wi),M(S,m.width,m.height,T)},"bpmn:StartEvent":function(S,m){var T={fill:me(m,s),stroke:V(m,u)},O=at(m);O.isInterrupting||(T={strokeDasharray:"6",strokeLinecap:"round",fill:me(m,s),stroke:V(m,u)});var $=R("bpmn:Event")(S,m,T);return L(m,S),$},"bpmn:MessageEventDefinition":function(S,m,T){var O=i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:m.width,containerHeight:m.height,position:{mx:.235,my:.315}}),$=T?V(m,u):me(m,s),N=T?me(m,s):V(m,u),k=_(S,O,{strokeWidth:1,fill:$,stroke:N});return k},"bpmn:TimerEventDefinition":function(S,m){var T=M(S,m.width,m.height,.2*m.height,{strokeWidth:2,fill:me(m,s),stroke:V(m,u)}),O=i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.5}});_(S,O,{strokeWidth:2,strokeLinecap:"square",stroke:V(m,u)});for(var $=0;$<12;$++){var N=i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.5}}),k=m.width/2,G=m.height/2;_(S,N,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+$*30+","+G+","+k+")",stroke:V(m,u)})}return T},"bpmn:EscalationEventDefinition":function(S,m,T){var O=i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.2}}),$=T?V(m,u):"none";return _(S,O,{strokeWidth:1,fill:$,stroke:V(m,u)})},"bpmn:ConditionalEventDefinition":function(S,m){var T=i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.222}});return _(S,T,{strokeWidth:1,stroke:V(m,u)})},"bpmn:LinkEventDefinition":function(S,m,T){var O=i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.57,my:.263}}),$=T?V(m,u):"none";return _(S,O,{strokeWidth:1,fill:$,stroke:V(m,u)})},"bpmn:ErrorEventDefinition":function(S,m,T){var O=i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:m.width,containerHeight:m.height,position:{mx:.2,my:.722}}),$=T?V(m,u):"none";return _(S,O,{strokeWidth:1,fill:$,stroke:V(m,u)})},"bpmn:CancelEventDefinition":function(S,m,T){var O=i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.638,my:-.055}}),$=T?V(m,u):"none",N=_(S,O,{strokeWidth:1,fill:$,stroke:V(m,u)});return Uh(N,45),N},"bpmn:CompensateEventDefinition":function(S,m,T){var O=i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.22,my:.5}}),$=T?V(m,u):"none";return _(S,O,{strokeWidth:1,fill:$,stroke:V(m,u)})},"bpmn:SignalEventDefinition":function(S,m,T){var O=i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.2}}),$=T?V(m,u):"none";return _(S,O,{strokeWidth:1,fill:$,stroke:V(m,u)})},"bpmn:MultipleEventDefinition":function(S,m,T){var O=i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:m.width,containerHeight:m.height,position:{mx:.222,my:.36}}),$=T?V(m,u):"none";return _(S,O,{strokeWidth:1,fill:$})},"bpmn:ParallelMultipleEventDefinition":function(S,m){var T=i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:m.width,containerHeight:m.height,position:{mx:.458,my:.194}});return _(S,T,{strokeWidth:1,fill:V(m,u),stroke:V(m,u)})},"bpmn:EndEvent":function(S,m){var T=R("bpmn:Event")(S,m,{strokeWidth:4,fill:me(m,s),stroke:V(m,u)});return L(m,S),T},"bpmn:TerminateEventDefinition":function(S,m){var T=M(S,m.width,m.height,8,{strokeWidth:4,fill:V(m,u),stroke:V(m,u)});return T},"bpmn:IntermediateEvent":function(S,m){var T=R("bpmn:Event")(S,m,{strokeWidth:1,fill:me(m,s),stroke:V(m,u)});return M(S,m.width,m.height,Es,{strokeWidth:1,fill:me(m,"none"),stroke:V(m,u)}),L(m,S),T},"bpmn:IntermediateCatchEvent":B("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":B("bpmn:IntermediateEvent"),"bpmn:Activity":function(S,m,T){return T=T||{},"fillOpacity"in T||(T.fillOpacity=wi),P(S,m.width,m.height,Ha,T)},"bpmn:Task":function(S,m){var T={fill:me(m,s),stroke:V(m,u)},O=R("bpmn:Activity")(S,m,T);return q(S,m,"center-middle"),be(S,m),O},"bpmn:ServiceTask":function(S,m){var T=R("bpmn:Task")(S,m),O=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}});_(S,O,{strokeWidth:1,fill:me(m,s),stroke:V(m,u)});var $=i.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}});_(S,$,{strokeWidth:0,fill:me(m,s)});var N=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}});return _(S,N,{strokeWidth:1,fill:me(m,s),stroke:V(m,u)}),T},"bpmn:UserTask":function(S,m){var T=R("bpmn:Task")(S,m),O=15,$=12,N=i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:O,y:$}});_(S,N,{strokeWidth:.5,fill:me(m,s),stroke:V(m,u)});var k=i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:O,y:$}});_(S,k,{strokeWidth:.5,fill:me(m,s),stroke:V(m,u)});var G=i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:O,y:$}});return _(S,G,{strokeWidth:.5,fill:V(m,u),stroke:V(m,u)}),T},"bpmn:ManualTask":function(S,m){var T=R("bpmn:Task")(S,m),O=i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}});return _(S,O,{strokeWidth:.5,fill:me(m,s),stroke:V(m,u)}),T},"bpmn:SendTask":function(S,m){var T=R("bpmn:Task")(S,m),O=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}});return _(S,O,{strokeWidth:1,fill:V(m,u),stroke:me(m,s)}),T},"bpmn:ReceiveTask":function(S,m){var T=at(m),O=R("bpmn:Task")(S,m),$;return T.instantiate?(M(S,28,28,20*.22,{strokeWidth:1}),$=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):$=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),_(S,$,{strokeWidth:1,fill:me(m,s),stroke:V(m,u)}),O},"bpmn:ScriptTask":function(S,m){var T=R("bpmn:Task")(S,m),O=i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}});return _(S,O,{strokeWidth:1,stroke:V(m,u)}),T},"bpmn:BusinessRuleTask":function(S,m){var T=R("bpmn:Task")(S,m),O=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),$=_(S,O);H($,{strokeWidth:1,fill:me(m,"#aaaaaa"),stroke:V(m,u)});var N=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),k=_(S,N);return H(k,{strokeWidth:1,stroke:V(m,u)}),T},"bpmn:SubProcess":function(S,m,T){T=I({fill:me(m,s),stroke:V(m,u)},T);var O=R("bpmn:Activity")(S,m,T),$=Se(m);return _t(m)&&H(O,{strokeDasharray:"1,2"}),q(S,m,$?"center-top":"center-middle"),$?be(S,m):be(S,m,["SubProcessMarker"]),O},"bpmn:AdHocSubProcess":function(S,m){return R("bpmn:SubProcess")(S,m)},"bpmn:Transaction":function(S,m){var T=R("bpmn:SubProcess")(S,m),O=n.style(["no-fill","no-events"],{stroke:V(m,u)});return P(S,m.width,m.height,Ha-2,Es,O),T},"bpmn:CallActivity":function(S,m){return R("bpmn:SubProcess")(S,m,{strokeWidth:5})},"bpmn:Participant":function(S,m){var T={fillOpacity:wi,fill:me(m,s),stroke:V(m,u)},O=R("bpmn:Lane")(S,m,T),$=Se(m);if($){b(S,[{x:30,y:0},{x:30,y:m.height}],{stroke:V(m,u)});var N=at(m).name;X(S,N,m)}else{var k=at(m).name;z(S,k,{box:m,align:"center-middle",style:{fill:ar(m,c,u)}})}var G=!!at(m).participantMultiplicity;return G&&R("ParticipantMultiplicityMarker")(S,m),O},"bpmn:Lane":function(S,m,T){var O=P(S,m.width,m.height,0,I({fill:me(m,s),fillOpacity:Zb,stroke:V(m,u)},T)),$=at(m);if($.$type==="bpmn:Lane"){var N=$.name;X(S,N,m)}return O},"bpmn:InclusiveGateway":function(S,m){var T=R("bpmn:Gateway")(S,m);return M(S,m.width,m.height,m.height*.24,{strokeWidth:2.5,fill:me(m,s),stroke:V(m,u)}),T},"bpmn:ExclusiveGateway":function(S,m){var T=R("bpmn:Gateway")(S,m),O=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:m.width,containerHeight:m.height,position:{mx:.32,my:.3}});return Mi(m).isMarkerVisible&&_(S,O,{strokeWidth:1,fill:V(m,u),stroke:V(m,u)}),T},"bpmn:ComplexGateway":function(S,m){var T=R("bpmn:Gateway")(S,m),O=i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:m.width,containerHeight:m.height,position:{mx:.46,my:.26}});return _(S,O,{strokeWidth:1,fill:V(m,u),stroke:V(m,u)}),T},"bpmn:ParallelGateway":function(S,m){var T=R("bpmn:Gateway")(S,m),O=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:m.width,containerHeight:m.height,position:{mx:.46,my:.2}});return _(S,O,{strokeWidth:1,fill:V(m,u),stroke:V(m,u)}),T},"bpmn:EventBasedGateway":function(S,m){var T=at(m),O=R("bpmn:Gateway")(S,m);M(S,m.width,m.height,m.height*.2,{strokeWidth:1,fill:"none",stroke:V(m,u)});var $=T.eventGatewayType,N=!!T.instantiate;function k(){var Te=i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:m.width,containerHeight:m.height,position:{mx:.36,my:.44}}),pe={strokeWidth:2,fill:me(m,"none"),stroke:V(m,u)};_(S,Te,pe)}if($==="Parallel"){var G=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:m.width,containerHeight:m.height,position:{mx:.474,my:.296}}),re=_(S,G);H(re,{strokeWidth:1,fill:"none"})}else if($==="Exclusive"){if(!N){var oe=M(S,m.width,m.height,m.height*.26);H(oe,{strokeWidth:1,fill:"none",stroke:V(m,u)})}k()}return O},"bpmn:Gateway":function(S,m){var T={fill:me(m,s),fillOpacity:wi,stroke:V(m,u)};return w(S,m.width,m.height,T)},"bpmn:SequenceFlow":function(S,m){var T=ge(m),O=me(m,s),$=V(m,u),N={strokeLinejoin:"round",markerEnd:y("sequenceflow-end",O,$),stroke:V(m,u)},k=_(S,T,N),G=at(m),re;return m.source&&(re=m.source.businessObject,G.conditionExpression&&re.$instanceOf("bpmn:Activity")&&H(k,{markerStart:y("conditional-flow-marker",O,$)}),re.default&&(re.$instanceOf("bpmn:Gateway")||re.$instanceOf("bpmn:Activity"))&&re.default===G&&H(k,{markerStart:y("conditional-default-flow-marker",O,$)})),k},"bpmn:Association":function(S,m,T){var O=at(m),$=me(m,s),N=V(m,u);return T=I({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:V(m,u)},T||{}),(O.associationDirection==="One"||O.associationDirection==="Both")&&(T.markerEnd=y("association-end",$,N)),O.associationDirection==="Both"&&(T.markerStart=y("association-start",$,N)),b(S,m.waypoints,T)},"bpmn:DataInputAssociation":function(S,m){var T=me(m,s),O=V(m,u);return R("bpmn:Association")(S,m,{markerEnd:y("association-end",T,O)})},"bpmn:DataOutputAssociation":function(S,m){var T=me(m,s),O=V(m,u);return R("bpmn:Association")(S,m,{markerEnd:y("association-end",T,O)})},"bpmn:MessageFlow":function(S,m){var T=at(m),O=Mi(m),$=me(m,s),N=V(m,u),k=ge(m),G={markerEnd:y("messageflow-end",$,N),markerStart:y("messageflow-start",$,N),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:V(m,u)},re=_(S,k,G);if(T.messageRef){var oe=re.getPointAtLength(re.getTotalLength()/2),Te=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:oe.x,y:oe.y}}),pe={strokeWidth:1};O.messageVisibleKind==="initiating"?(pe.fill="white",pe.stroke="black"):(pe.fill="#888",pe.stroke="white");var de=_(S,Te,pe),Ve=T.messageRef.name,We=z(S,Ve,{align:"center-top",fitBox:!0,style:{fill:V(m,c)}}),we=de.getBBox(),Re=We.getBBox(),ut=oe.x-Re.width/2,ct=oe.y+we.height/2+Jb;Xs(We,ut,ct,0)}return re},"bpmn:DataObject":function(S,m){var T=i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.474,my:.296}}),O=_(S,T,{fill:me(m,s),fillOpacity:wi,stroke:V(m,u)}),$=at(m);return Wb($)&&le(S,m),O},"bpmn:DataObjectReference":B("bpmn:DataObject"),"bpmn:DataInput":function(S,m){var T=i.getRawPath("DATA_ARROW"),O=R("bpmn:DataObject")(S,m);return _(S,T,{strokeWidth:1}),O},"bpmn:DataOutput":function(S,m){var T=i.getRawPath("DATA_ARROW"),O=R("bpmn:DataObject")(S,m);return _(S,T,{strokeWidth:1,fill:"black"}),O},"bpmn:DataStoreReference":function(S,m){var T=i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:0,my:.133}}),O=_(S,T,{strokeWidth:2,fill:me(m,s),fillOpacity:wi,stroke:V(m,u)});return O},"bpmn:BoundaryEvent":function(S,m){var T=at(m),O=T.cancelActivity,$={strokeWidth:1,fill:me(m,s),stroke:V(m,u)};O||($.strokeDasharray="6",$.strokeLinecap="round");var N=I({},$,{fillOpacity:1}),k=I({},$,{fill:"none"}),G=R("bpmn:Event")(S,m,N);return M(S,m.width,m.height,Es,k),L(m,S),G},"bpmn:Group":function(S,m){var T=P(S,m.width,m.height,Ha,{stroke:V(m,u),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"});return T},label:function(S,m){return W(S,m)},"bpmn:TextAnnotation":function(S,m){var T={fill:"none",stroke:"none"},O=P(S,m.width,m.height,0,0,T),$=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:0,my:0}});_(S,$,{stroke:V(m,u)});var N=at(m).text||"";return z(S,N,{box:m,align:"left-top",padding:5,style:{fill:ar(m,c,u)}}),O},ParticipantMultiplicityMarker:function(S,m){var T=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:m.width/2/m.width,my:(m.height-15)/m.height}});D("participant-multiplicity",S,T,{strokeWidth:2,fill:me(m,s),stroke:V(m,u)})},SubProcessMarker:function(S,m){var T=P(S,14,14,0,{strokeWidth:1,fill:me(m,s),stroke:V(m,u)});mt(T,m.width/2-7.5,m.height-20);var O=i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2-7.5)/m.width,my:(m.height-20)/m.height}});D("sub-process",S,O,{fill:me(m,s),stroke:V(m,u)})},ParallelMarker:function(S,m,T){var O=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+T.parallel)/m.width,my:(m.height-20)/m.height}});D("parallel",S,O,{fill:me(m,s),stroke:V(m,u)})},SequentialMarker:function(S,m,T){var O=i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+T.seq)/m.width,my:(m.height-19)/m.height}});D("sequential",S,O,{fill:me(m,s),stroke:V(m,u)})},CompensationMarker:function(S,m,T){var O=i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+T.compensation)/m.width,my:(m.height-13)/m.height}});D("compensation",S,O,{strokeWidth:1,fill:me(m,s),stroke:V(m,u)})},LoopMarker:function(S,m,T){var O=i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+T.loop)/m.width,my:(m.height-7)/m.height}});D("loop",S,O,{strokeWidth:1,fill:me(m,s),stroke:V(m,u),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(S,m,T){var O=i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+T.adhoc)/m.width,my:(m.height-15)/m.height}});D("adhoc",S,O,{strokeWidth:1,fill:V(m,u),stroke:V(m,u)})}};function be(S,m,T){var O=at(m),$=T&&T.indexOf("SubProcessMarker")!==-1,N;$?N={seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:N={seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},A(T,function(re){R(re)(S,m,N)}),O.isForCompensation&&R("CompensationMarker")(S,m,N),O.$type==="bpmn:AdHocSubProcess"&&R("AdhocMarker")(S,m,N);var k=O.loopCharacteristics,G=k&&k.isSequential;k&&(G===void 0&&R("LoopMarker")(S,m,N),G===!1&&R("ParallelMarker")(S,m,N),G===!0&&R("SequentialMarker")(S,m,N))}function le(S,m){var T=(m.height-18)/m.height,O=i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.33,my:T}});_(S,O,{strokeWidth:2})}this._drawPath=_}Z(fi,En);fi.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"];fi.prototype.canRender=function(e){return v(e,"bpmn:BaseElement")};fi.prototype.drawShape=function(e,t){var n=t.type,i=this.handlers[n];return i(e,t)};fi.prototype.drawConnection=function(e,t){var n=t.type,i=this.handlers[n];return i(e,t)};fi.prototype.getShapePath=function(e){return v(e,"bpmn:Event")?Ub(e):v(e,"bpmn:Activity")?Yb(e,Ha):v(e,"bpmn:Gateway")?qb(e):Kb(e)};var Qb=0,ex={width:150,height:50};function tx(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}function nx(e){return Qe(e)?I({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}function ix(e,t){t.textContent=e;var n;try{var i,r=e==="";return t.textContent=r?"dummy":e,n=t.getBBox(),i={width:n.width+n.x*2,height:n.height},r&&(i.width=0),i}catch{return{width:0,height:0}}}function rx(e,t,n){for(var i=e.shift(),r=i,a;;){if(a=ix(r,n),a.width=r?a.width:0,r===" "||r===""||a.width<Math.round(t)||r.length<2)return ax(e,r,i,a);r=sx(r,a.width,t)}}function ax(e,t,n,i){if(t.length<n.length){var r=n.slice(t.length).trim();e.unshift(r)}return{width:i.width,height:i.height,text:t}}var Zl="\xAD";function ox(e,t){var n=e.split(/(\s|-|\u00AD)/g),i,r=[],a=0;if(n.length>1)for(;i=n.shift();)if(i.length+a<t)r.push(i),a+=i.length;else{(i==="-"||i===Zl)&&r.pop();break}var o=r[r.length-1];return o&&o===Zl&&(r[r.length-1]="-"),r.join("")}function sx(e,t,n){var i=Math.max(e.length*(n/t),1),r=ox(e,i);return r||(r=e.slice(0,Math.max(Math.round(i-1),1))),r}function ux(){var e=document.getElementById("helper-svg");return e||(e=J("svg"),H(e,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}function wo(e){this._config=I({},{size:ex,padding:Qb,style:{},align:"center-top"},e||{})}wo.prototype.createText=function(e,t){return this.layoutText(e,t).element};wo.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions};wo.prototype.layoutText=function(e,t){var n=I({},this._config.size,t.box),i=I({},this._config.style,t.style),r=tx(t.align||this._config.align),a=nx(t.padding!==void 0?t.padding:this._config.padding),o=t.fitBox||!1,s=cx(i),u=e.split(/\u00AD?\r?\n/),c=[],l=n.width-a.left-a.right,p=J("text");H(p,{x:0,y:0}),H(p,i);var h=ux();for(ne(h,p);u.length;)c.push(rx(u,l,p));r.vertical==="middle"&&(a.top=a.bottom=0);var f=wt(c,function(P,w,b){return P+(s||w.height)},0)+a.top+a.bottom,d=wt(c,function(P,w,b){return w.width>P?w.width:P},0),y=a.top;r.vertical==="middle"&&(y+=(n.height-f)/2),y-=(s||c[0].height)/4;var x=J("text");H(x,i),A(c,function(P){var w;switch(y+=s||P.height,r.horizontal){case"left":w=a.left;break;case"right":w=(o?d:l)-a.right-P.width;break;default:w=Math.max(((o?d:l)-P.width)/2+a.left,0)}var b=J("tspan");H(b,{x:w,y}),b.textContent=P.text,ne(x,b)}),ke(p);var M={width:d,height:f};return{dimensions:M,element:x}};function cx(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}var lx=12,px=1.2,fx=30;function ld(e){var t=I({fontFamily:"Arial, sans-serif",fontSize:lx,fontWeight:"normal",lineHeight:px},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,i=I({},t,{fontSize:n},e&&e.externalStyle||{}),r=new wo({style:t});this.getExternalLabelBounds=function(a,o){var s=r.getDimensions(o,{box:{width:90,height:30,x:a.width/2+a.x,y:a.height/2+a.y},style:i});return{x:Math.round(a.x+a.width/2-s.width/2),y:Math.round(a.y),width:Math.ceil(s.width),height:Math.ceil(s.height)}},this.getTextAnnotationBounds=function(a,o){var s=r.getDimensions(o,{box:a,style:t,align:"left-top",padding:5});return{x:a.x,y:a.y,width:a.width,height:Math.max(fx,Math.round(s.height))}},this.createText=function(a,o){return r.createText(a,o||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return i}}ld.$inject=["config.textRenderer"];function hx(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(t){return this.pathMap[t].d},this.getScaledPath=function(t,n){var i=this.pathMap[t],r,a;n.abspos?(r=n.abspos.x,a=n.abspos.y):(r=n.containerWidth*n.position.mx,a=n.containerHeight*n.position.my);var o={};if(n.position){for(var s=n.containerHeight/i.height*n.yScaleFactor,u=n.containerWidth/i.width*n.xScaleFactor,c=0;c<i.heightElements.length;c++)o["y"+c]=i.heightElements[c]*s;for(var l=0;l<i.widthElements.length;l++)o["x"+l]=i.widthElements[l]*u}var p=gx(i.d,{mx:r,my:a,e:o});return p}}var dx=/\{([^{}]+)\}/g,mx=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;function vx(e,t,n){var i=n;return t.replace(mx,function(r,a,o,s,u){a=a||s,i&&(a in i&&(i=i[a]),typeof i=="function"&&u&&(i=i()))}),i=(i==null||i==n?e:i)+"",i}function gx(e,t){return String(e).replace(dx,function(n,i){return vx(n,i,t)})}var yx={__init__:["bpmnRenderer"],bpmnRenderer:["type",fi],textRenderer:["type",ld],pathMap:["type",hx]};function Ex(e,t){return t=t||{},e.replace(/{([^}]+)}/g,function(n,i){return t[i]||"{"+i+"}"})}var So={translate:["value",Ex]},Sr={width:90,height:20},Jl=15;function Bi(e){return v(e,"bpmn:Event")||v(e,"bpmn:Gateway")||v(e,"bpmn:DataStoreReference")||v(e,"bpmn:DataObjectReference")||v(e,"bpmn:DataInput")||v(e,"bpmn:DataOutput")||v(e,"bpmn:SequenceFlow")||v(e,"bpmn:MessageFlow")||v(e,"bpmn:Group")}function Co(e){return Je(e.label)}function bx(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)],r=xx(e),a=Math.atan((i.y-n.y)/(i.x-n.x)),o=r.x,s=r.y;return Math.abs(a)<Math.PI/2?s-=Jl:o+=Jl,{x:o,y:s}}function xx(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)];return{x:n.x+(i.x-n.x)/2,y:n.y+(i.y-n.y)/2}}function To(e){return e.waypoints?bx(e.waypoints):v(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+Sr.height/2}:{x:e.x+e.width/2,y:e.y+e.height+Sr.height/2}}function _x(e,t){var n,i,r,a=e.di,o=a.label;return o&&o.bounds?(r=o.bounds,i={width:Math.max(Sr.width,r.width),height:r.height},n={x:r.x+r.width/2,y:r.y+r.height/2}):(n=To(t),i=Sr),I({x:n.x-i.width/2,y:n.y-i.height/2},i)}function Je(e){return e&&!!e.labelTarget}function za(e,t){return I({id:e.id,type:e.$type,businessObject:e},t)}function wx(e,t,n){var i=e.di.waypoint;return!i||i.length<2?[ue(t),ue(n)]:i.map(function(r){return{x:r.x,y:r.y}})}function pd(e,t,n,i){return new Error(e("element {element} referenced by {referenced}#{property} not yet drawn",{element:Ze(n),referenced:Ze(t),property:i}))}function xn(e,t,n,i,r,a){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i,this._translate=r,this._textRenderer=a}xn.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"];xn.prototype.add=function(e,t){var n=e.di,i,r=this._translate,a,o;if(v(n,"bpmndi:BPMNPlane"))i=this._elementFactory.createRoot(za(e)),this._canvas.setRootElement(i);else if(v(n,"bpmndi:BPMNShape")){var s=!Se(e),u=Cx(e);a=t&&(t.hidden||t.collapsed);var c=e.di.bounds;i=this._elementFactory.createShape(za(e,{collapsed:s,hidden:a,x:Math.round(c.x),y:Math.round(c.y),width:Math.round(c.width),height:Math.round(c.height),isFrame:u})),v(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,i),v(e,"bpmn:Lane")&&(o=0),v(e,"bpmn:DataStoreReference")&&(Sx(t,ue(c))||(t=this._canvas.getRootElement())),this._canvas.addShape(i,t,o)}else if(v(n,"bpmndi:BPMNEdge")){var l=this._getSource(e),p=this._getTarget(e);a=t&&(t.hidden||t.collapsed),i=this._elementFactory.createConnection(za(e,{hidden:a,source:l,target:p,waypoints:wx(e,l,p)})),v(e,"bpmn:DataAssociation")&&(t=null),v(e,"bpmn:SequenceFlow")&&(o=0),this._canvas.addConnection(i,t,o)}else throw new Error(r("unknown di {di} for element {semantic}",{di:Ze(n),semantic:Ze(e)}));return Bi(e)&&Ut(i)&&this.addLabel(e,i),this._eventBus.fire("bpmnElement.added",{element:i}),i};xn.prototype._attachBoundary=function(e,t){var n=this._translate,i=e.attachedToRef;if(!i)throw new Error(n("missing {semantic}#attachedToRef",{semantic:Ze(e)}));var r=this._elementRegistry.get(i.id),a=r&&r.attachers;if(!r)throw pd(n,e,i,"attachedToRef");t.host=r,a||(r.attachers=a=[]),a.indexOf(t)===-1&&a.push(t)};xn.prototype.addLabel=function(e,t){var n,i,r;return n=_x(e,t),i=Ut(t),i&&(n=this._textRenderer.getExternalLabelBounds(n,i)),r=this._elementFactory.createLabel(za(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden||!Ut(t),x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)})),this._canvas.addShape(r,t.parent)};xn.prototype._getEnd=function(e,t){var n,i,r=e.$type,a=this._translate;if(i=e[t+"Ref"],t==="source"&&r==="bpmn:DataInputAssociation"&&(i=i&&i[0]),(t==="source"&&r==="bpmn:DataOutputAssociation"||t==="target"&&r==="bpmn:DataInputAssociation")&&(i=e.$parent),n=i&&this._getElement(i),n)return n;throw i?pd(a,e,i,t+"Ref"):new Error(a("{semantic}#{side} Ref not specified",{semantic:Ze(e),side:t}))};xn.prototype._getSource=function(e){return this._getEnd(e,"source")};xn.prototype._getTarget=function(e){return this._getEnd(e,"target")};xn.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};function Sx(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function Cx(e){return v(e,"bpmn:Group")}var Tx={__depends__:[So],bpmnImporter:["type",xn]},Ax={__depends__:[yx,Tx]};function Ql(e){!e||typeof e.stopPropagation!="function"||e.stopPropagation()}function Wi(e){return e.originalEvent||e.srcEvent}function bs(e,t){Ql(e),Ql(Wi(e))}function Ln(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}function Rx(){return/mac/i.test(navigator.platform)}function fd(e,t){return(Wi(e)||e).button===t}function zn(e){return fd(e,0)}function Px(e){return fd(e,1)}function Oi(e){var t=Wi(e)||e;return zn(e)?Rx()?t.metaKey:t.ctrlKey:!1}function hd(e){var t=Wi(e)||e;return zn(e)&&t.shiftKey}function Dx(e){return!0}function ga(e){return zn(e)||Px(e)}var ep=500;function dd(e,t,n){var i=this;function r(B,R,L){if(!s(B,R)){var z,q,W;L?q=t.getGraphics(L):(z=R.delegateTarget||R.target,z&&(q=z,L=t.get(q))),!(!q||!L)&&(W=e.fire(B,{element:L,gfx:q,originalEvent:R}),W===!1&&(R.stopPropagation(),R.preventDefault()))}}var a={};function o(B){return a[B]}function s(B,R){var L=c[B]||zn;return!L(R)}var u={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},c={"element.contextmenu":Dx,"element.mousedown":ga,"element.mouseup":ga,"element.click":ga,"element.dblclick":ga};function l(B,R,L){var z=u[B];if(!z)throw new Error("unmapped DOM event name <"+B+">");return r(z,R,L)}var p="svg, .djs-element";function h(B,R,L,z){var q=a[L]=function(W){r(L,W)};z&&(c[L]=z),q.$delegate=xt.bind(B,p,R,q)}function f(B,R,L){var z=o(L);!z||xt.unbind(B,R,z.$delegate)}function d(B){A(u,function(R,L){h(B,L,R)})}function y(B){A(u,function(R,L){f(B,L,R)})}e.on("canvas.destroy",function(B){y(B.svg)}),e.on("canvas.init",function(B){d(B.svg)}),e.on(["shape.added","connection.added"],function(B){var R=B.element,L=B.gfx;e.fire("interactionEvents.createHit",{element:R,gfx:L})}),e.on(["shape.changed","connection.changed"],ep,function(B){var R=B.element,L=B.gfx;e.fire("interactionEvents.updateHit",{element:R,gfx:L})}),e.on("interactionEvents.createHit",ep,function(B){var R=B.element,L=B.gfx;i.createDefaultHit(R,L)}),e.on("interactionEvents.updateHit",function(B){var R=B.element,L=B.gfx;i.updateDefaultHit(R,L)});var x=b("djs-hit djs-hit-stroke"),M=b("djs-hit djs-hit-click-stroke"),P=b("djs-hit djs-hit-all"),w={all:P,"click-stroke":M,stroke:x};function b(B,R){return R=I({stroke:"white",strokeWidth:15},R||{}),n.cls(B,["no-fill","no-border"],R)}function _(B,R){var L=w[R];if(!L)throw new Error("invalid hit type <"+R+">");return H(B,L),B}function D(B,R){ne(B,R)}this.removeHits=function(B){var R=js(".djs-hit",B);A(R,ke)},this.createDefaultHit=function(B,R){var L=B.waypoints,z=B.isFrame,q;return L?this.createWaypointsHit(R,L):(q=z?"stroke":"all",this.createBoxHit(R,q,{width:B.width,height:B.height}))},this.createWaypointsHit=function(B,R){var L=Du(R);return _(L,"stroke"),D(B,L),L},this.createBoxHit=function(B,R,L){L=I({x:0,y:0},L);var z=J("rect");return _(z,R),H(z,L),D(B,z),z},this.updateDefaultHit=function(B,R){var L=Oe(".djs-hit",R);if(!!L)return B.waypoints?fy(L,B.waypoints):H(L,{width:B.width,height:B.height}),L},this.fire=r,this.triggerMouseEvent=l,this.mouseHandler=o,this.registerEvent=h,this.unregisterEvent=f}dd.$inject=["eventBus","elementRegistry","styles"];var kr={__init__:["interactionEvents"],interactionEvents:["type",dd]},Mx=500;function Ao(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),r=this;function a(o,s){var u=J("rect");return H(u,I({x:10,y:10,width:100,height:100},i)),ne(o,u),u}e.on(["shape.added","shape.changed"],Mx,function(o){var s=o.element,u=o.gfx,c=Oe(".djs-outline",u);c||(c=a(u)),r.updateShapeOutline(c,s)}),e.on(["connection.added","connection.changed"],function(o){var s=o.element,u=o.gfx,c=Oe(".djs-outline",u);c||(c=a(u)),r.updateConnectionOutline(c,s)})}Ao.prototype.updateShapeOutline=function(e,t){H(e,{x:-this.offset,y:-this.offset,width:t.width+this.offset*2,height:t.height+this.offset*2})};Ao.prototype.updateConnectionOutline=function(e,t){var n=et(t);H(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+this.offset*2,height:n.height+this.offset*2})};Ao.$inject=["eventBus","styles","elementRegistry"];var md={__init__:["outline"],outline:["type",Ao]};function Ui(e,t){this._eventBus=e,this._canvas=t,this._selectedElements=[];var n=this;e.on(["shape.remove","connection.remove"],function(i){var r=i.element;n.deselect(r)}),e.on(["diagram.clear","plane.set"],function(i){n.select(null)})}Ui.$inject=["eventBus","canvas"];Ui.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(n!==-1){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}};Ui.prototype.get=function(){return this._selectedElements};Ui.prototype.isSelected=function(e){return this._selectedElements.indexOf(e)!==-1};Ui.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();he(e)||(e=e?[e]:[]);var r=this._canvas;e=e.filter(function(a){var o=r.findPlane(a);return o===r.getActivePlane()}),t?A(e,function(a){n.indexOf(a)===-1&&n.push(a)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var tp="hover",np="selected";function vd(e,t,n,i){this._multiSelectionBox=null;function r(o,s){t.addMarker(o,s)}function a(o,s){t.removeMarker(o,s)}e.on("element.hover",function(o){r(o.element,tp)}),e.on("element.out",function(o){a(o.element,tp)}),e.on("selection.changed",function(o){function s(p){a(p,np)}function u(p){r(p,np)}var c=o.oldSelection,l=o.newSelection;A(c,function(p){l.indexOf(p)===-1&&s(p)}),A(l,function(p){c.indexOf(p)===-1&&u(p)})})}vd.$inject=["eventBus","canvas","selection","styles"];function gd(e,t,n,i){e.on("create.end",500,function(r){var a=r.context,o=a.canExecute,s=a.elements,u=a.hints||{},c=u.autoSelect;if(o){if(c===!1)return;he(c)?t.select(c):t.select(s.filter(Bx))}}),e.on("connect.end",500,function(r){var a=r.context,o=a.canExecute,s=a.hover;o&&s&&t.select(s)}),e.on("shape.move.end",500,function(r){var a=r.previousSelection||[],o=i.get(r.context.shape.id),s=_e(a,function(u){return o.id===u.id});s||t.select(o)}),e.on("element.click",function(r){if(!!zn(r)){var a=r.element;a===n.getRootElement()&&(a=null);var o=t.isSelected(a),s=t.get().length>1,u=Oi(r)||hd(r);if(o&&s)return u?t.deselect(a):t.select(a);o?t.deselect(a):t.select(a,u)}})}gd.$inject=["eventBus","selection","canvas","elementRegistry"];function Bx(e){return!e.hidden}var sn={__init__:["selectionVisuals","selectionBehavior"],__depends__:[kr,md],selection:["type",Ui],selectionVisuals:["type",vd],selectionBehavior:["type",gd]};function Vu(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(Math.random()*1e9)+"-"}Vu.prototype.next=function(){return this._prefix+ ++this._counter};var Ox=new Vu("ov"),Ix=500;function qe(e,t,n,i){this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=Ox,this._overlayDefaults=I({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=Nx(n.getContainer()),this._init()}qe.$inject=["config.overlays","eventBus","canvas","elementRegistry"];qe.prototype.get=function(e){if(Dt(e)&&(e={id:e}),Dt(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?se(t.overlays,Gt({type:e.type})):t.overlays.slice():[]}else return e.type?se(this._overlays,Gt({type:e.type})):e.id?this._overlays[e.id]:null};qe.prototype.add=function(e,t,n){if(Qe(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=I({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i};qe.prototype.remove=function(e){var t=this.get(e)||[];he(t)||(t=[t]);var n=this;A(t,function(i){var r=n._getOverlayContainer(i.element,!0);if(i&&(on(i.html),on(i.htmlContainer),delete i.htmlContainer,delete i.element,delete n._overlays[i.id]),r){var a=r.overlays.indexOf(i);a!==-1&&r.overlays.splice(a,1)}})};qe.prototype.show=function(){Lr(this._overlayRoot)};qe.prototype.hide=function(){Lr(this._overlayRoot,!1)};qe.prototype.clear=function(){this._overlays={},this._overlayContainers=[],fo(this._overlayRoot)};qe.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,r=t.y;if(t.waypoints){var a=et(t);i=a.x,r=a.y}yd(n,i,r),St(e.html,"data-container-id",t.id)};qe.prototype._updateOverlay=function(e){var t=e.position,n=e.htmlContainer,i=e.element,r=t.left,a=t.top;if(t.right!==void 0){var o;i.waypoints?o=et(i).width:o=i.width,r=t.right*-1+o}if(t.bottom!==void 0){var s;i.waypoints?s=et(i).height:s=i.height,a=t.bottom*-1+s}yd(n,r||0,a||0)};qe.prototype._createOverlayContainer=function(e){var t=Ae('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n};qe.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";Ed(this._overlayRoot,n)};qe.prototype._getOverlayContainer=function(e,t){var n=_e(this._overlayContainers,function(i){return i.element===e});return!n&&!t?this._createOverlayContainer(e):n};qe.prototype._addOverlay=function(e){var t=e.id,n=e.element,i=e.html,r,a;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),Dt(i)&&(i=Ae(i)),a=this._getOverlayContainer(n),r=Ae('<div class="djs-overlay" data-overlay-id="'+t+'" style="position: absolute">'),r.appendChild(i),e.type&&ze(r).add("djs-overlay-"+e.type);var o=this._canvas.findPlane(n),s=this._canvas.getActivePlane();e.plane=o,o!==s&&Lr(r,!1),e.htmlContainer=r,a.overlays.push(e),a.html.appendChild(r),this._overlays[t]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())};qe.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=e.plane,r=n&&n.minZoom,a=n&&n.maxZoom,o=e.htmlContainer,s=this._canvas.getActivePlane(),u=!0;(i!==s||n&&(tn(r)&&r>t.scale||tn(a)&&a<t.scale))&&(u=!1),Lr(o,u),this._updateOverlayScale(e,t)};qe.prototype._updateOverlayScale=function(e,t){var n=e.scale,i,r,a=e.htmlContainer,o,s="";n!==!0&&(n===!1?(i=1,r=1):(i=n.min,r=n.max),tn(i)&&t.scale<i&&(o=(1/t.scale||1)*i),tn(r)&&t.scale>r&&(o=(1/t.scale||1)*r)),tn(o)&&(s="scale("+o+","+o+")"),Ed(a,s)};qe.prototype._updateOverlaysVisibilty=function(e){var t=this;A(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})};qe.prototype._init=function(){var e=this._eventBus,t=this;function n(i){t._updateRoot(i),t._updateOverlaysVisibilty(i),t.show()}e.on("canvas.viewbox.changing",function(i){t.hide()}),e.on("canvas.viewbox.changed",function(i){n(i.viewbox)}),e.on(["shape.remove","connection.remove"],function(i){var r=i.element,a=t.get({element:r});A(a,function(u){t.remove(u.id)});var o=t._getOverlayContainer(r);if(o){on(o.html);var s=t._overlayContainers.indexOf(o);s!==-1&&t._overlayContainers.splice(s,1)}}),e.on("element.changed",Ix,function(i){var r=i.element,a=t._getOverlayContainer(r,!0);a&&(A(a.overlays,function(o){t._updateOverlay(o)}),t._updateOverlayContainer(a))}),e.on("element.marker.update",function(i){var r=t._getOverlayContainer(i.element,!0);r&&ze(r.html)[i.add?"add":"remove"](i.marker)}),e.on("plane.set",function(i){A(t._overlays,function(r){Lr(r.htmlContainer,r.plane===i.plane)})}),e.on("diagram.clear",this.clear,this)};function Nx(e){var t=Ae('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />');return e.insertBefore(t,e.firstChild),t}function yd(e,t,n){I(e.style,{left:t+"px",top:n+"px"})}function Lr(e,t){e.style.display=t===!1?"none":""}function Ed(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}var Wu={__init__:["overlays"],overlays:["type",qe]};function Gn(e){De.call(this,e)}Z(Gn,De);Gn.prototype._modules=[Ax,So,sn,Wu];Gn.prototype._moddleExtensions={};function Fx(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function bt(e){return e.altKey?!1:e.ctrlKey||e.metaKey}function jt(e,t){return e=he(e)?e:[e],e.indexOf(t.key)!==-1||e.indexOf(t.keyCode)!==-1}function Qs(e){return e.shiftKey}var Ro="keyboard.keydown",kx="keyboard.keyup",ip="input-handle-modified-keys",Lx=1e3;function Ke(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}Ke.$inject=["config.keyboard","eventBus"];Ke.prototype._keydownHandler=function(e){this._keyHandler(e,Ro)};Ke.prototype._keyupHandler=function(e){this._keyHandler(e,kx)};Ke.prototype._keyHandler=function(e,t){var n;if(!this._isEventIgnored(e)){var i={keyEvent:e};n=this._eventBus.fire(t||Ro,i),n&&e.preventDefault()}};Ke.prototype._isEventIgnored=function(e){return $x(e.target)&&this._isModifiedKeyIgnored(e)};Ke.prototype._isModifiedKeyIgnored=function(e){if(!bt(e))return!0;var t=this._getAllowedModifiers(e.target);return!t.includes(e.key)};Ke.prototype._getAllowedModifiers=function(e){var t=li(e,"["+ip+"]",!0);return!t||this._node&&!this._node.contains(t)?[]:t.getAttribute(ip).split(",")};Ke.prototype.bind=function(e){this.unbind(),this._node=e,te.bind(e,"keydown",this._keydownHandler,!0),te.bind(e,"keyup",this._keyupHandler,!0),this._fire("bind")};Ke.prototype.getBinding=function(){return this._node};Ke.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),te.unbind(e,"keydown",this._keydownHandler,!0),te.unbind(e,"keyup",this._keyupHandler,!0)),this._node=null};Ke.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})};Ke.prototype.addListener=function(e,t,n){ot(e)&&(n=t,t=e,e=Lx),this._eventBus.on(n||Ro,e,t)};Ke.prototype.removeListener=function(e,t){this._eventBus.off(t||Ro,e)};Ke.prototype.hasModifier=Fx;Ke.prototype.isCmd=bt;Ke.prototype.isShift=Qs;Ke.prototype.isKey=jt;function $x(e){return e&&(Ka(e,"input, textarea")||e.contentEditable==="true")}var jx=500,Hx=67,zx=86,Gx=89,Vx=90,Wx=["c","C",Hx],Ux=["v","V",zx],Yx=["y","Y",Gx],rp=["z","Z",Vx];function Yi(e,t){var n=this;e.on("editorActions.init",jx,function(i){var r=i.editorActions;n.registerBindings(t,r)})}Yi.$inject=["eventBus","keyboard"];Yi.prototype.registerBindings=function(e,t){function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("undo",function(i){var r=i.keyEvent;if(bt(r)&&!Qs(r)&&jt(rp,r))return t.trigger("undo"),!0}),n("redo",function(i){var r=i.keyEvent;if(bt(r)&&(jt(Yx,r)||jt(rp,r)&&Qs(r)))return t.trigger("redo"),!0}),n("copy",function(i){var r=i.keyEvent;if(bt(r)&&jt(Wx,r))return t.trigger("copy"),!0}),n("paste",function(i){var r=i.keyEvent;if(bt(r)&&jt(Ux,r))return t.trigger("paste"),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(jt(["+","Add","="],r)&&bt(r))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(jt(["-","Subtract"],r)&&bt(r))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(i){var r=i.keyEvent;if(jt("0",r)&&bt(r))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(i){var r=i.keyEvent;if(jt(["Backspace","Delete","Del"],r))return t.trigger("removeSelection"),!0})};var Uu={__init__:["keyboard","keyboardBindings"],keyboard:["type",Ke],keyboardBindings:["type",Yi]},qx={moveSpeed:50,moveSpeedAccelerated:200};function bd(e,t,n){var i=this;this._config=I({},qx,e||{}),t.addListener(r);function r(a){var o=a.keyEvent,s=i._config;if(!!t.isCmd(o)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],o)){var u=t.isShift(o)?s.moveSpeedAccelerated:s.moveSpeed,c;switch(o.key){case"ArrowLeft":case"Left":c="left";break;case"ArrowUp":case"Up":c="up";break;case"ArrowRight":case"Right":c="right";break;case"ArrowDown":case"Down":c="down";break}return i.moveCanvas({speed:u,direction:c}),!0}}this.moveCanvas=function(a){var o=0,s=0,u=a.speed,c=u/Math.min(Math.sqrt(n.viewbox().scale),1);switch(a.direction){case"left":o=c;break;case"up":s=c;break;case"right":o=-c;break;case"down":s=-c;break}n.scroll({dx:o,dy:s})}}bd.$inject=["config.keyboardMove","keyboard","canvas"];var xd={__depends__:[Uu],__init__:["keyboardMove"],keyboardMove:["type",bd]},Kx=/^djs-cursor-.*$/;function Po(e){var t=ze(document.body);t.removeMatching(Kx),e&&t.add("djs-cursor-"+e)}function _d(){Po(null)}var Xx=5e3;function wd(e,t){t=t||"element.click";function n(){return!1}return e.once(t,Xx,n),function(){e.off(t,n)}}function gr(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function nn(e,t){return{x:e.x-t.x,y:e.y-t.y}}var Zx=15;function Sd(e,t){var n;e.on("element.mousedown",500,function(o){return a(o.originalEvent)});function i(o){var s=n.start,u=n.button,c=Ln(o),l=nn(c,s);if(!n.dragging&&Jx(l)>Zx&&(n.dragging=!0,u===0&&wd(e),Po("grab")),n.dragging){var p=n.last||n.start;l=nn(c,p),t.scroll({dx:l.x,dy:l.y}),n.last=c}o.preventDefault()}function r(o){te.unbind(document,"mousemove",i),te.unbind(document,"mouseup",r),n=null,_d()}function a(o){if(!li(o.target,".djs-draggable")){var s=o.button;if(!(s>=2||o.ctrlKey||o.shiftKey||o.altKey))return n={button:s,start:Ln(o)},te.bind(document,"mousemove",i),te.bind(document,"mouseup",r),!0}}this.isActive=function(){return!!n}}Sd.$inject=["eventBus","canvas"];function Jx(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}var Cd={__init__:["moveCanvas"],moveCanvas:["type",Sd]};function eu(e){return Math.log(e)/Math.log(10)}function Td(e,t){var n=eu(e.min),i=eu(e.max),r=Math.abs(n)+Math.abs(i);return r/t}function Qx(e,t){return Math.max(e.min,Math.min(e.max,t))}var e0=Math.sign||function(e){return e>=0?1:-1},Yu={min:.2,max:4},Ad=10,t0=.1,n0=.75;function un(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=ft(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||n0;var i=this;t.on("canvas.init",function(r){i._init(e.enabled!==!1)})}un.$inject=["config.zoomScroll","eventBus","canvas"];un.prototype.scroll=function(t){this._canvas.scroll(t)};un.prototype.reset=function(){this._canvas.zoom("fit-viewport")};un.prototype.zoom=function(t,n){var i=Td(Yu,Ad*2);this._totalDelta+=t,Math.abs(this._totalDelta)>t0&&(this._zoom(t,n,i),this._totalDelta=0)};un.prototype._handleWheel=function(t){if(!li(t.target,".djs-scrollable",!0)){var n=this._container;t.preventDefault();var i=t.ctrlKey,r=t.shiftKey,a=-1*this._scale,o;if(i?a*=t.deltaMode===0?.02:.32:a*=t.deltaMode===0?1:16,i){var s=n.getBoundingClientRect(),u={x:t.clientX-s.left,y:t.clientY-s.top};o=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*e0(t.deltaY)*a,this.zoom(o,u)}else r?o={dx:a*t.deltaY,dy:0}:o={dx:a*t.deltaX,dy:a*t.deltaY},this.scroll(o)}};un.prototype.stepZoom=function(t,n){var i=Td(Yu,Ad);this._zoom(t,n,i)};un.prototype._zoom=function(e,t,n){var i=this._canvas,r=e>0?1:-1,a=eu(i.zoom()),o=Math.round(a/n)*n;o+=n*r;var s=Math.pow(10,o);i.zoom(Qx(Yu,s),t)};un.prototype.toggle=function(t){var n=this._container,i=this._handleWheel,r=this._enabled;return typeof t=="undefined"&&(t=!r),r!==t&&te[t?"bind":"unbind"](n,"wheel",i,!1),this._enabled=t,t};un.prototype._init=function(e){this.toggle(e)};var Rd={__init__:["zoomScroll"],zoomScroll:["type",un]};function Cr(e){Gn.call(this,e)}Z(Cr,Gn);Cr.prototype._navigationModules=[xd,Cd,Rd];Cr.prototype._modules=[].concat(Gn.prototype._modules,Cr.prototype._navigationModules);var Pd={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(e){(function(t,n,i,r){var a=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),s="function",u=Math.round,c=Math.abs,l=Date.now;function p(g,E,C){return setTimeout(w(g,C),E)}function h(g,E,C){return Array.isArray(g)?(f(g,C[E],C),!0):!1}function f(g,E,C){var F;if(!!g)if(g.forEach)g.forEach(E,C);else if(g.length!==r)for(F=0;F<g.length;)E.call(C,g[F],F,g),F++;else for(F in g)g.hasOwnProperty(F)&&E.call(C,g[F],F,g)}function d(g,E,C){var F="DEPRECATED METHOD: "+E+`
`+C+` AT 
`;return function(){var j=new Error("get-stack-trace"),K=j&&j.stack?j.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ve=t.console&&(t.console.warn||t.console.log);return ve&&ve.call(t.console,F,K),g.apply(this,arguments)}}var y;typeof Object.assign!="function"?y=function(E){if(E===r||E===null)throw new TypeError("Cannot convert undefined or null to object");for(var C=Object(E),F=1;F<arguments.length;F++){var j=arguments[F];if(j!==r&&j!==null)for(var K in j)j.hasOwnProperty(K)&&(C[K]=j[K])}return C}:y=Object.assign;var x=d(function(E,C,F){for(var j=Object.keys(C),K=0;K<j.length;)(!F||F&&E[j[K]]===r)&&(E[j[K]]=C[j[K]]),K++;return E},"extend","Use `assign`."),M=d(function(E,C){return x(E,C,!0)},"merge","Use `assign`.");function P(g,E,C){var F=E.prototype,j;j=g.prototype=Object.create(F),j.constructor=g,j._super=F,C&&y(j,C)}function w(g,E){return function(){return g.apply(E,arguments)}}function b(g,E){return typeof g==s?g.apply(E&&E[0]||r,E):g}function _(g,E){return g===r?E:g}function D(g,E,C){f(z(E),function(F){g.addEventListener(F,C,!1)})}function B(g,E,C){f(z(E),function(F){g.removeEventListener(F,C,!1)})}function R(g,E){for(;g;){if(g==E)return!0;g=g.parentNode}return!1}function L(g,E){return g.indexOf(E)>-1}function z(g){return g.trim().split(/\s+/g)}function q(g,E,C){if(g.indexOf&&!C)return g.indexOf(E);for(var F=0;F<g.length;){if(C&&g[F][C]==E||!C&&g[F]===E)return F;F++}return-1}function W(g){return Array.prototype.slice.call(g,0)}function X(g,E,C){for(var F=[],j=[],K=0;K<g.length;){var ve=E?g[K][E]:g[K];q(j,ve)<0&&F.push(g[K]),j[K]=ve,K++}return C&&(E?F=F.sort(function(Xe,lt){return Xe[E]>lt[E]}):F=F.sort()),F}function ge(g,E){for(var C,F,j=E[0].toUpperCase()+E.slice(1),K=0;K<a.length;){if(C=a[K],F=C?C+j:E,F in g)return F;K++}return r}var Lt=1;function be(){return Lt++}function le(g){var E=g.ownerDocument||g;return E.defaultView||E.parentWindow||t}var S=/mobile|tablet|ip(ad|hone|od)|android/i,m="ontouchstart"in t,T=ge(t,"PointerEvent")!==r,O=m&&S.test(navigator.userAgent),$="touch",N="pen",k="mouse",G="kinect",re=25,oe=1,Te=2,pe=4,de=8,Ve=1,We=2,we=4,Re=8,ut=16,ct=We|we,rt=Re|ut,Be=ct|rt,yt=["x","y"],Ee=["clientX","clientY"];function Ge(g,E){var C=this;this.manager=g,this.callback=E,this.element=g.element,this.target=g.options.inputTarget,this.domHandler=function(F){b(g.options.enable,[g])&&C.handler(F)},this.init()}Ge.prototype={handler:function(){},init:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(le(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&B(this.element,this.evEl,this.domHandler),this.evTarget&&B(this.target,this.evTarget,this.domHandler),this.evWin&&B(le(this.element),this.evWin,this.domHandler)}};function ra(g){var E,C=g.options.inputClass;return C?E=C:T?E=ss:O?E=sa:m?E=us:E=oa,new E(g,Et)}function Et(g,E,C){var F=C.pointers.length,j=C.changedPointers.length,K=E&oe&&F-j===0,ve=E&(pe|de)&&F-j===0;C.isFirst=!!K,C.isFinal=!!ve,K&&(g.session={}),C.eventType=E,Q(g,C),g.emit("hammer.input",C),g.recognize(C),g.session.prevInput=C}function Q(g,E){var C=g.session,F=E.pointers,j=F.length;C.firstInput||(C.firstInput=il(E)),j>1&&!C.firstMultiple?C.firstMultiple=il(E):j===1&&(C.firstMultiple=!1);var K=C.firstInput,ve=C.firstMultiple,Ue=ve?ve.center:K.center,Xe=E.center=rl(F);E.timeStamp=l(),E.deltaTime=E.timeStamp-K.timeStamp,E.angle=os(Ue,Xe),E.distance=aa(Ue,Xe),xe(C,E),E.offsetDirection=ol(E.deltaX,E.deltaY);var lt=al(E.deltaTime,E.deltaX,E.deltaY);E.overallVelocityX=lt.x,E.overallVelocityY=lt.y,E.overallVelocity=c(lt.x)>c(lt.y)?lt.x:lt.y,E.scale=ve?Iv(ve.pointers,F):1,E.rotation=ve?Ov(ve.pointers,F):0,E.maxPointers=C.prevInput?E.pointers.length>C.prevInput.maxPointers?E.pointers.length:C.prevInput.maxPointers:E.pointers.length,Bv(C,E);var Xt=g.element;R(E.srcEvent.target,Xt)&&(Xt=E.srcEvent.target),E.target=Xt}function xe(g,E){var C=E.center,F=g.offsetDelta||{},j=g.prevDelta||{},K=g.prevInput||{};(E.eventType===oe||K.eventType===pe)&&(j=g.prevDelta={x:K.deltaX||0,y:K.deltaY||0},F=g.offsetDelta={x:C.x,y:C.y}),E.deltaX=j.x+(C.x-F.x),E.deltaY=j.y+(C.y-F.y)}function Bv(g,E){var C=g.lastInterval||E,F=E.timeStamp-C.timeStamp,j,K,ve,Ue;if(E.eventType!=de&&(F>re||C.velocity===r)){var Xe=E.deltaX-C.deltaX,lt=E.deltaY-C.deltaY,Xt=al(F,Xe,lt);K=Xt.x,ve=Xt.y,j=c(Xt.x)>c(Xt.y)?Xt.x:Xt.y,Ue=ol(Xe,lt),g.lastInterval=E}else j=C.velocity,K=C.velocityX,ve=C.velocityY,Ue=C.direction;E.velocity=j,E.velocityX=K,E.velocityY=ve,E.direction=Ue}function il(g){for(var E=[],C=0;C<g.pointers.length;)E[C]={clientX:u(g.pointers[C].clientX),clientY:u(g.pointers[C].clientY)},C++;return{timeStamp:l(),pointers:E,center:rl(E),deltaX:g.deltaX,deltaY:g.deltaY}}function rl(g){var E=g.length;if(E===1)return{x:u(g[0].clientX),y:u(g[0].clientY)};for(var C=0,F=0,j=0;j<E;)C+=g[j].clientX,F+=g[j].clientY,j++;return{x:u(C/E),y:u(F/E)}}function al(g,E,C){return{x:E/g||0,y:C/g||0}}function ol(g,E){return g===E?Ve:c(g)>=c(E)?g<0?We:we:E<0?Re:ut}function aa(g,E,C){C||(C=yt);var F=E[C[0]]-g[C[0]],j=E[C[1]]-g[C[1]];return Math.sqrt(F*F+j*j)}function os(g,E,C){C||(C=yt);var F=E[C[0]]-g[C[0]],j=E[C[1]]-g[C[1]];return Math.atan2(j,F)*180/Math.PI}function Ov(g,E){return os(E[1],E[0],Ee)+os(g[1],g[0],Ee)}function Iv(g,E){return aa(E[0],E[1],Ee)/aa(g[0],g[1],Ee)}var Nv={mousedown:oe,mousemove:Te,mouseup:pe},Fv="mousedown",kv="mousemove mouseup";function oa(){this.evEl=Fv,this.evWin=kv,this.pressed=!1,Ge.apply(this,arguments)}P(oa,Ge,{handler:function(E){var C=Nv[E.type];C&oe&&E.button===0&&(this.pressed=!0),C&Te&&E.which!==1&&(C=pe),this.pressed&&(C&pe&&(this.pressed=!1),this.callback(this.manager,C,{pointers:[E],changedPointers:[E],pointerType:k,srcEvent:E}))}});var Lv={pointerdown:oe,pointermove:Te,pointerup:pe,pointercancel:de,pointerout:de},$v={2:$,3:N,4:k,5:G},sl="pointerdown",ul="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(sl="MSPointerDown",ul="MSPointerMove MSPointerUp MSPointerCancel");function ss(){this.evEl=sl,this.evWin=ul,Ge.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}P(ss,Ge,{handler:function(E){var C=this.store,F=!1,j=E.type.toLowerCase().replace("ms",""),K=Lv[j],ve=$v[E.pointerType]||E.pointerType,Ue=ve==$,Xe=q(C,E.pointerId,"pointerId");K&oe&&(E.button===0||Ue)?Xe<0&&(C.push(E),Xe=C.length-1):K&(pe|de)&&(F=!0),!(Xe<0)&&(C[Xe]=E,this.callback(this.manager,K,{pointers:C,changedPointers:[E],pointerType:ve,srcEvent:E}),F&&C.splice(Xe,1))}});var jv={touchstart:oe,touchmove:Te,touchend:pe,touchcancel:de},Hv="touchstart",zv="touchstart touchmove touchend touchcancel";function cl(){this.evTarget=Hv,this.evWin=zv,this.started=!1,Ge.apply(this,arguments)}P(cl,Ge,{handler:function(E){var C=jv[E.type];if(C===oe&&(this.started=!0),!!this.started){var F=Gv.call(this,E,C);C&(pe|de)&&F[0].length-F[1].length===0&&(this.started=!1),this.callback(this.manager,C,{pointers:F[0],changedPointers:F[1],pointerType:$,srcEvent:E})}}});function Gv(g,E){var C=W(g.touches),F=W(g.changedTouches);return E&(pe|de)&&(C=X(C.concat(F),"identifier",!0)),[C,F]}var Vv={touchstart:oe,touchmove:Te,touchend:pe,touchcancel:de},Wv="touchstart touchmove touchend touchcancel";function sa(){this.evTarget=Wv,this.targetIds={},Ge.apply(this,arguments)}P(sa,Ge,{handler:function(E){var C=Vv[E.type],F=Uv.call(this,E,C);!F||this.callback(this.manager,C,{pointers:F[0],changedPointers:F[1],pointerType:$,srcEvent:E})}});function Uv(g,E){var C=W(g.touches),F=this.targetIds;if(E&(oe|Te)&&C.length===1)return F[C[0].identifier]=!0,[C,C];var j,K,ve=W(g.changedTouches),Ue=[],Xe=this.target;if(K=C.filter(function(lt){return R(lt.target,Xe)}),E===oe)for(j=0;j<K.length;)F[K[j].identifier]=!0,j++;for(j=0;j<ve.length;)F[ve[j].identifier]&&Ue.push(ve[j]),E&(pe|de)&&delete F[ve[j].identifier],j++;if(!!Ue.length)return[X(K.concat(Ue),"identifier",!0),Ue]}var Yv=2500,ll=25;function us(){Ge.apply(this,arguments);var g=w(this.handler,this);this.touch=new sa(this.manager,g),this.mouse=new oa(this.manager,g),this.primaryTouch=null,this.lastTouches=[]}P(us,Ge,{handler:function(E,C,F){var j=F.pointerType==$,K=F.pointerType==k;if(!(K&&F.sourceCapabilities&&F.sourceCapabilities.firesTouchEvents)){if(j)qv.call(this,C,F);else if(K&&Kv.call(this,F))return;this.callback(E,C,F)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function qv(g,E){g&oe?(this.primaryTouch=E.changedPointers[0].identifier,pl.call(this,E)):g&(pe|de)&&pl.call(this,E)}function pl(g){var E=g.changedPointers[0];if(E.identifier===this.primaryTouch){var C={x:E.clientX,y:E.clientY};this.lastTouches.push(C);var F=this.lastTouches,j=function(){var K=F.indexOf(C);K>-1&&F.splice(K,1)};setTimeout(j,Yv)}}function Kv(g){for(var E=g.srcEvent.clientX,C=g.srcEvent.clientY,F=0;F<this.lastTouches.length;F++){var j=this.lastTouches[F],K=Math.abs(E-j.x),ve=Math.abs(C-j.y);if(K<=ll&&ve<=ll)return!0}return!1}var fl=ge(o.style,"touchAction"),hl=fl!==r,dl="compute",ml="auto",cs="manipulation",Qn="none",er="pan-x",tr="pan-y",ua=Zv();function ls(g,E){this.manager=g,this.set(E)}ls.prototype={set:function(g){g==dl&&(g=this.compute()),hl&&this.manager.element.style&&ua[g]&&(this.manager.element.style[fl]=g),this.actions=g.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var g=[];return f(this.manager.recognizers,function(E){b(E.options.enable,[E])&&(g=g.concat(E.getTouchAction()))}),Xv(g.join(" "))},preventDefaults:function(g){var E=g.srcEvent,C=g.offsetDirection;if(this.manager.session.prevented){E.preventDefault();return}var F=this.actions,j=L(F,Qn)&&!ua[Qn],K=L(F,tr)&&!ua[tr],ve=L(F,er)&&!ua[er];if(j){var Ue=g.pointers.length===1,Xe=g.distance<2,lt=g.deltaTime<250;if(Ue&&Xe&&lt)return}if(!(ve&&K)&&(j||K&&C&ct||ve&&C&rt))return this.preventSrc(E)},preventSrc:function(g){this.manager.session.prevented=!0,g.preventDefault()}};function Xv(g){if(L(g,Qn))return Qn;var E=L(g,er),C=L(g,tr);return E&&C?Qn:E||C?E?er:tr:L(g,cs)?cs:ml}function Zv(){if(!hl)return!1;var g={},E=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(C){g[C]=E?t.CSS.supports("touch-action",C):!0}),g}var ca=1,At=2,Ei=4,Rn=8,pn=Rn,nr=16,Kt=32;function fn(g){this.options=y({},this.defaults,g||{}),this.id=be(),this.manager=null,this.options.enable=_(this.options.enable,!0),this.state=ca,this.simultaneous={},this.requireFail=[]}fn.prototype={defaults:{},set:function(g){return y(this.options,g),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(g){if(h(g,"recognizeWith",this))return this;var E=this.simultaneous;return g=la(g,this),E[g.id]||(E[g.id]=g,g.recognizeWith(this)),this},dropRecognizeWith:function(g){return h(g,"dropRecognizeWith",this)?this:(g=la(g,this),delete this.simultaneous[g.id],this)},requireFailure:function(g){if(h(g,"requireFailure",this))return this;var E=this.requireFail;return g=la(g,this),q(E,g)===-1&&(E.push(g),g.requireFailure(this)),this},dropRequireFailure:function(g){if(h(g,"dropRequireFailure",this))return this;g=la(g,this);var E=q(this.requireFail,g);return E>-1&&this.requireFail.splice(E,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(g){return!!this.simultaneous[g.id]},emit:function(g){var E=this,C=this.state;function F(j){E.manager.emit(j,g)}C<Rn&&F(E.options.event+vl(C)),F(E.options.event),g.additionalEvent&&F(g.additionalEvent),C>=Rn&&F(E.options.event+vl(C))},tryEmit:function(g){if(this.canEmit())return this.emit(g);this.state=Kt},canEmit:function(){for(var g=0;g<this.requireFail.length;){if(!(this.requireFail[g].state&(Kt|ca)))return!1;g++}return!0},recognize:function(g){var E=y({},g);if(!b(this.options.enable,[this,E])){this.reset(),this.state=Kt;return}this.state&(pn|nr|Kt)&&(this.state=ca),this.state=this.process(E),this.state&(At|Ei|Rn|nr)&&this.tryEmit(E)},process:function(g){},getTouchAction:function(){},reset:function(){}};function vl(g){return g&nr?"cancel":g&Rn?"end":g&Ei?"move":g&At?"start":""}function gl(g){return g==ut?"down":g==Re?"up":g==We?"left":g==we?"right":""}function la(g,E){var C=E.manager;return C?C.get(g):g}function $t(){fn.apply(this,arguments)}P($t,fn,{defaults:{pointers:1},attrTest:function(g){var E=this.options.pointers;return E===0||g.pointers.length===E},process:function(g){var E=this.state,C=g.eventType,F=E&(At|Ei),j=this.attrTest(g);return F&&(C&de||!j)?E|nr:F||j?C&pe?E|Rn:E&At?E|Ei:At:Kt}});function pa(){$t.apply(this,arguments),this.pX=null,this.pY=null}P(pa,$t,{defaults:{event:"pan",threshold:10,pointers:1,direction:Be},getTouchAction:function(){var g=this.options.direction,E=[];return g&ct&&E.push(tr),g&rt&&E.push(er),E},directionTest:function(g){var E=this.options,C=!0,F=g.distance,j=g.direction,K=g.deltaX,ve=g.deltaY;return j&E.direction||(E.direction&ct?(j=K===0?Ve:K<0?We:we,C=K!=this.pX,F=Math.abs(g.deltaX)):(j=ve===0?Ve:ve<0?Re:ut,C=ve!=this.pY,F=Math.abs(g.deltaY))),g.direction=j,C&&F>E.threshold&&j&E.direction},attrTest:function(g){return $t.prototype.attrTest.call(this,g)&&(this.state&At||!(this.state&At)&&this.directionTest(g))},emit:function(g){this.pX=g.deltaX,this.pY=g.deltaY;var E=gl(g.direction);E&&(g.additionalEvent=this.options.event+E),this._super.emit.call(this,g)}});function ps(){$t.apply(this,arguments)}P(ps,$t,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Qn]},attrTest:function(g){return this._super.attrTest.call(this,g)&&(Math.abs(g.scale-1)>this.options.threshold||this.state&At)},emit:function(g){if(g.scale!==1){var E=g.scale<1?"in":"out";g.additionalEvent=this.options.event+E}this._super.emit.call(this,g)}});function fs(){fn.apply(this,arguments),this._timer=null,this._input=null}P(fs,fn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ml]},process:function(g){var E=this.options,C=g.pointers.length===E.pointers,F=g.distance<E.threshold,j=g.deltaTime>E.time;if(this._input=g,!F||!C||g.eventType&(pe|de)&&!j)this.reset();else if(g.eventType&oe)this.reset(),this._timer=p(function(){this.state=pn,this.tryEmit()},E.time,this);else if(g.eventType&pe)return pn;return Kt},reset:function(){clearTimeout(this._timer)},emit:function(g){this.state===pn&&(g&&g.eventType&pe?this.manager.emit(this.options.event+"up",g):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input)))}});function hs(){$t.apply(this,arguments)}P(hs,$t,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Qn]},attrTest:function(g){return this._super.attrTest.call(this,g)&&(Math.abs(g.rotation)>this.options.threshold||this.state&At)}});function ds(){$t.apply(this,arguments)}P(ds,$t,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ct|rt,pointers:1},getTouchAction:function(){return pa.prototype.getTouchAction.call(this)},attrTest:function(g){var E=this.options.direction,C;return E&(ct|rt)?C=g.overallVelocity:E&ct?C=g.overallVelocityX:E&rt&&(C=g.overallVelocityY),this._super.attrTest.call(this,g)&&E&g.offsetDirection&&g.distance>this.options.threshold&&g.maxPointers==this.options.pointers&&c(C)>this.options.velocity&&g.eventType&pe},emit:function(g){var E=gl(g.offsetDirection);E&&this.manager.emit(this.options.event+E,g),this.manager.emit(this.options.event,g)}});function fa(){fn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}P(fa,fn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[cs]},process:function(g){var E=this.options,C=g.pointers.length===E.pointers,F=g.distance<E.threshold,j=g.deltaTime<E.time;if(this.reset(),g.eventType&oe&&this.count===0)return this.failTimeout();if(F&&j&&C){if(g.eventType!=pe)return this.failTimeout();var K=this.pTime?g.timeStamp-this.pTime<E.interval:!0,ve=!this.pCenter||aa(this.pCenter,g.center)<E.posThreshold;this.pTime=g.timeStamp,this.pCenter=g.center,!ve||!K?this.count=1:this.count+=1,this._input=g;var Ue=this.count%E.taps;if(Ue===0)return this.hasRequireFailures()?(this._timer=p(function(){this.state=pn,this.tryEmit()},E.interval,this),At):pn}return Kt},failTimeout:function(){return this._timer=p(function(){this.state=Kt},this.options.interval,this),Kt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==pn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function hn(g,E){return E=E||{},E.recognizers=_(E.recognizers,hn.defaults.preset),new ms(g,E)}hn.VERSION="2.0.7",hn.defaults={domEvents:!1,touchAction:dl,enable:!0,inputTarget:null,inputClass:null,preset:[[hs,{enable:!1}],[ps,{enable:!1},["rotate"]],[ds,{direction:ct}],[pa,{direction:ct},["swipe"]],[fa],[fa,{event:"doubletap",taps:2},["tap"]],[fs]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Jv=1,yl=2;function ms(g,E){this.options=y({},hn.defaults,E||{}),this.options.inputTarget=this.options.inputTarget||g,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=g,this.input=ra(this),this.touchAction=new ls(this,this.options.touchAction),El(this,!0),f(this.options.recognizers,function(C){var F=this.add(new C[0](C[1]));C[2]&&F.recognizeWith(C[2]),C[3]&&F.requireFailure(C[3])},this)}ms.prototype={set:function(g){return y(this.options,g),g.touchAction&&this.touchAction.update(),g.inputTarget&&(this.input.destroy(),this.input.target=g.inputTarget,this.input.init()),this},stop:function(g){this.session.stopped=g?yl:Jv},recognize:function(g){var E=this.session;if(!E.stopped){this.touchAction.preventDefaults(g);var C,F=this.recognizers,j=E.curRecognizer;(!j||j&&j.state&pn)&&(j=E.curRecognizer=null);for(var K=0;K<F.length;)C=F[K],E.stopped!==yl&&(!j||C==j||C.canRecognizeWith(j))?C.recognize(g):C.reset(),!j&&C.state&(At|Ei|Rn)&&(j=E.curRecognizer=C),K++}},get:function(g){if(g instanceof fn)return g;for(var E=this.recognizers,C=0;C<E.length;C++)if(E[C].options.event==g)return E[C];return null},add:function(g){if(h(g,"add",this))return this;var E=this.get(g.options.event);return E&&this.remove(E),this.recognizers.push(g),g.manager=this,this.touchAction.update(),g},remove:function(g){if(h(g,"remove",this))return this;if(g=this.get(g),g){var E=this.recognizers,C=q(E,g);C!==-1&&(E.splice(C,1),this.touchAction.update())}return this},on:function(g,E){if(g!==r&&E!==r){var C=this.handlers;return f(z(g),function(F){C[F]=C[F]||[],C[F].push(E)}),this}},off:function(g,E){if(g!==r){var C=this.handlers;return f(z(g),function(F){E?C[F]&&C[F].splice(q(C[F],E),1):delete C[F]}),this}},emit:function(g,E){this.options.domEvents&&Qv(g,E);var C=this.handlers[g]&&this.handlers[g].slice();if(!(!C||!C.length)){E.type=g,E.preventDefault=function(){E.srcEvent.preventDefault()};for(var F=0;F<C.length;)C[F](E),F++}},destroy:function(){this.element&&El(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function El(g,E){var C=g.element;if(!!C.style){var F;f(g.options.cssProps,function(j,K){F=ge(C.style,K),E?(g.oldCssProps[F]=C.style[F],C.style[F]=j):C.style[F]=g.oldCssProps[F]||""}),E||(g.oldCssProps={})}}function Qv(g,E){var C=n.createEvent("Event");C.initEvent(g,!0,!0),C.gesture=E,E.target.dispatchEvent(C)}y(hn,{INPUT_START:oe,INPUT_MOVE:Te,INPUT_END:pe,INPUT_CANCEL:de,STATE_POSSIBLE:ca,STATE_BEGAN:At,STATE_CHANGED:Ei,STATE_ENDED:Rn,STATE_RECOGNIZED:pn,STATE_CANCELLED:nr,STATE_FAILED:Kt,DIRECTION_NONE:Ve,DIRECTION_LEFT:We,DIRECTION_RIGHT:we,DIRECTION_UP:Re,DIRECTION_DOWN:ut,DIRECTION_HORIZONTAL:ct,DIRECTION_VERTICAL:rt,DIRECTION_ALL:Be,Manager:ms,Input:Ge,TouchAction:ls,TouchInput:sa,MouseInput:oa,PointerEventInput:ss,TouchMouseInput:us,SingleTouchInput:cl,Recognizer:fn,AttrRecognizer:$t,Tap:fa,Pan:pa,Swipe:ds,Pinch:ps,Rotate:hs,Press:fs,on:D,off:B,each:f,merge:M,extend:x,assign:y,inherit:P,bindFn:w,prefixed:ge});var eg=typeof t!="undefined"?t:typeof self!="undefined"?self:{};eg.Hammer=hn,typeof r=="function"&&r.amd?r(function(){return hn}):e.exports?e.exports=hn:t[i]=hn})(window,document,"Hammer")})(Pd);var ni=Pd.exports,i0=.2,r0=4,ap=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function ya(e,t){return t.get(e,!1)}function tu(e){e.preventDefault(),typeof e.stopPropagation=="function"?e.stopPropagation():e.srcEvent&&typeof e.srcEvent.stopPropagation=="function"&&e.srcEvent.stopPropagation(),typeof e.stopImmediatePropagation=="function"&&e.stopImmediatePropagation()}function xs(e){function t(c){A(ap,function(l){te.bind(e,l,tu,!0)})}function n(c){setTimeout(function(){A(ap,function(l){te.unbind(e,l,tu,!0)})},500)}te.bind(e,"touchstart",t,!0),te.bind(e,"touchend",n,!0),te.bind(e,"touchcancel",n,!0);var i=new ni.Manager(e,{inputClass:ni.TouchInput,recognizers:[],domEvents:!0}),r=new ni.Tap,a=new ni.Pan({threshold:10}),o=new ni.Press,s=new ni.Pinch,u=new ni.Tap({event:"doubletap",taps:2});return s.requireFailure(a),s.requireFailure(o),i.add([a,o,s,u,r]),i.reset=function(c){var l=this.recognizers,p=this.session;p.stopped||(i.stop(c),setTimeout(function(){var h,f;for(h=0;f=l[h];h++)f.reset(),f.state=8;p.curRecognizer=null},0))},i.on("hammer.input",function(c){c.srcEvent.defaultPrevented&&i.reset(!0)}),i}function Dd(e,t,n,i,r){var a=ya("dragging",e),o=ya("move",e),s=ya("contextPad",e),u=ya("palette",e),c;function l(f,d){return function(y){var x=p(y.target),M=x&&i.get(x);return d&&(y.srcEvent.button=d),r.fire(f,y,M)}}function p(f){var d=li(f,"svg, .djs-element",!0);return d}function h(f){c=xs(f);function d(M){var P=0,w=0;function b(D){var B=D.deltaX-P,R=D.deltaY-w;t.scroll({dx:B,dy:R}),P=D.deltaX,w=D.deltaY}function _(D){c.off("panmove",b),c.off("panend",_),c.off("pancancel",_)}c.on("panmove",b),c.on("panend",_),c.on("pancancel",_)}function y(M){var P=p(M.target),w=P&&i.get(P);if(o&&t.getRootElement()!==w)return o.start(M,w,!0);d()}function x(M){var P=t.zoom(),w=M.center;function b(D){var B=1-(1-D.scale)/1.5,R=Math.max(i0,Math.min(r0,B*P));t.zoom(R,w),tu(D)}function _(D){c.off("pinchmove",b),c.off("pinchend",_),c.off("pinchcancel",_),c.reset(!0)}c.on("pinchmove",b),c.on("pinchend",_),c.on("pinchcancel",_)}c.on("tap",l("element.click")),c.on("doubletap",l("element.dblclick",1)),c.on("panstart",y),c.on("press",y),c.on("pinchstart",x)}a&&n.on("drag.move",function(f){var d=f.originalEvent;if(!(!d||d instanceof MouseEvent)){var y=Ln(d),x=document.elementFromPoint(y.x,y.y),M=p(x),P=M&&i.get(M);P!==f.hover&&(f.hover&&a.out(f),P&&(a.hover({element:P,gfx:M}),f.hover=P,f.hoverGfx=M))}}),s&&n.on("contextPad.create",function(f){var d=f.pad.html,y=xs(d);y.on("panstart",function(x){s.trigger("dragstart",x,!0)}),y.on("press",function(x){s.trigger("dragstart",x,!0)}),y.on("tap",function(x){s.trigger("click",x)})}),u&&n.on("palette.create",function(f){var d=f.container,y=xs(d);y.on("panstart",function(x){u.trigger("dragstart",x,!0)}),y.on("press",function(x){u.trigger("dragstart",x,!0)}),y.on("tap",function(x){u.trigger("click",x)})}),n.on("canvas.init",function(f){h(f.svg)})}Dd.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"];function qu(e,t){var n=this;t.on("canvas.init",function(i){n.addBBoxMarker(i.svg)})}qu.$inject=["canvas","eventBus"];qu.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=J("rect");H(n,{x:-1e4,y:1e4,width:10,height:10}),H(n,t),ne(e,n);var i=J("rect");H(i,{x:1e4,y:1e4,width:10,height:10}),H(i,t),ne(e,i)};var a0={__depends__:[kr],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",Dd],touchFix:["type",qu]},o0={__depends__:[a0]};function _s(e){return e&&e[e.length-1]}function op(e){return e.y}function sp(e){return e.x}var s0={left:sp,center:sp,right:function(e){return e.x+e.width},top:op,middle:op,bottom:function(e){return e.y+e.height}};function qi(e){this._modeling=e}qi.$inject=["modeling"];qi.prototype._getOrientationDetails=function(e){var t=["top","bottom","middle"],n="x",i="width";return t.indexOf(e)!==-1&&(n="y",i="height"),{axis:n,dimension:i}};qi.prototype._isType=function(e,t){return t.indexOf(e)!==-1};qi.prototype._alignmentPosition=function(e,t){var n=this._getOrientationDetails(e),i=n.axis,r=n.dimension,a={},o={},s=!1,u,c,l;function p(h,f){return Math.round((h[i]+f[i]+f[r])/2)}if(this._isType(e,["left","top"]))a[e]=t[0][i];else if(this._isType(e,["right","bottom"]))l=_s(t),a[e]=l[i]+l[r];else if(this._isType(e,["center","middle"])){if(A(t,function(h){var f=h[i]+Math.round(h[r]/2);o[f]?o[f].elements.push(h):o[f]={elements:[h],center:f}}),u=Vt(o,function(h){return h.elements.length>1&&(s=!0),h.elements.length}),s)return a[e]=_s(u).center,a;c=t[0],t=Vt(t,function(h){return h[i]+h[r]}),l=_s(t),a[e]=p(c,l)}return a};qi.prototype.trigger=function(e,t){var n=this._modeling,i=se(e,function(s){return!(s.waypoints||s.host||s.labelTarget)});if(!(i.length<2)){var r=s0[t],a=Vt(i,r),o=this._alignmentPosition(t,a);n.alignElements(a,o)}};var u0={__init__:["alignElements"],alignElements:["type",qi]},c0=10,Md=50,l0=250;function Ku(e,t,n,i){for(var r;r=p0(e,n,t);)n=i(t,n,r);return n}function Xu(e){return function(t,n,i){var r={x:n.x,y:n.y};return["x","y"].forEach(function(a){var o=e[a];if(!!o){var s=a==="x"?"width":"height",u=o.margin,c=o.minDistance;u<0?r[a]=Math.min(i[a]+u-t[s]/2,n[a]-c+u):r[a]=Math.max(i[a]+i[s]+u+t[s]/2,n[a]+c+u)}}),r}}function p0(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},r=h0(e);return _e(r,function(a){if(a===n)return!1;var o=tt(a,i,c0);return o==="intersect"})}function f0(e,t){t||(t={});function n(d){return d.source===e?1:-1}var i=t.defaultDistance||Md,r=t.direction||"e",a=t.filter,o=t.getWeight||n,s=t.maxDistance||l0,u=t.reference||"start";a||(a=v0);function c(d,y){return r==="n"?u==="start"?ee(d).top-ee(y).bottom:u==="center"?ee(d).top-ue(y).y:ee(d).top-ee(y).top:r==="w"?u==="start"?ee(d).left-ee(y).right:u==="center"?ee(d).left-ue(y).x:ee(d).left-ee(y).left:r==="s"?u==="start"?ee(y).top-ee(d).bottom:u==="center"?ue(y).y-ee(d).bottom:ee(y).bottom-ee(d).bottom:u==="start"?ee(y).left-ee(d).right:u==="center"?ue(y).x-ee(d).right:ee(y).right-ee(d).right}var l=e.incoming.filter(a).map(function(d){var y=o(d),x=y<0?c(d.source,e):c(e,d.source);return{id:d.source.id,distance:x,weight:y}}),p=e.outgoing.filter(a).map(function(d){var y=o(d),x=y>0?c(e,d.target):c(d.target,e);return{id:d.target.id,distance:x,weight:y}}),h=l.concat(p).reduce(function(d,y){return d[y.id+"__weight_"+y.weight]=y,d},{}),f=wt(h,function(d,y){var x=y.distance,M=y.weight;return x<0||x>s||(d[String(x)]||(d[String(x)]=0),d[String(x)]+=1*M,(!d.distance||d[d.distance]<d[String(x)])&&(d.distance=x)),d},{});return f.distance||i}function h0(e){var t=ws(e);return e.host&&(t=t.concat(ws(e.host))),e.attachers&&(t=t.concat(e.attachers.reduce(function(n,i){return n.concat(ws(i))},[]))),t}function ws(e){return m0(e).concat(d0(e))}function d0(e){return e.incoming.map(function(t){return t.source})}function m0(e){return e.outgoing.map(function(t){return t.target})}function v0(){return!0}var g0=100;function Bd(e,t,n){e.on("autoPlace",g0,function(i){var r=i.shape,a=i.source;return y0(a,r)}),e.on("autoPlace.end",function(i){n.scrollToElement(i.shape)}),this.append=function(i,r,a){e.fire("autoPlace.start",{source:i,shape:r});var o=e.fire("autoPlace",{source:i,shape:r}),s=t.appendShape(i,r,o,i.parent,a);return e.fire("autoPlace.end",{source:i,shape:s}),s}}Bd.$inject=["eventBus","modeling","canvas"];function y0(e,t,n){n||(n={});var i=n.defaultDistance||Md,r=ue(e),a=ee(e);return{x:a.right+i+t.width/2,y:r.y}}function Od(e,t){e.on("autoPlace.end",500,function(n){t.select(n.shape)})}Od.$inject=["eventBus","selection"];var E0={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",Bd],autoPlaceSelectionBehavior:["type",Od]};function no(e,t){for(typeof t=="string"&&(t=[t]);e=e.parent;)if(ye(e,t))return e;return null}function Id(e,t){if(v(t,"bpmn:TextAnnotation"))return _0(e,t);if(ye(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return w0(e,t);if(v(t,"bpmn:FlowNode"))return b0(e,t)}function b0(e,t){var n=ee(e),i=ue(e),r=f0(e,{filter:function(l){return v(l,"bpmn:SequenceFlow")}}),a=30,o=80,s="left";v(e,"bpmn:BoundaryEvent")&&(s=tt(e,e.host,-25),s.indexOf("top")!==-1&&(a*=-1));var u={x:n.right+r+t.width/2,y:i.y+x0(s,o)},c={y:{margin:a,minDistance:o}};return Ku(e,t,u,Xu(c))}function x0(e,t){return e.indexOf("top")!=-1?-1*t:e.indexOf("bottom")!=-1?t:0}function _0(e,t){var n=ee(e),i={x:n.right+t.width/2,y:n.top-50-t.height/2},r={y:{margin:-30,minDistance:20}};return Ku(e,t,i,Xu(r))}function w0(e,t){var n=ee(e),i={x:n.right-10+t.width/2,y:n.bottom+40+t.width/2},r={x:{margin:30,minDistance:30}};return Ku(e,t,i,Xu(r))}function Nd(e){e.on("autoPlace",function(t){var n=t.shape,i=t.source;return Id(i,n)})}Nd.$inject=["eventBus"];var S0={__depends__:[E0],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",Nd]},C0=1e3;function U(e){this._eventBus=e}U.$inject=["eventBus"];function T0(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}U.prototype.on=function(e,t,n,i,r,a){if((ot(t)||ae(t))&&(a=r,r=i,i=n,n=t,t=null),ot(n)&&(a=r,r=i,i=n,n=C0),Qe(r)&&(a=r,r=!1),!ot(i))throw new Error("handlerFn must be a function");he(e)||(e=[e]);var o=this._eventBus;A(e,function(s){var u=["commandStack",s,t].filter(function(c){return c}).join(".");o.on(u,n,r?T0(i,a):i,a)})};var A0=["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"];A(A0,function(e){U.prototype[e]=function(t,n,i,r,a){(ot(t)||ae(t))&&(a=r,r=i,i=n,n=t,t=null),this.on(t,e,n,i,r,a)}});function _n(e,t,n,i){U.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],function(a){var o=a.context,s=o.hints||{},u=o.shape,c=o.parent||o.newParent;s.autoResize!==!1&&r._expand([u],c)}),this.postExecuted(["elements.move"],function(a){var o=a.context,s=Ya(wu(o.closure.topLevel)),u=o.hints,c=u?u.autoResize:!0;if(c!==!1){var l=ki(s,function(p){return p.parent.id});A(l,function(p,h){he(c)&&(p=p.filter(function(f){return _e(c,Gt({id:f.id}))})),r._expand(p,h)})}}),this.postExecuted(["shape.toggleCollapse"],function(a){var o=a.context,s=o.hints,u=o.shape;s&&s.autoResize===!1||u.collapsed||r._expand(u.children||[],u)}),this.postExecuted(["shape.resize"],function(a){var o=a.context,s=o.hints,u=o.shape,c=u.parent;s&&s.autoResize===!1||c&&r._expand([u],c)})}_n.$inject=["eventBus","elementRegistry","modeling","rules"];Z(_n,U);_n.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),r=ee(et(e)),a=ee(t),o={};return r.top-a.top<i.top&&(o.top=r.top-n.top),r.left-a.left<i.left&&(o.left=r.left-n.left),a.right-r.right<i.right&&(o.right=r.right+n.right),a.bottom-r.bottom<i.bottom&&(o.bottom=r.bottom+n.bottom),Iu(I({},a,o))};_n.prototype._expand=function(e,t){typeof t=="string"&&(t=this._elementRegistry.get(t));var n=this._rules.allowed("element.autoResize",{elements:e,target:t});if(!!n){var i=this._getOptimalBounds(e,t);if(!!R0(i,t)){var r=P0(Wt(t,["x","y","width","height"]),i);this.resize(t,i,{autoResize:r});var a=t.parent;a&&this._expand([t],a)}}};_n.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}};_n.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}};_n.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)};function R0(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function P0(e,t){var n="";return e=ee(e),t=ee(t),e.top>t.top&&(n=n.concat("n")),e.right<t.right&&(n=n.concat("w")),e.bottom<t.bottom&&(n=n.concat("s")),e.left>t.left&&(n=n.concat("e")),n}function Do(e){e.invoke(_n,this)}Do.$inject=["injector"];Z(Do,_n);Do.prototype.resize=function(e,t,n){v(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)};function Vn(e){U.call(this,e),this.init()}Vn.$inject=["eventBus"];Z(Vn,U);Vn.prototype.addRule=function(e,t,n){var i=this;typeof e=="string"&&(e=[e]),e.forEach(function(r){i.canExecute(r,t,function(a,o,s){return n(a)},!0)})};Vn.prototype.init=function(){};function $r(e){Vn.call(this,e);var t=this;this.addRule("element.autoResize",function(n){return t.canResize(n.elements,n.target)})}$r.$inject=["eventBus"];Z($r,Vn);$r.prototype.canResize=function(e,t){return!1};function Mo(e,t){$r.call(this,e),this._modeling=t}Z(Mo,$r);Mo.$inject=["eventBus","modeling"];Mo.prototype.canResize=function(e,t){if(!v(t,"bpmn:Participant")&&!v(t,"bpmn:Lane")&&!v(t,"bpmn:SubProcess"))return!1;var n=!0;return A(e,function(i){if(v(i,"bpmn:Lane")||i.labelTarget){n=!1;return}}),n};var D0={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",Do],bpmnAutoResizeProvider:["type",Mo]},up=1500;function Fd(e,t,n){var i=this,r=n.get("dragging",!1);function a(o){if(!o.hover){var s=o.originalEvent,u=i._findTargetGfx(s),c=u&&e.get(u);u&&c&&(o.stopPropagation(),r.hover({element:c,gfx:u}),r.move(s))}}r&&t.on("drag.start",function(o){t.once("drag.move",up,function(s){a(s)})}),function(){var o,s;t.on("element.hover",function(u){o=u.gfx,s=u.element}),t.on("element.hover",up,function(u){s&&t.fire("element.out",{element:s,gfx:o})}),t.on("element.out",function(){o=null,s=null})}(),this._findTargetGfx=function(o){var s,u;if(o instanceof MouseEvent)return s=Ln(o),u=document.elementFromPoint(s.x,s.y),M0(u)}}Fd.$inject=["elementRegistry","eventBus","injector"];function M0(e){return li(e,"svg, .djs-element",!0)}var B0={__init__:["hoverFix"],hoverFix:["type",Fd]},Si=Math.round,cp="djs-drag-active";function ii(e){e.preventDefault()}function O0(e){return typeof TouchEvent!="undefined"&&e instanceof TouchEvent}function I0(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function kd(e,t,n,i){var r={threshold:5,trapClick:!0},a;function o(w){var b=t.viewbox(),_=t._container.getBoundingClientRect();return{x:b.x+(w.x-_.left)/b.scale,y:b.y+(w.y-_.top)/b.scale}}function s(w,b){b=b||a;var _=e.createEvent(I({},b.payload,b.data,{isTouch:b.isTouch}));return e.fire("drag."+w,_)===!1?!1:e.fire(b.prefix+"."+w,_)}function u(w){var b=w.filter(function(_){return i.get(_.id)});b.length&&n.select(b)}function c(w,b){var _=a.payload,D=a.displacement,B=a.globalStart,R=Ln(w),L=nn(R,B),z=a.localStart,q=o(R),W=nn(q,z);if(!a.active&&(b||I0(L)>a.threshold)){if(I(_,{x:Si(z.x+D.x),y:Si(z.y+D.y),dx:0,dy:0},{originalEvent:w}),s("start")===!1)return x();a.active=!0,a.keepSelection||(_.previousSelection=n.get(),n.select(null)),a.cursor&&Po(a.cursor),t.addMarker(t.getRootElement(),cp)}bs(w),a.active&&(I(_,{x:Si(q.x+D.x),y:Si(q.y+D.y),dx:Si(W.x),dy:Si(W.y)},{originalEvent:w}),s("move"))}function l(w){var b,_=!0;a.active&&(w&&(a.payload.originalEvent=w,bs(w)),_=s("end")),_===!1&&s("rejected"),b=M(_!==!0),s("ended",b)}function p(w){w.which===27&&(ii(w),x())}function h(w){var b;a.active&&(b=wd(e),setTimeout(b,400),ii(w)),l(w)}function f(w){c(w)}function d(w){var b=a.payload;b.hoverGfx=w.gfx,b.hover=w.element,s("hover")}function y(w){s("out");var b=a.payload;b.hoverGfx=null,b.hover=null}function x(w){var b;if(!!a){var _=a.active;_&&s("cancel"),b=M(w),_&&s("canceled",b)}}function M(w){var b,_;s("cleanup"),_d(),a.trapClick?_=h:_=l,te.unbind(document,"mousemove",c),te.unbind(document,"dragstart",ii),te.unbind(document,"selectstart",ii),te.unbind(document,"mousedown",_,!0),te.unbind(document,"mouseup",_,!0),te.unbind(document,"keyup",p),te.unbind(document,"touchstart",f,!0),te.unbind(document,"touchcancel",x,!0),te.unbind(document,"touchmove",c,!0),te.unbind(document,"touchend",l,!0),e.off("element.hover",d),e.off("element.out",y),t.removeMarker(t.getRootElement(),cp);var D=a.payload.previousSelection;return w!==!1&&D&&!n.get().length&&u(D),b=a,a=null,b}function P(w,b,_,D){a&&x(!1),typeof b=="string"&&(D=_,_=b,b=null),D=I({},r,D||{});var B=D.data||{},R,L,z,q,W;D.trapClick?q=h:q=l,w?(R=Wi(w)||w,L=Ln(w),bs(w),R.type==="dragstart"&&ii(R)):(R=null,L={x:0,y:0}),z=o(L),b||(b=z),W=O0(R),a=I({prefix:_,data:B,payload:{},globalStart:L,displacement:nn(b,z),localStart:z,isTouch:W},D),D.manual||(W?(te.bind(document,"touchstart",f,!0),te.bind(document,"touchcancel",x,!0),te.bind(document,"touchmove",c,!0),te.bind(document,"touchend",l,!0)):(te.bind(document,"mousemove",c),te.bind(document,"dragstart",ii),te.bind(document,"selectstart",ii),te.bind(document,"mousedown",q,!0),te.bind(document,"mouseup",q,!0)),te.bind(document,"keyup",p),e.on("element.hover",d),e.on("element.out",y)),s("init"),D.autoActivate&&c(w,!0)}e.on("diagram.destroy",x),this.init=P,this.move=c,this.hover=d,this.out=y,this.end=l,this.cancel=x,this.context=function(){return a},this.setOptions=function(w){I(r,w)}}kd.$inject=["eventBus","canvas","selection","elementRegistry"];var wn={__depends__:[B0,sn],dragging:["type",kd]};function Ki(e,t,n){this._canvas=n,this._opts=I({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(r){var a=i._toBorderPoint(r);i.startScroll(a)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}Ki.$inject=["config.autoScroll","eventBus","canvas"];Ki.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),a=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var o=0,s=0,u=0;u<4;u++)N0(a[u],n.scrollThresholdOut[u],n.scrollThresholdIn[u])&&(u===0?o=n.scrollStep:u==1?s=n.scrollStep:u==2?o=-n.scrollStep:u==3&&(s=-n.scrollStep));(o!==0||s!==0)&&(t.scroll({dx:o,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))};function N0(e,t,n){return t<e&&e<n}Ki.prototype.stopScroll=function(){clearTimeout(this._scrolling)};Ki.prototype.setOptions=function(e){this._opts=I({},this._opts,e)};Ki.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=Ln(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};var F0={__depends__:[wn],__init__:["autoScroll"],autoScroll:["type",Ki]};function Zu(e){this._commandStack=e.get("commandStack",!1)}Zu.$inject=["injector"];Zu.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),n===void 0?!0:n};var cn={__init__:["rules"],rules:["type",Zu]},Ea=Math.round,k0=Math.max;function L0(e,t){var n=e.x,i=e.y;return[["M",n,i],["m",0,-t],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]}function $0(e){var t=[];return e.forEach(function(n,i){t.push([i===0?"M":"L",n.x,n.y])}),t}var Ld=10;function j0(e,t){var n,i;for(n=0;i=e[n];n++)if(Mr(i,t)<=Ld)return{point:e[n],bendpoint:!0,index:n};return null}function H0(e,t){var n=Bh(L0(t,Ld),$0(e)),i=n[0],r=n[n.length-1],a;return i?i!==r?i.segment2!==r.segment2?(a=k0(i.segment2,r.segment2)-1,{point:e[a],bendpoint:!0,index:a}):{point:{x:Ea(i.x+r.x)/2,y:Ea(i.y+r.y)/2},index:i.segment2}:{point:{x:Ea(i.x),y:Ea(i.y)},index:i.segment2}:null}function nu(e,t){return j0(e,t)||H0(e,t)}var $d="djs-bendpoint",jd="djs-segment-dragger";function z0(e,t){var n=Ln(t),i=e._container.getBoundingClientRect(),r;r={x:i.left,y:i.top};var a=e.viewbox();return{x:a.x+(n.x-r.x)/a.scale,y:a.y+(n.y-r.y)/a.scale}}function iu(e,t,n){var i=z0(e,n),r=nu(t,i);return r}function ru(e,t){var n=J("g");fe(n).add($d),ne(e,n);var i=J("circle");H(i,{cx:0,cy:0,r:4}),fe(i).add("djs-visual"),ne(n,i);var r=J("circle");return H(r,{cx:0,cy:0,r:10}),fe(r).add("djs-hit"),ne(n,r),t&&fe(n).add(t),n}function G0(e,t,n,i){var r=J("g");ne(e,r);var a=14,o=3,s=11,u=V0(t,n,i),c=o+s,l=J("rect");H(l,{x:-a/2,y:-o/2,width:a,height:o}),fe(l).add("djs-visual"),ne(r,l);var p=J("rect");return H(p,{x:-u/2,y:-c/2,width:u,height:c}),fe(p).add("djs-hit"),ne(r,p),Uh(r,i==="v"?90:0),r}function Hd(e,t,n){var i=J("g"),r=Us(t,n),a=vn(t,n);return ne(e,i),G0(i,t,n,a),fe(i).add(jd),fe(i).add(a==="h"?"horizontal":"vertical"),mt(i,r.x,r.y),i}function au(e){return Math.abs(Math.round(e*2/3))}function V0(e,t,n){var i=t.x-e.x,r=t.y-e.y;return au(n==="h"?i:r)}var zd={exports:{}};/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */(function(e,t){(function(n,i){e.exports=i(n)})(typeof vs!="undefined"?vs:vs,function(n){if(n.CSS&&n.CSS.escape)return n.CSS.escape;var i=function(r){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var a=String(r),o=a.length,s=-1,u,c="",l=a.charCodeAt(0);++s<o;){if(u=a.charCodeAt(s),u==0){c+="\uFFFD";continue}if(u>=1&&u<=31||u==127||s==0&&u>=48&&u<=57||s==1&&u>=48&&u<=57&&l==45){c+="\\"+u.toString(16)+" ";continue}if(s==0&&o==1&&u==45){c+="\\"+a.charAt(s);continue}if(u>=128||u==45||u==95||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122){c+=a.charAt(s);continue}c+="\\"+a.charAt(s)}return c};return n.CSS||(n.CSS={}),n.CSS.escape=i,i})})(zd);var ou=zd.exports,W0={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function lp(e){return e=""+e,e&&e.replace(/[&<>"']/g,function(t){return W0[t]})}function Gd(e,t,n,i,r){function a(w,b,_){var D=w.index,B=w.point,R,L,z,q,W,X;return D<=0||w.bendpoint?!1:(R=b[D-1],L=b[D],z=Us(R,L),q=vn(R,L),W=Math.abs(B.x-z.x),X=Math.abs(B.y-z.y),q&&W<=_&&X<=_)}function o(w,b){var _=w.waypoints,D,B,R,L;return b.index<=0||b.bendpoint||(D={start:_[b.index-1],end:_[b.index]},B=vn(D.start,D.end),!B)?null:(B==="h"?R=D.end.x-D.start.x:R=D.end.y-D.start.y,L=au(R)/2,L)}function s(w,b){var _=b.waypoints,D=iu(t,_,w),B;if(!!D)return B=o(b,D),a(D,_,B)?r.start(w,b,D.index):i.start(w,b,D.index,!D.bendpoint),!0}function u(w,b,_){te.bind(w,b,function(D){n.triggerMouseEvent(b,D,_),D.stopPropagation()})}function c(w,b){var _=t.getLayer("overlays"),D=Oe('.djs-bendpoints[data-element-id="'+ou(w.id)+'"]',_);return!D&&b&&(D=J("g"),H(D,{"data-element-id":w.id}),fe(D).add("djs-bendpoints"),ne(_,D),u(D,"mousedown",w),u(D,"click",w),u(D,"dblclick",w)),D}function l(w,b){return Oe('.djs-segment-dragger[data-segment-idx="'+w+'"]',b)}function p(w,b){b.waypoints.forEach(function(_,D){var B=ru(w);ne(w,B),mt(B,_.x,_.y)}),ru(w,"floating")}function h(w,b){for(var _=b.waypoints,D,B,R,L=1;L<_.length;L++)D=_[L-1],B=_[L],vn(D,B)&&(R=Hd(w,D,B),H(R,{"data-segment-idx":L}),u(R,"mousemove",b))}function f(w){A(js("."+$d,w),function(b){ke(b)})}function d(w){A(js("."+jd,w),function(b){ke(b)})}function y(w){var b=c(w);return b||(b=c(w,!0),p(b,w),h(b,w)),b}function x(w){var b=c(w);b&&(d(b),f(b),h(b,w),p(b,w))}function M(w,b){var _=Oe(".floating",w),D=b.point;!_||mt(_,D.x,D.y)}function P(w,b,_){var D=l(b.index,w),B=_[b.index-1],R=_[b.index],L=b.point,z=Us(B,R),q=vn(B,R),W,X;!D||(W=U0(D),X={x:L.x-z.x,y:L.y-z.y},q==="v"&&(X={x:X.y,y:X.x}),mt(W,X.x,X.y))}e.on("connection.changed",function(w){x(w.element)}),e.on("connection.remove",function(w){var b=c(w.element);b&&ke(b)}),e.on("element.marker.update",function(w){var b=w.element,_;!b.waypoints||(_=y(b),w.add?fe(_).add(w.marker):fe(_).remove(w.marker))}),e.on("element.mousemove",function(w){var b=w.element,_=b.waypoints,D,B;if(_){if(D=c(b,!0),B=iu(t,_,w.originalEvent),!B)return;M(D,B),B.bendpoint||P(D,B,_)}}),e.on("element.mousedown",function(w){if(!!zn(w)){var b=w.originalEvent,_=w.element;if(!!_.waypoints)return s(b,_)}}),e.on("selection.changed",function(w){var b=w.newSelection,_=b[0];_&&_.waypoints&&y(_)}),e.on("element.hover",function(w){var b=w.element;b.waypoints&&(y(b),n.registerEvent(w.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(w){n.unregisterEvent(w.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(w){var b=w.element,_=w.newId;if(b.waypoints){var D=c(b);D&&H(D,{"data-element-id":_})}}),this.addHandles=y,this.updateHandles=x,this.getBendpointsContainer=c,this.getSegmentDragger=l}Gd.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];function U0(e){return Oe(".djs-visual",e)}var pp=Math.round,ri="reconnectStart",ai="reconnectEnd",or="updateWaypoints";function Ju(e,t,n,i,r,a){this._injector=e,this.start=function(o,s,u,c){var l=n.getGraphics(s),p=s.source,h=s.target,f=s.waypoints,d;!c&&u===0?d=ri:!c&&u===f.length-1?d=ai:d=or;var y=d===or?"connection.updateWaypoints":"connection.reconnect",x=r.allowed(y,{connection:s,source:p,target:h});x===!1&&(x=r.allowed(y,{connection:s,source:h,target:p})),x!==!1&&i.init(o,"bendpoint.move",{data:{connection:s,connectionGfx:l,context:{allowed:x,bendpointIndex:u,connection:s,source:p,target:h,insert:c,type:d}}})},t.on("bendpoint.move.hover",function(o){var s=o.context,u=s.connection,c=u.source,l=u.target,p=o.hover,h=s.type;s.hover=p;var f;if(!!p){var d=h===or?"connection.updateWaypoints":"connection.reconnect";if(f=s.allowed=r.allowed(d,{connection:u,source:h===ri?p:c,target:h===ai?p:l}),f){s.source=h===ri?p:c,s.target=h===ai?p:l;return}f===!1&&(f=s.allowed=r.allowed(d,{connection:u,source:h===ai?p:l,target:h===ri?p:c})),f&&(s.source=h===ai?p:l,s.target=h===ri?p:c)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(o){var s=o.context,u=s.type;s.hover=null,s.source=null,s.target=null,u!==or&&(s.allowed=!1)}),t.on("bendpoint.move.end",function(o){var s=o.context,u=s.allowed,c=s.bendpointIndex,l=s.connection,p=s.insert,h=l.waypoints.slice(),f=s.source,d=s.target,y=s.type,x=s.hints||{},M={x:pp(o.x),y:pp(o.y)};if(!u)return!1;y===or?(p?h.splice(c,0,M):h[c]=M,x.bendpointMove={insert:p,bendpointIndex:c},h=this.cropWaypoints(l,h),a.updateWaypoints(l,Ny(h),x)):(y===ri?(x.docking="source",io(s)&&(x.docking="target",x.newWaypoints=h.reverse())):y===ai&&(x.docking="target",io(s)&&(x.docking="source",x.newWaypoints=h.reverse())),a.reconnect(l,f,d,M,x))},this)}Ju.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];Ju.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};function io(e){var t=e.hover,n=e.source,i=e.target,r=e.type;if(r===ri)return t&&i&&t===i&&n!==i;if(r===ai)return t&&n&&t===n&&n!==i}var Y0="reconnectStart",q0="reconnectEnd",fp="updateWaypoints",sr="connect-ok",ba="connect-not-ok",hp="connect-hover",dp="djs-updating",mp="djs-element-hidden",vp=1100;function Vd(e,t,n,i){this._injector=t;var r=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(a){var o=a.context,s=o.bendpointIndex,u=o.connection,c=o.insert,l=u.waypoints,p=l.slice();o.waypoints=l,c&&p.splice(s,0,{x:a.x,y:a.y}),u.waypoints=p;var h=o.draggerGfx=ru(i.getLayer("overlays"));fe(h).add("djs-dragging"),i.addMarker(u,mp),i.addMarker(u,dp)}),n.on("bendpoint.move.hover",function(a){var o=a.context,s=o.allowed,u=o.hover,c=o.type;if(u){if(i.addMarker(u,hp),c===fp)return;s?(i.removeMarker(u,ba),i.addMarker(u,sr)):s===!1&&(i.removeMarker(u,sr),i.addMarker(u,ba))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],vp,function(a){var o=a.context,s=o.hover,u=o.target;s&&(i.removeMarker(s,hp),i.removeMarker(s,u?sr:ba))}),n.on("bendpoint.move.move",function(a){var o=a.context,s=o.allowed,u=o.bendpointIndex,c=o.draggerGfx,l=o.hover,p=o.type,h=o.connection,f=h.source,d=h.target,y=h.waypoints.slice(),x={x:a.x,y:a.y},M=o.hints||{},P={};r&&(M.connectionStart&&(P.connectionStart=M.connectionStart),M.connectionEnd&&(P.connectionEnd=M.connectionEnd),p===Y0?io(o)?(P.connectionEnd=P.connectionEnd||x,P.source=d,P.target=l||f,y=y.reverse()):(P.connectionStart=P.connectionStart||x,P.source=l||f,P.target=d):p===q0?io(o)?(P.connectionStart=P.connectionStart||x,P.source=l||d,P.target=f,y=y.reverse()):(P.connectionEnd=P.connectionEnd||x,P.source=f,P.target=l||d):(P.noCropping=!0,P.noLayout=!0,y[u]=x),p===fp&&(y=e.cropWaypoints(h,y)),P.waypoints=y,r.drawPreview(o,s,P)),mt(c,a.x,a.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],vp,function(a){var o=a.context,s=o.connection,u=o.draggerGfx,c=o.hover,l=o.target,p=o.waypoints;s.waypoints=p,ke(u),i.removeMarker(s,dp),i.removeMarker(s,mp),c&&(i.removeMarker(c,sr),i.removeMarker(c,l?sr:ba)),r&&r.cleanUp(o)})}Vd.$inject=["bendpointMove","injector","eventBus","canvas"];var gp="connect-hover",yp="djs-updating";function Ep(e,t,n){return Qu(e,t,e[t]+n)}function Qu(e,t,n){return{x:t==="x"?n:e.x,y:t==="y"?n:e.y}}function K0(e,t,n,i){var r=Math.max(t[i],n[i]),a=Math.min(t[i],n[i]),o=20,s=Math.min(Math.max(a+o,e[i]),r-o);return Qu(t,i,s)}function Wd(e){return e==="x"?"y":"x"}function bp(e,t,n){var i,r;return e.original?e.original:(i=ue(t),r=Wd(n),Qu(e,r,i[r]))}function Ud(e,t,n,i,r,a){var o=e.get("connectionDocking",!1);this.start=function(p,h,f){var d,y=n.getGraphics(h),x=f-1,M=f,P=h.waypoints,w=P[x],b=P[M],_=iu(n,P,p),D,B,R;D=vn(w,b),D&&(B=D==="v"?"x":"y",x===0&&(w=bp(w,h.source,B)),M===P.length-1&&(b=bp(b,h.target,B)),_?R=_.point:R={x:(w.x+b.x)/2,y:(w.y+b.y)/2},d={connection:h,segmentStartIndex:x,segmentEndIndex:M,segmentStart:w,segmentEnd:b,axis:B,dragPosition:R},i.init(p,R,"connectionSegment.move",{cursor:B==="x"?"resize-ew":"resize-ns",data:{connection:h,connectionGfx:y,context:d}}))};function s(p,h){if(!o)return h;var f=p.waypoints,d;return p.waypoints=h,d=o.getCroppedWaypoints(p),p.waypoints=f,d}function u(p){r.update("connection",p.connection,p.connectionGfx)}function c(p,h,f){var d=p.newWaypoints,y=p.segmentStartIndex+h,x=d[y],M=p.segmentEndIndex+h,P=d[M],w=Wd(p.axis),b=K0(f,x,P,w);mt(p.draggerGfx,b.x,b.y)}function l(p,h){var f=0,d=p.filter(function(y,x){return Bu(p[x-1],p[x+1],y)?(f=x<=h?f-1:f,!1):!0});return{waypoints:d,segmentOffset:f}}t.on("connectionSegment.move.start",function(p){var h=p.context,f=p.connection,d=n.getLayer("overlays");h.originalWaypoints=f.waypoints.slice(),h.draggerGfx=Hd(d,h.segmentStart,h.segmentEnd),fe(h.draggerGfx).add("djs-dragging"),n.addMarker(f,yp)}),t.on("connectionSegment.move.move",function(p){var h=p.context,f=h.connection,d=h.segmentStartIndex,y=h.segmentEndIndex,x=h.segmentStart,M=h.segmentEnd,P=h.axis,w=h.originalWaypoints.slice(),b=Ep(x,P,p["d"+P]),_=Ep(M,P,p["d"+P]),D=w.length,B=0;w[d]=b,w[y]=_;var R,L;d<2&&(R=tt(f.source,b),d===1?R==="intersect"&&(w.shift(),w[0]=b,B--):R!=="intersect"&&(w.unshift(x),B++)),y>D-3&&(L=tt(f.target,_),y===D-2?L==="intersect"&&(w.pop(),w[w.length-1]=_):L!=="intersect"&&w.push(M)),h.newWaypoints=f.waypoints=s(f,w),c(h,B,p),h.newSegmentStartIndex=d+B,u(p)}),t.on("connectionSegment.move.hover",function(p){p.context.hover=p.hover,n.addMarker(p.hover,gp)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(p){var h=p.context.hover;h&&n.removeMarker(h,gp)}),t.on("connectionSegment.move.cleanup",function(p){var h=p.context,f=h.connection;h.draggerGfx&&ke(h.draggerGfx),n.removeMarker(f,yp)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(p){var h=p.context,f=h.connection;f.waypoints=h.originalWaypoints,u(p)}),t.on("connectionSegment.move.end",function(p){var h=p.context,f=h.connection,d=h.newWaypoints,y=h.newSegmentStartIndex;d=d.map(function(_){return{original:_.original,x:Math.round(_.x),y:Math.round(_.y)}});var x=l(d,y),M=x.waypoints,P=s(f,M),w=x.segmentOffset,b={segmentMove:{segmentStartIndex:h.segmentStartIndex,newSegmentStartIndex:y+w}};a.updateWaypoints(f,P,b)})}Ud.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var X0=Math.abs,xp=Math.round;function Z0(e,t,n){n=n===void 0?10:n;var i,r;for(i=0;i<t.length;i++)if(r=t[i],X0(r-e)<=n)return r}function Yd(e){return{x:e.x,y:e.y}}function qd(e){return{x:e.x+e.width,y:e.y+e.height}}function Pt(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:xp(e.x+e.width/2),y:xp(e.y+e.height/2)}}function Ii(e,t){var n=e.snapped;return n?typeof t=="string"?n[t]:n.x&&n.y:!1}function He(e,t,n){if(typeof t!="string")throw new Error("axis must be in [x, y]");if(typeof n!="number"&&n!==!1)throw new Error("value must be Number or false");var i,r=e[t],a=e.snapped=e.snapped||{};return n===!1?a[t]=!1:(a[t]=!0,i=n-r,e[t]+=i,e["d"+t]+=i),r}function Kd(e){return e.children||[]}var J0=Math.abs,_p=Math.round,Ss=10;function Xd(e){function t(a,o){if(he(a)){for(var s=a.length;s--;)if(J0(a[s]-o)<=Ss)return a[s]}else{a=+a;var u=o%a;if(u<Ss)return o-u;if(u>a-Ss)return o-u+a}return o}function n(a){if(a.width)return{x:_p(a.width/2+a.x),y:_p(a.height/2+a.y)}}function i(a){var o=a.snapPoints,s=a.connection,u=s.waypoints,c=a.segmentStart,l=a.segmentStartIndex,p=a.segmentEnd,h=a.segmentEndIndex,f=a.axis;if(o)return o;var d=[u[l-1],c,p,u[h+1]];return l<2&&d.unshift(n(s.source)),h>u.length-3&&d.unshift(n(s.target)),a.snapPoints=o={horizontal:[],vertical:[]},A(d,function(y){y&&(y=y.original||y,f==="y"&&o.horizontal.push(y.y),f==="x"&&o.vertical.push(y.x))}),o}e.on("connectionSegment.move.move",1500,function(a){var o=a.context,s=i(o),u=a.x,c=a.y,l,p;if(!!s){l=t(s.vertical,u),p=t(s.horizontal,c);var h=u-l,f=c-p;I(a,{dx:a.dx-h,dy:a.dy-f,x:l,y:p}),(h||s.vertical.indexOf(u)!==-1)&&He(a,"x",l),(f||s.horizontal.indexOf(c)!==-1)&&He(a,"y",p)}});function r(a){var o=a.snapPoints,s=a.connection.waypoints,u=a.bendpointIndex;if(o)return o;var c=[s[u-1],s[u+1]];return a.snapPoints=o={horizontal:[],vertical:[]},A(c,function(l){l&&(l=l.original||l,o.horizontal.push(l.y),o.vertical.push(l.x))}),o}e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(a){var o=a.context,s=r(o),u=o.hover,c=u&&n(u),l=a.x,p=a.y,h,f;if(!!s){h=t(c?s.vertical.concat([c.x]):s.vertical,l),f=t(c?s.horizontal.concat([c.y]):s.horizontal,p);var d=l-h,y=p-f;I(a,{dx:a.dx-d,dy:a.dy-y,x:a.x-d,y:a.y-y}),(d||s.vertical.indexOf(l)!==-1)&&He(a,"x",h),(y||s.horizontal.indexOf(p)!==-1)&&He(a,"y",f)}})}Xd.$inject=["eventBus"];var Q0={__depends__:[wn,cn],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",Gd],bendpointMove:["type",Ju],bendpointMovePreview:["type",Vd],connectionSegmentMove:["type",Ud],bendpointSnapping:["type",Xd]};function Zd(e,t,n,i){function r(o,s){return i.allowed("connection.create",{source:o,target:s})}function a(o,s){return r(s,o)}e.on("connect.hover",function(o){var s=o.context,u=s.start,c=o.hover,l;if(s.hover=c,l=s.canExecute=r(u,c),!Cl(l)){if(l!==!1){s.source=u,s.target=c;return}l=s.canExecute=a(u,c),!Cl(l)&&l!==!1&&(s.source=c,s.target=u)}}),e.on(["connect.out","connect.cleanup"],function(o){var s=o.context;s.hover=null,s.source=null,s.target=null,s.canExecute=!1}),e.on("connect.end",function(o){var s=o.context,u=s.canExecute,c=s.connectionStart,l={x:o.x,y:o.y},p=s.source,h=s.target;if(!u)return!1;var f=null,d={connectionStart:su(s)?l:c,connectionEnd:su(s)?c:l};Qe(u)&&(f=u),n.connect(p,h,f,d)}),this.start=function(o,s,u,c){Qe(u)||(c=u,u=ue(s)),t.init(o,"connect",{autoActivate:c,data:{shape:s,context:{start:s,connectionStart:u}}})}}Zd.$inject=["eventBus","dragging","modeling","rules"];function su(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}var e_=1100,t_=900,wp="connect-ok",Sp="connect-not-ok";function Jd(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(r){var a=r.context,o=a.canExecute,s=a.hover,u=a.source,c=a.start,l=a.startPosition,p=a.target,h=a.connectionStart||l,f=a.connectionEnd||{x:r.x,y:r.y},d=h,y=f;su(a)&&(d=f,y=h),i.drawPreview(a,o,{source:u||c,target:p||s,connectionStart:d,connectionEnd:y})}),t.on("connect.hover",t_,function(r){var a=r.context,o=r.hover,s=a.canExecute;s!==null&&n.addMarker(o,s?wp:Sp)}),t.on(["connect.out","connect.cleanup"],e_,function(r){var a=r.hover;a&&(n.removeMarker(a,wp),n.removeMarker(a,Sp))}),i&&t.on("connect.cleanup",function(r){i.cleanUp(r.context)})}Jd.$inject=["injector","eventBus","canvas"];var ec={__depends__:[sn,cn,wn],__init__:["connectPreview"],connect:["type",Zd],connectPreview:["type",Jd]},n_="djs-connection-preview";function Sn(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}Sn.$inject=["injector","canvas","graphicsFactory","elementFactory"];Sn.prototype.drawPreview=function(e,t,n){n=n||{};var i=e.connectionPreviewGfx,r=e.getConnection,a=n.source,o=n.target,s=n.waypoints,u=n.connectionStart,c=n.connectionEnd,l=n.noLayout,p=n.noCropping,h=n.noNoop,f,d=this;if(i||(i=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),Ru(i),r||(r=e.getConnection=i_(function(y,x,M){return d.getConnection(y,x,M)})),t&&(f=r(t,a,o)),!f){!h&&this.drawNoopPreview(i,n);return}f.waypoints=s||[],this._layouter&&!l&&(f.waypoints=this._layouter.layoutConnection(f,{source:a,target:o,connectionStart:u,connectionEnd:c,waypoints:n.waypoints||f.waypoints})),(!f.waypoints||!f.waypoints.length)&&(f.waypoints=[a?ue(a):u,o?ue(o):c]),this._connectionDocking&&(a||o)&&!p&&(f.waypoints=this._connectionDocking.getCroppedWaypoints(f,a,o)),this._graphicsFactory.drawConnection(i,f)};Sn.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,r=t.connectionStart||ue(n),a=t.connectionEnd||ue(i),o=this.cropWaypoints(r,a,n,i),s=this.createNoopConnection(o[0],o[1]);ne(e,s)};Sn.prototype.cropWaypoints=function(e,t,n,i){var r=this._graphicsFactory,a=n&&r.getShapePath(n),o=i&&r.getShapePath(i),s=r.getConnectionPath({waypoints:[e,t]});return e=n&&qs(a,s,!0)||e,t=i&&qs(o,s,!1)||t,[e,t]};Sn.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&ke(e.connectionPreviewGfx)};Sn.prototype.getConnection=function(e){var t=r_(e);return this._elementFactory.createConnection(t)};Sn.prototype.createConnectionPreviewGfx=function(){var e=J("g");return H(e,{pointerEvents:"none"}),fe(e).add(n_),ne(this._canvas.getActiveLayer(),e),e};Sn.prototype.createNoopConnection=function(e,t){var n=J("polyline");return H(n,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),H(n,{points:[e.x,e.y,t.x,t.y]}),n};function i_(e){var t={};return function(n){var i=JSON.stringify(n),r=t[i];return r||(r=t[i]=e.apply(null,arguments)),r}}function r_(e){return Qe(e)?e:{}}var a_={__init__:["connectionPreview"],connectionPreview:["type",Sn]},Cp=Math.min,Tp=Math.max;function Cs(e){e.preventDefault()}function yr(e){e.stopPropagation()}function o_(e){return e.nodeType===Node.TEXT_NODE}function s_(e){return[].slice.call(e)}function Yt(e){this.container=e.container,this.parent=Ae('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=Oe("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=ft(this.autoResize,this),this.handlePaste=ft(this.handlePaste,this)}Yt.prototype.create=function(e,t,n,i){var r=this,a=this.parent,o=this.content,s=this.container;i=this.options=i||{},t=this.style=t||{};var u=Wt(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);I(a.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},u);var c=Wt(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return I(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&I(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),o.innerText=n,te.bind(o,"keydown",this.keyHandler),te.bind(o,"mousedown",yr),te.bind(o,"paste",r.handlePaste),i.autoResize&&te.bind(o,"input",this.autoResize),i.resizable&&this.resizable(t),s.appendChild(a),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),a};Yt.prototype.handlePaste=function(e){var t=this.options,n=this.style;e.preventDefault();var i;if(e.clipboardData?i=e.clipboardData.getData("text/plain"):i=window.clipboardData.getData("Text"),this.insertText(i),t.autoResize){var r=this.autoResize(n);r&&this.resizeHandler(r)}};Yt.prototype.insertText=function(e){e=u_(e);var t=document.execCommand("insertText",!1,e);t||this._insertTextIE(e)};Yt.prototype._insertTextIE=function(e){var t=this.getSelection(),n=t.startContainer,i=t.endContainer,r=t.startOffset,a=t.endOffset,o=t.commonAncestorContainer,s=s_(o.childNodes),u,c;if(o_(o)){var l=n.textContent;n.textContent=l.substring(0,r)+e+l.substring(a),u=n,c=r+e.length}else if(n===this.content&&i===this.content){var p=document.createTextNode(e);this.content.insertBefore(p,s[r]),u=p,c=p.textContent.length}else{var h=s.indexOf(n),f=s.indexOf(i);s.forEach(function(d,y){y===h?d.textContent=n.textContent.substring(0,r)+e+i.textContent.substring(a):y>h&&y<=f&&on(d)}),u=n,c=r+e.length}u&&c!==void 0&&setTimeout(function(){self.setSelection(u,c)})};Yt.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),r=t.scrollHeight;e.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}};Yt.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,a=parseInt(this.style.maxWidth)||1/0,o=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=Ae('<div class="djs-direct-editing-resize-handle"></div>');var s,u,c,l,p=function(d){Cs(d),yr(d),s=d.clientX,u=d.clientY;var y=t.getBoundingClientRect();c=y.width,l=y.height,te.bind(document,"mousemove",h),te.bind(document,"mouseup",f)},h=function(d){Cs(d),yr(d);var y=Cp(Tp(c+d.clientX-s,i),a),x=Cp(Tp(l+d.clientY-u,r),o);t.style.width=y+"px",t.style.height=x+"px",e.resizeHandler({width:c,height:l,dx:d.clientX-s,dy:d.clientY-u})},f=function(d){Cs(d),yr(d),te.unbind(document,"mousemove",h,!1),te.unbind(document,"mouseup",f,!1)};te.bind(n,"mousedown",p)}I(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)};Yt.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),te.unbind(t,"keydown",this.keyHandler),te.unbind(t,"mousedown",yr),te.unbind(t,"input",this.autoResize),te.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),on(n)),on(e)};Yt.prototype.getValue=function(){return this.content.innerText.trim()};Yt.prototype.getSelection=function(){var e=window.getSelection(),t=e.getRangeAt(0);return t};Yt.prototype.setSelection=function(e,t){var n=document.createRange();e===null?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};function u_(e){return e.replace(/\r\n|\r|\n/g,`
`)}function Ot(e,t){this._eventBus=e,this._providers=[],this._textbox=new Yt({container:t.getContainer(),keyHandler:ft(this._handleKey,this),resizeHandler:ft(this._handleResize,this)})}Ot.$inject=["eventBus","canvas"];Ot.prototype.registerProvider=function(e){this._providers.push(e)};Ot.prototype.isActive=function(){return!!this._active};Ot.prototype.cancel=function(){!this._active||(this._fire("cancel"),this.close())};Ot.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})};Ot.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0};Ot.prototype.complete=function(){var e=this._active;if(!!e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue(),a=e.context.text;(r!==a||i.height!==n.height||i.width!==n.width)&&(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,r,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}};Ot.prototype.getValue=function(){return this._textbox.getValue()};Ot.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;if(t===27)return e.preventDefault(),this.cancel();if(t===13&&!e.shiftKey)return e.preventDefault(),this.complete()};Ot.prototype._handleResize=function(e){this._fire("resize",e)};Ot.prototype.activate=function(e){this.isActive()&&this.cancel();var t,n=_e(this._providers,function(i){return(t=i.activate(e))?i:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};var Qd={__depends__:[kr],__init__:["directEditing"],directEditing:["type",Ot]},Ap=".entry",c_=1e3;function It(e,t,n){this._eventBus=t,this._overlays=n;var i=tn(e&&e.scale)?e.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:i},this._current=null,this._init()}It.$inject=["config.contextPad","eventBus","overlays"];It.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",function(n){var i=n.newSelection;i.length===1?t.open(i[0]):t.close()}),e.on("elements.delete",function(n){var i=n.elements;A(i,function(r){t.isOpen(r)&&t.close()})}),e.on("element.changed",function(n){var i=n.element,r=t._current;r&&r.element===i&&t.open(i,!0)})};It.prototype.registerProvider=function(e,t){t||(t=e,e=c_),this._eventBus.on("contextPad.getProviders",e,function(n){n.providers.push(t)})};It.prototype.getEntries=function(e){var t=this._getProviders(),n={};return A(t,function(i){var r=i.getContextPadEntries(e);ot(r)?n=r(n):A(r,function(a,o){n[o]=a})}),n};It.prototype.trigger=function(e,t,n){var i=this._current.element,r=this._current.entries,a,o,s,u=t.delegateTarget||t.target;if(!u)return t.preventDefault();if(a=r[St(u,"data-action")],o=a.action,s=t.originalEvent||t,ot(o)){if(e==="click")return o(s,i,n)}else if(o[e])return o[e](s,i,n);t.preventDefault()};It.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))};It.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers};It.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html;A(t,function(r,a){var o=r.group||"default",s=Ae(r.html||'<div class="entry" draggable="true"></div>'),u;St(s,"data-action",a),u=Oe("[data-group="+o+"]",i),u||(u=Ae('<div class="group" data-group="'+o+'"></div>'),i.appendChild(u)),u.appendChild(s),r.className&&l_(s,r.className),r.title&&St(s,"title",r.title),r.imageUrl&&s.appendChild(Ae('<img src="'+r.imageUrl+'">'))}),ze(i).add("open"),this._current={element:e,pad:n,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})};It.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=Ae('<div class="djs-context-pad"></div>'),r=I({html:i},this._overlaysConfig);xt.bind(i,Ap,"click",function(o){t.trigger("click",o)}),xt.bind(i,Ap,"dragstart",function(o){t.trigger("dragstart",o)}),te.bind(i,"mousedown",function(o){o.stopPropagation()}),this._overlayId=n.add(e,"context-pad",r);var a=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:a}),a};It.prototype.close=function(){!this.isOpen()||(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)};It.prototype.isOpen=function(e){return!!this._current&&(e?this._current.element===e:!0)};function l_(e,t){var n=ze(e),i=he(t)?t:t.split(/\s+/g);i.forEach(function(r){n.add(r)})}var p_={__depends__:[kr,Wu],contextPad:["type",It]},f_=["marker-start","marker-mid","marker-end"],h_=["circle","ellipse","line","path","polygon","polyline","rect"];function hi(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var r=this;t.on("drag.cleanup",function(){A(r._clonedMarkers,function(a){ke(a)}),r._clonedMarkers={}})}hi.$inject=["elementRegistry","eventBus","canvas","styles"];hi.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)};hi.prototype.addDragger=function(e,t,n){n=n||this.getGfx(e);var i=xh(n),r=n.getBoundingClientRect();return this._cloneMarkers(to(i)),H(i,this._styles.cls("djs-dragger",[],{x:r.top,y:r.left})),ne(t,i),i};hi.prototype.addFrame=function(e,t){var n=J("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return ne(t,n),n};hi.prototype._cloneMarkers=function(e){var t=this;if(e.childNodes)for(var n=0;n<e.childNodes.length;n++)t._cloneMarkers(e.childNodes[n]);!g_(e)||f_.forEach(function(i){if(H(e,i)){var r=d_(e,i,t._canvas.getContainer());t._cloneMarker(e,r,i)}})};hi.prototype._cloneMarker=function(e,t,n){var i=t.id,r=this._clonedMarkers[i];if(!r){r=xh(t);var a=i+"-clone";r.id=a,fe(r).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=r;var o=Oe("defs",this._canvas._svg);o||(o=J("defs"),ne(this._canvas._svg,o)),ne(o,r)}var s=v_(this._clonedMarkers[i].id);H(e,n,s)};function d_(e,t,n){var i=m_(H(e,t));return Oe("marker#"+i,n||document)}function m_(e){return e.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]}function v_(e){return"url(#"+e+")"}function g_(e){return h_.indexOf(e.nodeName)!==-1}var jr={__init__:["previewSupport"],previewSupport:["type",hi]},y_="drop-ok",Rp="drop-not-ok",Pp="attach-ok",Dp="new-parent",Mp="create",E_=2e3;function em(e,t,n,i,r){function a(u,c,l,p,h){if(!c)return!1;u=se(u,function(P){var w=P.labelTarget;return!P.parent&&!(b_(P)&&u.indexOf(w)!==-1)});var f=_e(u,function(P){return!hr(P)}),d=!1,y=!1,x=!1;Op(u)&&(d=r.allowed("shape.attach",{position:l,shape:f,target:c})),d||(Op(u)?x=r.allowed("shape.create",{position:l,shape:f,source:p,target:c}):x=r.allowed("elements.create",{elements:u,position:l,target:c}));var M=h.connectionTarget;return x||d?(f&&p&&(y=r.allowed("connection.create",{source:M===p?f:p,target:M===p?p:f,hints:{targetParent:c,targetAttach:d}})),{attach:d,connect:y}):x===null||d===null?null:!1}function o(u,c){[Pp,y_,Rp,Dp].forEach(function(l){l===c?e.addMarker(u,l):e.removeMarker(u,l)})}n.on(["create.move","create.hover"],function(u){var c=u.context,l=c.elements,p=u.hover,h=c.source,f=c.hints||{};if(!p){c.canExecute=!1,c.target=null;return}Bp(u);var d={x:u.x,y:u.y},y=c.canExecute=p&&a(l,p,d,h,f);p&&y!==null&&(c.target=p,y&&y.attach?o(p,Pp):o(p,y?Dp:Rp))}),n.on(["create.end","create.out","create.cleanup"],function(u){var c=u.hover;c&&o(c,null)}),n.on("create.end",function(u){var c=u.context,l=c.source,p=c.shape,h=c.elements,f=c.target,d=c.canExecute,y=d&&d.attach,x=d&&d.connect,M=c.hints||{};if(d===!1||!f)return!1;Bp(u);var P={x:u.x,y:u.y};x?p=i.appendShape(l,p,P,f,{attach:y,connection:x===!0?{}:x,connectionTarget:M.connectionTarget}):(h=i.createElements(h,P,f,I({},M,{attach:y})),p=_e(h,function(w){return!hr(w)})),I(c,{elements:h,shape:p}),I(u,{elements:h,shape:p})});function s(){var u=t.context();u&&u.prefix===Mp&&t.cancel()}n.on("create.init",function(){n.on("elements.changed",s),n.once(["create.cancel","create.end"],E_,function(){n.off("elements.changed",s)})}),this.start=function(u,c,l){he(c)||(c=[c]);var p=_e(c,function(f){return!hr(f)});if(!!p){l=I({elements:c,hints:{},shape:p},l||{}),A(c,function(f){ae(f.x)||(f.x=0),ae(f.y)||(f.y=0)});var h=et(c);A(c,function(f){hr(f)&&(f.waypoints=Ye(f.waypoints,function(d){return{x:d.x-h.x-h.width/2,y:d.y-h.y-h.height/2}})),I(f,{x:f.x-h.x-h.width/2,y:f.y-h.y-h.height/2})}),t.init(u,Mp,{cursor:"grabbing",autoActivate:!0,data:{shape:p,elements:c,context:l}})}}}em.$inject=["canvas","dragging","eventBus","modeling","rules"];function Bp(e){var t=e.context,n=t.createConstraints;!n||(n.left&&(e.x=Math.max(e.x,n.left)),n.right&&(e.x=Math.min(e.x,n.right)),n.top&&(e.y=Math.max(e.y,n.top)),n.bottom&&(e.y=Math.min(e.y,n.bottom)))}function hr(e){return!!e.waypoints}function Op(e){return e&&e.length===1&&!hr(e[0])}function b_(e){return!!e.labelTarget}var x_=750;function tm(e,t,n,i,r){function a(o){var s=J("g");H(s,r.cls("djs-drag-group",["no-events"]));var u=J("g");return o.forEach(function(c){var l;c.hidden||(c.waypoints?(l=n._createContainer("connection",u),n.drawConnection(to(l),c)):(l=n._createContainer("shape",u),n.drawShape(to(l),c),mt(l,c.x,c.y)),i.addDragger(c,s,l))}),s}t.on("create.move",x_,function(o){var s=o.hover,u=o.context,c=u.elements,l=u.dragGroup;l||(l=u.dragGroup=a(c));var p;s?(l.parentNode||(p=e.getActiveLayer(),ne(p,l)),mt(l,o.x,o.y)):ke(l)}),t.on("create.cleanup",function(o){var s=o.context,u=s.dragGroup;u&&ke(u)})}tm.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];var Bo={__depends__:[wn,jr,cn,sn],__init__:["create","createPreview"],create:["type",em],createPreview:["type",tm]},nm="data-id",im=["contextPad.close","canvas.viewbox.changing","commandStack.changed"],__=1e3;function $e(e,t,n){var i=tn(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=t,this._canvas=n,this._providers={},this._current={}}$e.$inject=["config.popupMenu","eventBus","canvas"];$e.prototype.registerProvider=function(e,t,n){n||(n=t,t=__),this._eventBus.on("popupMenu.getProviders."+e,t,function(i){i.providers.push(n)})};$e.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var n=this._getProviders(t);if(!n)return!0;var i=this._getEntries(e,n),r=this._getHeaderEntries(e,n),a=_r(i)>0,o=r&&_r(r)>0;return!a&&!o};$e.prototype.open=function(e,t,n){var i=this._getProviders(t);if(!e)throw new Error("Element is missing");if(!i||!i.length)throw new Error("No registered providers for: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var r=this._current={className:t,element:e,position:n},a=this._getEntries(e,i),o=this._getHeaderEntries(e,i);r.entries=I({},a,o),r.container=this._createContainer(),_r(o)&&r.container.appendChild(this._createEntries(o,"djs-popup-header")),_r(a)&&r.container.appendChild(this._createEntries(a,"djs-popup-body"));var s=this._canvas,u=s.getContainer();this._attachContainer(r.container,u,n.cursor),this._bindAutoClose()};$e.prototype.close=function(){!this.isOpen()||(this._emit("close"),this._unbindAutoClose(),on(this._current.container),this._current.container=null)};$e.prototype.isOpen=function(){return!!this._current.container};$e.prototype.trigger=function(e){e.preventDefault();var t=e.delegateTarget||e.target,n=St(t,nm),i=this._getEntry(n);if(i.action)return i.action.call(null,e,i)};$e.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers};$e.prototype._getEntries=function(e,t){var n={};return A(t,function(i){if(!i.getPopupMenuEntries){A(i.getEntries(e),function(a){var o=a.id;if(!o)throw new Error("every entry must have the id property set");n[o]=$n(a,["id"])});return}var r=i.getPopupMenuEntries(e);ot(r)?n=r(n):A(r,function(a,o){n[o]=a})}),n};$e.prototype._getHeaderEntries=function(e,t){var n={};return A(t,function(i){if(!i.getPopupMenuHeaderEntries){if(!i.getHeaderEntries)return;A(i.getHeaderEntries(e),function(a){var o=a.id;if(!o)throw new Error("every entry must have the id property set");n[o]=$n(a,["id"])});return}var r=i.getPopupMenuHeaderEntries(e);ot(r)?n=r(n):A(r,function(a,o){n[o]=a})}),n};$e.prototype._getEntry=function(e){var t=this._current.entries[e];if(!t)throw new Error("entry not found");return t};$e.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)};$e.prototype._createContainer=function(){var e=Ae('<div class="djs-popup">'),t=this._current.position,n=this._current.className;return I(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),ze(e).add(n),e};$e.prototype._attachContainer=function(e,t,n){var i=this;xt.bind(e,".entry","click",function(r){i.trigger(r)}),this._updateScale(e),t.appendChild(e),n&&this._assureIsInbounds(e,n)};$e.prototype._updateScale=function(e){var t=this._canvas.zoom(),n=this._config.scale,i,r,a=t;n!==!0&&(n===!1?(i=1,r=1):(i=n.min,r=n.max),tn(i)&&t<i&&(a=i),tn(r)&&t>r&&(a=r)),w_(e,"scale("+a+")")};$e.prototype._assureIsInbounds=function(e,t){var n=this._canvas,i=n._container.getBoundingClientRect(),r=e.offsetLeft,a=e.offsetTop,o=e.scrollWidth,s=e.scrollHeight,u={},c,l,p={x:t.x-i.left,y:t.y-i.top};r+o>i.width&&(u.x=!0),a+s>i.height&&(u.y=!0),u.x&&u.y?(c=p.x-o+"px",l=p.y-s+"px"):u.x?(c=p.x-o+"px",l=p.y+"px"):u.y&&p.y<s?(c=p.x+"px",l=10+"px"):u.y&&(c=p.x+"px",l=p.y-s+"px"),I(e.style,{left:c,top:l},{visibility:"visible","z-index":1e3})};$e.prototype._createEntries=function(e,t){var n=Ae("<div>"),i=this;return ze(n).add(t),A(e,function(r,a){var o=i._createEntry(r,a);n.appendChild(o)}),n};$e.prototype._createEntry=function(e,t){var n=Ae("<div>"),i=ze(n);if(i.add("entry"),e.className&&e.className.split(" ").forEach(function(a){i.add(a)}),St(n,nm,t),e.label){var r=Ae("<span>");r.textContent=e.label,n.appendChild(r)}return e.imageUrl&&n.appendChild(Ae('<img src="'+e.imageUrl+'" />')),e.active===!0&&i.add("active"),e.disabled===!0&&i.add("disabled"),e.title&&(n.title=e.title),n};$e.prototype._bindAutoClose=function(){this._eventBus.once(im,this.close,this)};$e.prototype._unbindAutoClose=function(){this._eventBus.off(im,this.close,this)};function w_(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}var S_={__init__:["popupMenu"],popupMenu:["type",$e]};function Hr(){}Hr.prototype.get=function(){return this._data};Hr.prototype.set=function(e){this._data=e};Hr.prototype.clear=function(){var e=this._data;return delete this._data,e};Hr.prototype.isEmpty=function(){return!this._data};var C_={clipboard:["type",Hr]};function tc(e){var t=this;this._lastMoveEvent=null;function n(i){t._lastMoveEvent=i}e.on("canvas.init",function(i){var r=t._svg=i.svg;r.addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}tc.$inject=["eventBus"];tc.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||T_(0,0)};function T_(e,t){var n=document.createEvent("MouseEvent"),i=e,r=t,a=e,o=t;return n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,r,a,o,!1,!1,!1,!1,0,null),n}var zr={__init__:["mouse"],mouse:["type",tc]};function qt(e,t,n,i,r,a,o,s){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=r,this._modeling=a,this._mouse=o,this._rules=s,r.on("copyPaste.copyElement",function(u){var c=u.descriptor,l=u.element,p=u.elements;c.priority=1,c.id=l.id;var h=_e(p,function(f){return f===l.parent});h&&(c.parent=l.parent.id),A_(l)&&(c.priority=2,c.host=l.host.id),Oo(l)&&(c.priority=3,c.source=l.source.id,c.target=l.target.id,c.waypoints=R_(l)),Io(l)&&(c.priority=4,c.labelTarget=l.labelTarget.id),A(["x","y","width","height"],function(f){ae(l[f])&&(c[f]=l[f])}),c.hidden=l.hidden,c.collapsed=l.collapsed}),r.on("copyPaste.pasteElements",function(u){var c=u.hints;I(c,{createElementsBehavior:!1})})}qt.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"];qt.prototype.copy=function(e){var t,n;return he(e)||(e=e?[e]:[]),t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}),t===!1?n={}:n=this.createTree(he(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n};qt.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}};qt.prototype._paste=function(e,t,n,i){A(e,function(a){ae(a.x)||(a.x=0),ae(a.y)||(a.y=0)});var r=et(e);return A(e,function(a){Oo(a)&&(a.waypoints=Ye(a.waypoints,function(o){return{x:o.x-r.x-r.width/2,y:o.y-r.y-r.height/2}})),I(a,{x:a.x-r.x-r.width/2,y:a.y-r.y-r.height/2})}),this._modeling.createElements(e,n,t,I({},i))};qt.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},r=[];return A(e,function(a,o){a=Vt(a,"priority"),A(a,function(s){var u=I({},$n(s,["priority"]));i[s.parent]?u.parent=i[s.parent]:delete u.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:u});var c;if(Oo(u)){u.source=i[s.source],u.target=i[s.target],c=i[s.id]=t.createConnection(u),r.push(c);return}if(Io(u)){u.labelTarget=i[u.labelTarget],c=i[s.id]=t.createLabel(u),r.push(c);return}u.host&&(u.host=i[u.host]),c=i[s.id]=t.createShape(u),r.push(c)})}),r};qt.prototype.createConnection=function(e){var t=this._elementFactory.createConnection($n(e,["id"]));return t};qt.prototype.createLabel=function(e){var t=this._elementFactory.createLabel($n(e,["id"]));return t};qt.prototype.createShape=function(e){var t=this._elementFactory.createShape($n(e,["id"]));return t};qt.prototype.hasRelations=function(e,t){var n,i,r;return!(Oo(e)&&(i=_e(t,Gt({id:e.source.id})),r=_e(t,Gt({id:e.target.id})),!i||!r)||Io(e)&&(n=_e(t,Gt({id:e.labelTarget.id})),!n))};qt.prototype.createTree=function(e){var t=this._rules,n=this,i={},r=[],a=Ch(e);function o(c,l){return t.allowed("element.copy",{element:c,elements:l})}function s(c,l){var p=_e(r,function(h){return c===h.element});if(!p){r.push({element:c,depth:l});return}p.depth<l&&(r=u(p,r),r.push({element:p.element,depth:l}))}function u(c,l){var p=l.indexOf(c);return p!==-1&&l.splice(p,1),l}return pi(a,function(c,l,p){if(Io(c))return;A(c.labels,function(f){s(f,p)});function h(f){f&&f.length&&A(f,function(d){A(d.labels,function(y){s(y,p)}),s(d,p)})}return A([c.attachers,c.incoming,c.outgoing],h),s(c,p),c.children}),e=Ye(r,function(c){return c.element}),r=Ye(r,function(c){return c.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:c.descriptor,element:c.element,elements:e}),c}),r=Vt(r,function(c){return c.descriptor.priority}),e=Ye(r,function(c){return c.element}),A(r,function(c){var l=c.depth;if(!n.hasRelations(c.element,e)){Np(c.element,e);return}if(!o(c.element,e)){Np(c.element,e);return}i[l]||(i[l]=[]),i[l].push(c.descriptor)}),i};function A_(e){return!!e.host}function Oo(e){return!!e.waypoints}function Io(e){return!!e.labelTarget}function R_(e){return Ye(e.waypoints,function(t){return t=Ip(t),t.original&&(t.original=Ip(t.original)),t})}function Ip(e){return I({},e)}function Np(e,t){var n=t.indexOf(e);return n===-1?t:t.splice(n,1)}var P_={__depends__:[C_,Bo,zr,cn],__init__:["copyPaste"],copyPaste:["type",qt]};function xa(e,t,n){he(n)||(n=[n]),A(n,function(i){Dr(e[i])||(t[i]=e[i])})}function D_(e,t){he(t)||(t=[t]),A(t,function(n){e[n]&&delete e[n]})}var M_=750;function rm(e,t,n){t.on("copyPaste.copyElement",M_,function(a){var o=a.descriptor,s=a.element,u=o.oldBusinessObject=Y(s);if(o.type=s.type,xa(u,o,"name"),o.di={},xa(u.di,o.di,["fill","stroke","background-color","border-color","color"]),xa(u.di,o,"isExpanded"),Fp(o))return o;u.default&&(o.default=u.default.id)}),t.on("moddleCopy.canCopyProperty",function(a){var o=a.parent,s=a.property,u=a.propertyName,c;if(u==="processRef"&&v(o,"bpmn:Participant")&&v(s,"bpmn:Process"))return c=e.create("bpmn:Process"),n.copyElement(s,c)});var i;function r(a,o){var s=Y(a);a.default&&(i[a.default]={element:s,property:"default"}),a.host&&(Y(a).attachedToRef=Y(o[a.host])),i=$n(i,wt(i,function(u,c,l){var p=c.element,h=c.property;return l===a.id&&(p[h]=s,u.push(a.id)),u},[]))}t.on("copyPaste.pasteElements",function(){i={}}),t.on("copyPaste.pasteElement",function(a){var o=a.cache,s=a.descriptor,u=s.oldBusinessObject,c;if(Fp(s)){s.businessObject=Y(o[s.labelTarget]);return}c=e.create(u.$type),s.businessObject=n.copyElement(u,c),r(s,o),xa(s,c,["isExpanded","name"]),D_(s,"oldBusinessObject")})}rm.$inject=["bpmnFactory","eventBus","moddleCopy"];function Fp(e){return!!e.labelTarget}var B_=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function Gr(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",function(i){var r=i.propertyNames;if(!(!r||!r.length))return Vt(r,function(a){return a==="extensionElements"})}),e.on("moddleCopy.canCopyProperty",function(i){var r=i.parent,a=Qe(r)&&r.$descriptor,o=i.propertyName;if(o&&B_.indexOf(o)!==-1||o&&a&&!_e(a.properties,Gt({name:o})))return!1}),e.on("moddleCopy.canSetCopiedProperty",function(i){var r=i.property;if(O_(r,"bpmn:ExtensionElements")&&(!r.values||!r.values.length))return!1})}Gr.$inject=["eventBus","bpmnFactory","moddle"];Gr.prototype.copyElement=function(e,t,n){var i=this;n&&!he(n)&&(n=[n]),n=n||uu(e.$descriptor);var r=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t});return r===!1||(he(r)&&(n=r),A(n,function(a){var o;mn(e,a)&&(o=e.get(a));var s=i.copyProperty(o,t,a),u=i._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:s,propertyName:a});u!==!1&&tn(s)&&t.set(a,s)})),t};Gr.prototype.copyProperty=function(e,t,n){var i=this,r=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n});if(r!==!1){if(r)return Qe(r)&&r.$type&&!r.$parent&&(r.$parent=t),r;var a=this._moddle.getPropertyDescriptor(t,n);if(!a.isReference)return a.isId?this._copyId(e,t):he(e)?wt(e,function(o,s){return r=i.copyProperty(s,t,n),r?(r.$parent=t,o.concat(r)):o},[]):Qe(e)&&e.$type?this._moddle.getElementDescriptor(e).isGeneric?void 0:(r=i._bpmnFactory.create(e.$type),r.$parent=t,r=i.copyElement(e,r),r):e}};Gr.prototype._copyId=function(e,t){if(!this._moddle.ids.assigned(e))return this._moddle.ids.claim(e,t),e};function uu(e,t){return wt(e.properties,function(n,i){return t&&i.default?n:n.concat(i.name)},[])}function O_(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}var am={__depends__:[P_],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",rm],moddleCopy:["type",Gr]},kp=Math.round;function nc(e){this._modeling=e}nc.$inject=["modeling"];nc.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,r=t.width||e.width,a=t.height||e.height,o=t.x||e.x,s=t.y||e.y,u=kp(o+r/2),c=kp(s+a/2);return i.replaceShape(e,I({},t,{x:u,y:c,width:r,height:a}),n)};var I_={__init__:["replace"],replace:["type",nc]};function N_(e,t,n){he(n)||(n=[n]),A(n,function(i){Dr(e[i])||(t[i]=e[i])})}var F_=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function k_(e,t){var n=e&&mn(e,"collapsed")?e.collapsed:!Se(e),i;return t&&(mn(t,"collapsed")||mn(t,"isExpanded"))?i=mn(t,"collapsed")?t.collapsed:!t.isExpanded:i=n,n!==i?(e.collapsed=n,!0):!1}function om(e,t,n,i,r,a,o){function s(u,c,l){l=l||{};var p=c.type,h=u.businessObject;if(_a(h)&&p==="bpmn:SubProcess"&&k_(u,c))return i.toggleCollapse(u),u;var f=e.create(p),d={type:p,businessObject:f},y=uu(h.$descriptor),x=uu(f.$descriptor,!0),M=L_(y,x);I(f,Wt(c,F_));var P=se(M,function(w){return w==="eventDefinitions"?Lp(u,c.eventDefinitionType):w==="loopCharacteristics"?!_t(f):!(mn(f,w)||w==="processRef"&&c.isExpanded===!1||w==="triggeredByEvent")});return f=n.copyElement(h,f,P),c.eventDefinitionType&&(Lp(f,c.eventDefinitionType)||(d.eventDefinitionType=c.eventDefinitionType,d.eventDefinitionAttrs=c.eventDefinitionAttrs)),v(h,"bpmn:Activity")&&(_a(h)?d.isExpanded=Se(h):c&&mn(c,"isExpanded")&&(d.isExpanded=c.isExpanded),Se(h)&&!v(h,"bpmn:Task")&&d.isExpanded&&(d.width=u.width,d.height=u.height)),_a(h)&&!_a(f)&&(l.moveChildren=!1),v(h,"bpmn:Participant")&&(c.isExpanded===!0?f.processRef=e.create("bpmn:Process"):l.moveChildren=!1,d.width=u.width,d.height=t._getDefaultSize(f).height),a.allowed("shape.resize",{shape:f})||(d.height=t._getDefaultSize(f).height,d.width=t._getDefaultSize(f).width),f.name=h.name,ye(h,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&ye(f,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(f.default=h.default),c.host&&!v(h,"bpmn:BoundaryEvent")&&v(f,"bpmn:BoundaryEvent")&&(d.host=c.host),(d.type==="bpmn:DataStoreReference"||d.type==="bpmn:DataObjectReference")&&(d.x=u.x+(u.width-d.width)/2),d.di={},N_(h.di,d.di,["fill","stroke","background-color","border-color","color"]),d=r.replaceElement(u,d,l),l.select!==!1&&o.select(d),d}this.replaceElement=s}om.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules","selection"];function _a(e){return v(e,"bpmn:SubProcess")}function Lp(e,t){var n=Y(e);return t&&n.get("eventDefinitions").some(function(i){return v(i,t)})}function L_(e,t){return e.filter(function(n){return t.indexOf(n)!==-1})}var sm={__depends__:[am,I_,sn],bpmnReplace:["type",om]};function $p(e){return function(t){var n=t.target,i=Y(e),r=i.eventDefinitions&&i.eventDefinitions[0],a=i.$type===n.type,o=(r&&r.$type)===n.eventDefinitionType,s=i.triggeredByEvent===n.triggeredByEvent,u=n.isExpanded===void 0||n.isExpanded===Se(i);return!a||!o||!s||!u}}var $_=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],j_=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],H_=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],z_=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],G_=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],V_=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],W_=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],U_=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],jp=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],Y_=[{label:"Data Store Reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],q_=[{label:"Data Object Reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],K_=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],X_=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],Z_=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],J_=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty Pool";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];function Nt(e,t,n,i,r,a,o){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=r,this._rules=a,this._translate=o,this.register()}Nt.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate"];Nt.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)};Nt.prototype.getEntries=function(e){var t=e.businessObject,n=this._rules,i;if(!n.allowed("shape.replace",{element:e}))return[];var r=$p(e);return v(t,"bpmn:DataObjectReference")?this._createEntries(e,Y_):v(t,"bpmn:DataStoreReference")&&!v(e.parent,"bpmn:Collaboration")?this._createEntries(e,q_):v(t,"bpmn:StartEvent")&&!v(t.$parent,"bpmn:SubProcess")?(i=se($_,r),this._createEntries(e,i)):v(t,"bpmn:Participant")?(i=se(J_,function(a){return Se(t)!==a.target.isExpanded}),this._createEntries(e,i)):v(t,"bpmn:StartEvent")&&_t(t.$parent)?(i=se(X_,function(a){var o=a.target,s=o.isInterrupting!==!1,u=Y(e).isInterrupting===s;return r(a)||!r(a)&&!u}),this._createEntries(e,i)):v(t,"bpmn:StartEvent")&&!_t(t.$parent)&&v(t.$parent,"bpmn:SubProcess")?(i=se(j_,r),this._createEntries(e,i)):v(t,"bpmn:EndEvent")?(i=se(z_,function(a){var o=a.target;return o.eventDefinitionType=="bpmn:CancelEventDefinition"&&!v(t.$parent,"bpmn:Transaction")?!1:r(a)}),this._createEntries(e,i)):v(t,"bpmn:BoundaryEvent")?(i=se(K_,function(a){var o=a.target;if(o.eventDefinitionType=="bpmn:CancelEventDefinition"&&!v(t.attachedToRef,"bpmn:Transaction"))return!1;var s=o.cancelActivity!==!1,u=t.cancelActivity==s;return r(a)||!r(a)&&!u}),this._createEntries(e,i)):v(t,"bpmn:IntermediateCatchEvent")||v(t,"bpmn:IntermediateThrowEvent")?(i=se(H_,r),this._createEntries(e,i)):v(t,"bpmn:Gateway")?(i=se(G_,r),this._createEntries(e,i)):v(t,"bpmn:Transaction")?(i=se(W_,r),this._createEntries(e,i)):_t(t)&&Se(t)?(i=se(U_,r),this._createEntries(e,i)):v(t,"bpmn:SubProcess")&&Se(t)?(i=se(V_,r),this._createEntries(e,i)):v(t,"bpmn:AdHocSubProcess")&&!Se(t)?(i=se(jp,function(a){var o=a.target,s=o.type==="bpmn:SubProcess",u=o.isExpanded===!0;return $p(e)&&(!s||u)}),this._createEntries(e,i)):v(t,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,Z_):v(t,"bpmn:FlowNode")?(i=se(jp,r),v(t,"bpmn:SubProcess")&&!Se(t)&&(i=se(i,function(a){return a.label!=="Sub Process (collapsed)"})),this._createEntries(e,i)):[]};Nt.prototype.getHeaderEntries=function(e){var t=[];return v(e,"bpmn:Activity")&&!_t(e)&&(t=t.concat(this._getLoopEntries(e))),v(e,"bpmn:DataObjectReference")&&(t=t.concat(this._getDataObjectIsCollection(e))),v(e,"bpmn:Participant")&&(t=t.concat(this._getParticipantMultiplicity(e))),v(e,"bpmn:SubProcess")&&!v(e,"bpmn:Transaction")&&!_t(e)&&t.push(this._getAdHocEntry(e)),t};Nt.prototype._createEntries=function(e,t){var n=[],i=this;return A(t,function(r){var a=i._createMenuEntry(r,e);n.push(a)}),n};Nt.prototype._createSequenceFlowEntries=function(e,t){var n=Y(e),i=[],r=this._modeling,a=this._moddle,o=this;return A(t,function(s){switch(s.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(v(n.sourceRef,"bpmn:ExclusiveGateway")||v(n.sourceRef,"bpmn:InclusiveGateway")||v(n.sourceRef,"bpmn:ComplexGateway")||v(n.sourceRef,"bpmn:Activity"))&&i.push(o._createMenuEntry(s,e,function(){r.updateProperties(e.source,{default:n})}));break;case"replace-with-conditional-flow":!n.conditionExpression&&v(n.sourceRef,"bpmn:Activity")&&i.push(o._createMenuEntry(s,e,function(){var u=a.create("bpmn:FormalExpression",{body:""});r.updateProperties(e,{conditionExpression:u})}));break;default:if(v(n.sourceRef,"bpmn:Activity")&&n.conditionExpression)return i.push(o._createMenuEntry(s,e,function(){r.updateProperties(e,{conditionExpression:void 0})}));if((v(n.sourceRef,"bpmn:ExclusiveGateway")||v(n.sourceRef,"bpmn:InclusiveGateway")||v(n.sourceRef,"bpmn:ComplexGateway")||v(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n)return i.push(o._createMenuEntry(s,e,function(){r.updateProperties(e.source,{default:void 0})}))}}),i};Nt.prototype._createMenuEntry=function(e,t,n){var i=this._translate,r=this._bpmnReplace.replaceElement,a=function(){return r(t,e.target)},o=e.label;o&&typeof o=="function"&&(o=o(t)),n=n||a;var s={label:i(o),className:e.className,id:e.actionName,action:n};return s};Nt.prototype._getLoopEntries=function(e){var t=this,n=this._translate;function i(l,p){var h;p.active?h=void 0:(h=t._moddle.create(p.options.loopCharacteristics),p.options.isSequential&&(h.isSequential=p.options.isSequential)),t._modeling.updateProperties(e,{loopCharacteristics:h})}var r=Y(e),a=r.loopCharacteristics,o,s,u;a&&(o=a.isSequential,s=a.isSequential===void 0,u=a.isSequential!==void 0&&!a.isSequential);var c=[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:n("Parallel Multi Instance"),active:u,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:n("Sequential Multi Instance"),active:o,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:n("Loop"),active:s,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}];return c};Nt.prototype._getDataObjectIsCollection=function(e){var t=this,n=this._translate;function i(s,u){t._modeling.updateModdleProperties(e,r,{isCollection:!u.active})}var r=e.businessObject.dataObjectRef,a=r.isCollection,o=[{id:"toggle-is-collection",className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:a,action:i}];return o};Nt.prototype._getParticipantMultiplicity=function(e){var t=this,n=this._bpmnFactory,i=this._translate;function r(s,u){var c=u.active,l;c||(l=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:l})}var a=e.businessObject.participantMultiplicity,o=[{id:"toggle-participant-multiplicity",className:"bpmn-icon-parallel-mi-marker",title:i("Participant Multiplicity"),active:!!a,action:r}];return o};Nt.prototype._getAdHocEntry=function(e){var t=this._translate,n=Y(e),i=v(n,"bpmn:AdHocSubProcess"),r=this._bpmnReplace.replaceElement,a={id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(o,s){return i?r(e,{type:"bpmn:SubProcess"},{autoResize:!1,layoutConnection:!1}):r(e,{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}};return a};var Q_={__depends__:[S_,sm],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",Nt]},ro=Math.max,ao=Math.min,ew=20;function um(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function tw(e,t,n){var i=n.x,r=n.y,a={x:e.x,y:e.y,width:e.width,height:e.height};return t.indexOf("n")!==-1?(a.y=e.y+r,a.height=e.height-r):t.indexOf("s")!==-1&&(a.height=e.height+r),t.indexOf("e")!==-1?a.width=e.width+i:t.indexOf("w")!==-1&&(a.x=e.x+i,a.width=e.width-i),a}function nw(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function wa(e,t,n){var i=t[e],r=n.min&&n.min[e],a=n.max&&n.max[e];return ae(r)&&(i=(/top|left/.test(e)?ao:ro)(i,r)),ae(a)&&(i=(/top|left/.test(e)?ro:ao)(i,a)),i}function iw(e,t){if(!t)return e;var n=ee(e);return Iu({top:wa("top",n,t),right:wa("right",n,t),bottom:wa("bottom",n,t),left:wa("left",n,t)})}function rw(e,t,n,i){var r=ee(t),a={top:/n/.test(e)?r.bottom-n.height:r.top,left:/w/.test(e)?r.right-n.width:r.left,bottom:/s/.test(e)?r.top+n.height:r.bottom,right:/e/.test(e)?r.left+n.width:r.right},o=i?ee(i):a,s={top:ao(a.top,o.top),left:ao(a.left,o.left),bottom:ro(a.bottom,o.bottom),right:ro(a.right,o.right)};return Iu(s)}function ur(e,t){return typeof e!="undefined"?e:ew}function aw(e,t){var n,i,r,a;return typeof t=="object"?(n=ur(t.left),i=ur(t.right),r=ur(t.top),a=ur(t.bottom)):n=i=r=a=ur(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+a}}function ow(e){return!(e.waypoints||e.type==="label")}function cm(e,t){var n;if(e.length===void 0?n=se(e.children,ow):n=e,n.length)return aw(et(n),t)}var Sa=Math.abs;function sw(e,t){return um(ee(t),ee(e))}var uw=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],Ti=30;function No(e,t){return t=t||[],e.children.filter(function(n){v(n,"bpmn:Lane")&&(No(n,t),t.push(n))}),t}function di(e){return e.children.filter(function(t){return v(t,"bpmn:Lane")})}function zt(e){return no(e,uw)||e}function cw(e,t){var n=zt(e),i=v(n,"bpmn:Process")?[]:[n],r=No(n,i),a=ee(e),o=ee(t),s=sw(e,t),u=[];return r.forEach(function(c){if(c!==e){var l=0,p=s.right,h=0,f=s.left,d=ee(c);s.top&&(Sa(d.bottom-a.top)<10&&(h=o.top-d.bottom),Sa(d.top-a.top)<5&&(l=o.top-d.top)),s.bottom&&(Sa(d.top-a.bottom)<10&&(l=o.bottom-d.top),Sa(d.bottom-a.bottom)<5&&(h=o.bottom-d.bottom)),(l||p||h||f)&&u.push({shape:c,newBounds:nw(c,{top:l,right:p,bottom:h,left:f})})}}),u}function ic(e,t,n,i,r,a,o,s,u,c,l,p){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=r,this._elementFactory=a,this._connect=o,this._create=s,this._popupMenu=u,this._canvas=c,this._rules=l,this._translate=p,e.autoPlace!==!1&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(h){var f=h.context,d=f.shape;if(!(!Oi(h)||!i.isOpen(d))){var y=i.getEntries(d);y.replace&&y.replace.action.click(h,d)}})}ic.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"];ic.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,r=this._connect,a=this._create,o=this._popupMenu,s=this._canvas,u=this._rules,c=this._autoPlace,l=this._translate,p={};if(e.type==="label")return p;var h=e.businessObject;function f(b,_){r.start(b,_)}function d(b){n.removeElements([e])}function y(b){var _=5,D=s.getContainer(),B=t.getPad(b).html,R=D.getBoundingClientRect(),L=B.getBoundingClientRect(),z=L.top-R.top,q=L.left-R.left,W={x:q,y:z+L.height+_};return W}function x(b,_,D,B){typeof D!="string"&&(B=D,D=l("Append {type}",{type:b.replace(/^bpmn:/,"")}));function R(z,q){var W=i.createShape(I({type:b},B));a.start(z,W,{source:q})}var L=c?function(z,q){var W=i.createShape(I({type:b},B));c.append(q,W)}:R;return{group:"model",className:_,title:D,action:{dragstart:R,click:L}}}function M(b){return function(_,D){n.splitLane(D,b),t.open(D,!0)}}if(ye(h,["bpmn:Lane","bpmn:Participant"])&&Se(h)){var P=di(e);I(p,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:l("Add Lane above"),action:{click:function(b,_){n.addLane(_,"top")}}}}),P.length<2&&(e.height>=120&&I(p,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:l("Divide into two Lanes"),action:{click:M(2)}}}),e.height>=180&&I(p,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:l("Divide into three Lanes"),action:{click:M(3)}}})),I(p,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:l("Add Lane below"),action:{click:function(b,_){n.addLane(_,"bottom")}}}})}v(h,"bpmn:FlowNode")&&(v(h,"bpmn:EventBasedGateway")?I(p,{"append.receive-task":x("bpmn:ReceiveTask","bpmn-icon-receive-task",l("Append ReceiveTask")),"append.message-intermediate-event":x("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",l("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":x("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",l("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":x("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",l("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":x("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",l("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):Hp(h,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?I(p,{"append.compensation-activity":x("bpmn:Task","bpmn-icon-task",l("Append compensation activity"),{isForCompensation:!0})}):!v(h,"bpmn:EndEvent")&&!h.isForCompensation&&!Hp(h,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")&&!_t(h)&&I(p,{"append.end-event":x("bpmn:EndEvent","bpmn-icon-end-event-none",l("Append EndEvent")),"append.gateway":x("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",l("Append Gateway")),"append.append-task":x("bpmn:Task","bpmn-icon-task",l("Append Task")),"append.intermediate-event":x("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",l("Append Intermediate/Boundary Event"))})),o.isEmpty(e,"bpmn-replace")||I(p,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:l("Change type"),action:{click:function(b,_){var D=I(y(_),{cursor:{x:b.x,y:b.y}});o.open(_,"bpmn-replace",D)}}}}),ye(h,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&I(p,{"append.text-annotation":x("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using "+(h.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:f,dragstart:f}}}),v(h,"bpmn:TextAnnotation")&&I(p,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using Association"),action:{click:f,dragstart:f}}}),ye(h,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&I(p,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using DataInputAssociation"),action:{click:f,dragstart:f}}}),v(h,"bpmn:Group")&&I(p,{"append.text-annotation":x("bpmn:TextAnnotation","bpmn-icon-text-annotation")});var w=u.allowed("elements.delete",{elements:[e]});return he(w)&&(w=w[0]===e),w&&I(p,{delete:{group:"edit",className:"bpmn-icon-trash",title:l("Remove"),action:{click:d}}}),p};function Hp(e,t,n){var i=e.$instanceOf(t),r=!1,a=e.eventDefinitions||[];return A(a,function(o){o.$type===n&&(r=!0)}),i&&r}var lw={__depends__:[Qd,p_,sn,ec,Bo,Q_],__init__:["contextPadProvider"],contextPadProvider:["type",ic]},pw={horizontal:["x","width"],vertical:["y","height"]},zp=5;function Cn(e){this._modeling=e,this._filters=[],this.registerFilter(function(t,n,i){var r=0,a=0,o;return A(t,function(s){s.waypoints||s.labelTarget||(r+=s[i],a+=1)}),o=Math.round(r/a),se(t,function(s){return s[i]<o+50})})}Cn.$inject=["modeling"];Cn.prototype.registerFilter=function(e){if(typeof e!="function")throw new Error("the filter has to be a function");this._filters.push(e)};Cn.prototype.trigger=function(e,t){var n=this._modeling,i,r;if(!(e.length<3)&&(this._setOrientation(t),r=this._filterElements(e),i=this._createGroups(r),!(i.length<=2)))return n.distributeElements(i,this._axis,this._dimension),i};Cn.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,r=[].concat(e);return t.length?(A(t,function(a){r=a(r,n,i)}),r):e};Cn.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,r=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');var a=Vt(e,i);return A(a,function(o,s){var u=n._findRange(o,i,r),c,l=t[t.length-1];l&&n._hasIntersection(l.range,u)?t[t.length-1].elements.push(o):(c={range:u,elements:[o]},t.push(c))}),t};Cn.prototype._setOrientation=function(e){var t=pw[e];this._axis=t[0],this._dimension=t[1]};Cn.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)};Cn.prototype._findRange=function(e){var t=e[this._axis],n=e[this._dimension];return{min:t+zp,max:t+n-zp}};var fw={__init__:["distributeElements"],distributeElements:["type",Cn]};function lm(e){e.registerFilter(function(t){return se(t,function(n){var i=ye(n,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:Participant","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(n.labelTarget||i)})})}lm.$inject=["distributeElements"];var hw={__depends__:[fw],__init__:["bpmnDistributeElements"],bpmnDistributeElements:["type",lm]},pm="is not a registered action",dw="is already registered";function Ft(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}Ft.$inject=["eventBus","injector"];Ft.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),a=e.get("copyPaste",!1),o=e.get("canvas",!1),s=e.get("rules",!1),u=e.get("keyboardMove",!1),c=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),a&&i&&this.register("copy",function(){var l=i.get();a.copy(l)}),a&&this.register("paste",function(){a.paste()}),r&&this.register("stepZoom",function(l){r.stepZoom(l.value)}),o&&this.register("zoom",function(l){o.zoom(l.value)}),n&&i&&s&&this.register("removeSelection",function(){var l=i.get();if(!!l.length){var p=s.allowed("elements.delete",{elements:l}),h;p!==!1&&(he(p)?h=p:h=l,h.length&&n.removeElements(h.slice()))}}),u&&this.register("moveCanvas",function(l){u.moveCanvas(l)}),c&&this.register("moveSelection",function(l){c.moveSelection(l.direction,l.accelerated)})};Ft.prototype.trigger=function(e,t){if(!this._actions[e])throw rc(e,pm);return this._actions[e](t)};Ft.prototype.register=function(e,t){var n=this;if(typeof e=="string")return this._registerAction(e,t);A(e,function(i,r){n._registerAction(r,i)})};Ft.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw rc(e,dw);this._actions[e]=t};Ft.prototype.unregister=function(e){if(!this.isRegistered(e))throw rc(e,pm);this._actions[e]=void 0};Ft.prototype.getActions=function(){return Object.keys(this._actions)};Ft.prototype.isRegistered=function(e){return!!this._actions[e]};function rc(e,t){return new Error(e+" "+t)}var mw={__init__:["editorActions"],editorActions:["type",Ft]};function Fo(e){e.invoke(Ft,this)}Z(Fo,Ft);Fo.$inject=["injector"];Fo.prototype._registerDefaultActions=function(e){Ft.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),r=e.get("spaceTool",!1),a=e.get("lassoTool",!1),o=e.get("handTool",!1),s=e.get("globalConnect",!1),u=e.get("distributeElements",!1),c=e.get("alignElements",!1),l=e.get("directEditing",!1),p=e.get("searchPad",!1),h=e.get("modeling",!1);t&&n&&i&&this._registerAction("selectElements",function(){var f=t.getRootElement(),d=n.filter(function(y){return y!==f});return i.select(d),d}),r&&this._registerAction("spaceTool",function(){r.toggle()}),a&&this._registerAction("lassoTool",function(){a.toggle()}),o&&this._registerAction("handTool",function(){o.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&u&&this._registerAction("distributeElements",function(f){var d=i.get(),y=f.type;d.length&&u.trigger(d,y)}),i&&c&&this._registerAction("alignElements",function(f){var d=i.get(),y=[],x=f.type;d.length&&(y=se(d,function(M){return!v(M,"bpmn:Lane")}),c.trigger(y,x))}),i&&h&&this._registerAction("setColor",function(f){var d=i.get();d.length&&h.setColor(d,f)}),i&&l&&this._registerAction("directEditing",function(){var f=i.get();f.length&&l.activate(f[0])}),p&&this._registerAction("find",function(){p.toggle()}),t&&h&&this._registerAction("moveToOrigin",function(){var f=t.getRootElement(),d,y;v(f,"bpmn:Collaboration")?y=n.filter(function(x){return v(x.parent,"bpmn:Collaboration")}):y=n.filter(function(x){return x!==f&&!v(x.parent,"bpmn:SubProcess")}),d=et(y),h.moveElements(y,{x:-d.x,y:-d.y},f)})};var vw={__depends__:[mw],editorActions:["type",Fo]};function fm(e){e.on(["create.init","shape.move.init"],function(t){var n=t.context,i=t.shape;ye(i,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(n.gridSnappingContext||(n.gridSnappingContext={}),n.gridSnappingContext.snapLocation="top-left")})}fm.$inject=["eventBus"];var Ga=10;function Ts(e,t,n){return n||(n="round"),Math[n](e/t)*t}var gw=1200,yw=800;function Wn(e,t,n){var i=!n||n.active!==!1;this._eventBus=t;var r=this;t.on("diagram.init",yw,function(){r.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],gw,function(a){var o=a.originalEvent;if(!(!r.active||o&&bt(o))){var s=a.context,u=s.gridSnappingContext;u||(u=s.gridSnappingContext={}),["x","y"].forEach(function(c){var l={},p=bw(a,c,e);p&&(l.offset=p);var h=Ew(a,c);h&&I(l,h),Ii(a,c)||r.snapEvent(a,c,l)})}})}Wn.prototype.snapEvent=function(e,t,n){var i=this.snapValue(e[t],n);He(e,t,i)};Wn.prototype.getGridSpacing=function(){return Ga};Wn.prototype.snapValue=function(e,t){var n=0;t&&t.offset&&(n=t.offset),e+=n,e=Ts(e,Ga);var i,r;return t&&t.min&&(i=t.min,ae(i)&&(i=Ts(i+n,Ga,"ceil"),e=Math.max(e,i))),t&&t.max&&(r=t.max,ae(r)&&(r=Ts(r+n,Ga,"floor"),e=Math.min(e,r))),e-=n,e};Wn.prototype.isActive=function(){return this.active};Wn.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})};Wn.prototype.toggleActive=function(){this.setActive(!this.active)};Wn.$inject=["elementRegistry","eventBus","config.gridSnapping"];function Ew(e,t){var n=e.context,i=n.createConstraints,r=n.resizeConstraints||{},a=n.gridSnappingContext,o=a.snapConstraints;if(o&&o[t])return o[t];o||(o=a.snapConstraints={}),o[t]||(o[t]={});var s=n.direction;i&&(Va(t)?(o.x.min=i.left,o.x.max=i.right):(o.y.min=i.top,o.y.max=i.bottom));var u=r.min,c=r.max;return u&&(Va(t)?Vp(s)?o.x.max=u.left:o.x.min=u.right:Gp(s)?o.y.max=u.top:o.y.min=u.bottom),c&&(Va(t)?Vp(s)?o.x.min=c.left:o.x.max=c.right:Gp(s)?o.y.min=c.top:o.y.max=c.bottom),o[t]}function bw(e,t,n){var i=e.context,r=e.shape,a=i.gridSnappingContext,o=a.snapLocation,s=a.snapOffset;return s&&ae(s[t])||(s||(s=a.snapOffset={}),ae(s[t])||(s[t]=0),!r)||(n.get(r.id)||(Va(t)?s[t]+=r[t]+r.width/2:s[t]+=r[t]+r.height/2),!o)||(t==="x"?/left/.test(o)?s[t]-=r.width/2:/right/.test(o)&&(s[t]+=r.width/2):/top/.test(o)?s[t]-=r.height/2:/bottom/.test(o)&&(s[t]+=r.height/2)),s[t]}function Va(e){return e==="x"}function Gp(e){return e.indexOf("n")!==-1}function Vp(e){return e.indexOf("w")!==-1}function mi(e,t){U.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(i){var r=i.context,a=r.hints||{},o=a.autoResize;if(!!o){var s=r.shape,u=r.newBounds;Dt(o)?r.newBounds=n.snapComplex(u,o):r.newBounds=n.snapSimple(s,u)}})}mi.$inject=["eventBus","gridSnapping","modeling"];Z(mi,U);mi.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t};mi.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e};mi.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),r=/e/.test(t),a={};return a.width=n.snapValue(e.width,{min:e.width}),r&&(i?(a.x=n.snapValue(e.x,{max:e.x}),a.width+=n.snapValue(e.x-a.x,{min:e.x-a.x})):e.x=e.x+e.width-a.width),I(e,a),e};mi.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),r=/s/.test(t),a={};return a.height=n.snapValue(e.height,{min:e.height}),i&&(r?(a.y=n.snapValue(e.y,{max:e.y}),a.height+=n.snapValue(e.y-a.y,{min:e.y-a.y})):e.y=e.y+e.height-a.height),I(e,a),e};var xw=2e3;function hm(e,t){e.on(["spaceTool.move","spaceTool.end"],xw,function(n){var i=n.context;if(!!i.initialized){var r=i.axis,a;r==="x"?(a=t.snapValue(n.dx),n.x=n.x+a-n.dx,n.dx=a):(a=t.snapValue(n.dy),n.y=n.y+a-n.dy,n.dy=a)}})}hm.$inject=["eventBus","gridSnapping"];var _w={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",mi],gridSnappingSpaceToolBehavior:["type",hm]},ww={__depends__:[_w],__init__:["gridSnapping"],gridSnapping:["type",Wn]},Sw=2e3;function dm(e,t){e.on("autoPlace",Sw,function(n){var i=n.source,r=ue(i),a=n.shape,o=Id(i,a);return["x","y"].forEach(function(s){var u={};o[s]!==r[s]&&(o[s]>r[s]?u.min=o[s]:u.max=o[s],v(a,"bpmn:TextAnnotation")&&(Cw(s)?u.offset=-a.width/2:u.offset=-a.height/2),o[s]=t.snapValue(o[s],u))}),o})}dm.$inject=["eventBus","gridSnapping"];function Cw(e){return e==="x"}var Tw=1750;function mm(e,t,n){t.on(["create.start","shape.move.start"],Tw,function(i){var r=i.context,a=r.shape,o=e.getRootElement();if(!(!v(a,"bpmn:Participant")||!v(o,"bpmn:Process")||!o.children.length)){var s=r.createConstraints;!s||(a.width=n.snapValue(a.width,{min:a.width}),a.height=n.snapValue(a.height,{min:a.height}))}})}mm.$inject=["canvas","eventBus","gridSnapping"];var Aw=3e3;function ko(e,t,n){U.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],Aw,function(r){var a=r.context,o=a.connection,s=a.hints||{},u=o.waypoints;s.connectionStart||s.connectionEnd||s.createElementsBehavior===!1||!Rw(u)||n.updateWaypoints(o,i.snapMiddleSegments(u))})}ko.$inject=["eventBus","gridSnapping","modeling"];Z(ko,U);ko.prototype.snapMiddleSegments=function(e){var t=this._gridSnapping,n;e=e.slice();for(var i=1;i<e.length-2;i++)n=Mw(t,e[i],e[i+1]),e[i]=n[0],e[i+1]=n[1];return e};function Rw(e){return e.length>3}function Pw(e){return e==="h"}function Dw(e){return e==="v"}function Mw(e,t,n){var i=vn(t,n),r={};return Pw(i)&&(r.y=e.snapValue(t.y)),Dw(i)&&(r.x=e.snapValue(t.x)),("x"in r||"y"in r)&&(t=I({},t,r),n=I({},n,r)),[t,n]}var Bw={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",dm],gridSnappingCreateParticipantBehavior:["type",mm],gridSnappingLayoutConnectionBehavior:["type",ko]},Ow={__depends__:[ww,Bw],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",fm]},Iw=30,Nw=30;function Vr(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(i){var r=i.element,a=i.gfx;if(v(r,"bpmn:Lane"))return n.createParticipantHit(r,a);if(v(r,"bpmn:Participant"))return Se(r)?n.createParticipantHit(r,a):n.createDefaultHit(r,a);if(v(r,"bpmn:SubProcess"))return Se(r)?n.createSubProcessHit(r,a):n.createDefaultHit(r,a)})}Vr.$inject=["eventBus","interactionEvents"];Vr.prototype.createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0};Vr.prototype.createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:Iw,height:e.height}),!0};Vr.prototype.createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:Nw}),!0};var Fw={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Vr]};function Lo(e){e.invoke(Yi,this)}Z(Lo,Yi);Lo.$inject=["injector"];Lo.prototype.registerBindings=function(e,t){Yi.prototype.registerBindings.call(this,e,t);function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("selectElements",function(i){var r=i.keyEvent;if(e.isKey(["a","A"],r)&&e.isCmd(r))return t.trigger("selectElements"),!0}),n("find",function(i){var r=i.keyEvent;if(e.isKey(["f","F"],r)&&e.isCmd(r))return t.trigger("find"),!0}),n("spaceTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["s","S"],r))return t.trigger("spaceTool"),!0}),n("lassoTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["l","L"],r))return t.trigger("lassoTool"),!0}),n("handTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["h","H"],r))return t.trigger("handTool"),!0}),n("globalConnectTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["c","C"],r))return t.trigger("globalConnectTool"),!0}),n("directEditing",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["e","E"],r))return t.trigger("directEditing"),!0})};var kw={__depends__:[Uu],__init__:["keyboardBindings"],keyboardBindings:["type",Lo]},Lw={moveSpeed:1,moveSpeedAccelerated:10},$w=1500,Wp="left",Up="up",Yp="right",qp="down",jw={ArrowLeft:Wp,Left:Wp,ArrowUp:Up,Up,ArrowRight:Yp,Right:Yp,ArrowDown:qp,Down:qp},Hw={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function vm(e,t,n,i,r){var a=this;this._config=I({},Lw,e||{}),t.addListener($w,function(o){var s=o.keyEvent,u=jw[s.key];if(!!u&&!t.isCmd(s)){var c=t.isShift(s);return a.moveSelection(u,c),!0}}),this.moveSelection=function(o,s){var u=r.get();if(!!u.length){var c=this._config[s?"moveSpeedAccelerated":"moveSpeed"],l=Hw[o](c),p=i.allowed("elements.move",{shapes:u});p&&n.moveElements(u,l)}}}vm.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];var zw={__depends__:[Uu,sn],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",vm]};function gm(e,t,n,i){e.on("element.changed",function(r){var a=r.element;(a.parent||a===t.getRootElement())&&(r.gfx=n.getGraphics(a)),r.gfx&&e.fire(Ah(a)+".changed",r)}),e.on("elements.changed",function(r){var a=r.elements;a.forEach(function(o){e.fire("element.changed",{element:o})}),i.updateContainments(a)}),e.on("shape.changed",function(r){i.update("shape",r.element,r.gfx)}),e.on("connection.changed",function(r){i.update("connection",r.element,r.gfx)})}gm.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var ym={__init__:["changeSupport"],changeSupport:["type",gm]},Kp=10;function Wr(e,t,n,i){this._dragging=i,this._rules=t;var r=this;function a(u,c){var l=u.shape,p=u.direction,h=u.resizeConstraints,f;u.delta=c,f=tw(l,p,c),u.newBounds=iw(f,h),u.canExecute=r.canResize(u)}function o(u){var c=u.resizeConstraints,l=u.minBounds;c===void 0&&(l===void 0&&(l=r.computeMinResizeBox(u)),u.resizeConstraints={min:ee(l)})}function s(u){var c=u.shape,l=u.canExecute,p=u.newBounds;if(l){if(p=Oh(p),!Gw(c,p))return;n.resizeShape(c,p)}}e.on("resize.start",function(u){o(u.context)}),e.on("resize.move",function(u){var c={x:u.dx,y:u.dy};a(u.context,c)}),e.on("resize.end",function(u){s(u.context)})}Wr.prototype.canResize=function(e){var t=this._rules,n=Wt(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)};Wr.prototype.activate=function(e,t,n){var i=this._dragging,r,a;if(typeof n=="string"&&(n={direction:n}),r=I({shape:t},n),a=r.direction,!a)throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");i.init(e,Em(t,a),"resize",{autoActivate:!0,cursor:Vw(a),data:{shape:t,context:r}})};Wr.prototype.computeMinResizeBox=function(e){var t=e.shape,n=e.direction,i,r;return i=e.minDimensions||{width:Kp,height:Kp},r=cm(t,e.childrenBoxPadding),rw(n,t,i,r)};Wr.$inject=["eventBus","rules","modeling","dragging"];function Gw(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function Em(e,t){var n=ue(e),i=ee(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function Vw(e){var t="resize-";return e==="n"||e==="s"?t+"ns":e==="e"||e==="w"?t+"ew":e==="nw"||e==="se"?t+"nwse":t+"nesw"}var Xp="djs-resizing",Zp="resize-not-ok",Ww=500;function bm(e,t,n){function i(a){var o=a.shape,s=a.newBounds,u=a.frame;u||(u=a.frame=n.addFrame(o,t.getActiveLayer()),t.addMarker(o,Xp)),s.width>5&&H(u,{x:s.x,width:s.width}),s.height>5&&H(u,{y:s.y,height:s.height}),a.canExecute?fe(u).remove(Zp):fe(u).add(Zp)}function r(a){var o=a.shape,s=a.frame;s&&ke(a.frame),t.removeMarker(o,Xp)}e.on("resize.move",Ww,function(a){i(a.context)}),e.on("resize.cleanup",function(a){r(a.context)})}bm.$inject=["eventBus","canvas","previewSupport"];var Ca=-6,Ta=4,Aa=20,cr="djs-resizer",Uw=["n","w","s","e","nw","ne","se","sw"];function Un(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(a){var o=a.newSelection;r.removeResizers(),o.length===1&&A(o,ft(r.addResizer,r))}),e.on("shape.changed",function(a){var o=a.element;n.isSelected(o)&&(r.removeResizers(),r.addResizer(o))})}Un.prototype.makeDraggable=function(e,t,n){var i=this._resize;function r(a){zn(a)&&i.activate(a,e,n)}te.bind(t,"mousedown",r),te.bind(t,"touchstart",r)};Un.prototype._createResizer=function(e,t,n,i){var r=this._getResizersParent(),a=Yw(i),o=J("g");fe(o).add(cr),fe(o).add(cr+"-"+e.id),fe(o).add(cr+"-"+i),ne(r,o);var s=J("rect");H(s,{x:-Ta/2+a.x,y:-Ta/2+a.y,width:Ta,height:Ta}),fe(s).add(cr+"-visual"),ne(o,s);var u=J("rect");return H(u,{x:-Aa/2+a.x,y:-Aa/2+a.y,width:Aa,height:Aa}),fe(u).add(cr+"-hit"),ne(o,u),Xs(o,t,n),o};Un.prototype.createResizer=function(e,t){var n=Em(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)};Un.prototype.addResizer=function(e){var t=this,n=this._resize;!n.canResize({shape:e})||A(Uw,function(i){t.createResizer(e,i)})};Un.prototype.removeResizers=function(){var e=this._getResizersParent();Ru(e)};Un.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")};Un.$inject=["eventBus","canvas","selection","resize"];function Yw(e){var t={x:0,y:0};return e.indexOf("e")!==-1?t.x=-Ca:e.indexOf("w")!==-1&&(t.x=Ca),e.indexOf("s")!==-1?t.y=-Ca:e.indexOf("n")!==-1&&(t.y=Ca),t}var xm={__depends__:[cn,wn,jr],__init__:["resize","resizePreview","resizeHandles"],resize:["type",Wr],resizePreview:["type",bm],resizeHandles:["type",Un]};function cu(e,t){var n=t.create("bpmn:CategoryValue"),i=t.create("bpmn:Category",{categoryValue:[n]});return Fe(e.get("rootElements"),i),Y(i).$parent=e,Y(n).$parent=i,n}function Ur(e,t,n,i,r,a,o){this._bpmnFactory=t,this._canvas=n,this._modeling=r,this._textRenderer=o,i.registerProvider(this),e.on("element.dblclick",function(u){s(u.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open"],function(u){i.isActive()&&i.complete()}),e.on(["commandStack.changed"],function(u){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(u){a.removeResizers()}),e.on("create.end",500,function(u){var c=u.context,l=c.shape,p=u.context.canExecute,h=u.isTouch;h||!p||c.hints&&c.hints.createElementsBehavior===!1||s(l)}),e.on("autoPlace.end",500,function(u){s(u.shape)});function s(u,c){(c||ye(u,["bpmn:Task","bpmn:TextAnnotation"])||ac(u))&&i.activate(u)}}Ur.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"];Ur.prototype.activate=function(e){var t=Ut(e);if(t!==void 0){var n={text:t},i=this.getEditingBBox(e);I(n,i);var r={};return(ye(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||ac(e))&&I(r,{centerVertically:!0}),Bi(e)&&I(r,{autoResize:!0}),v(e,"bpmn:TextAnnotation")&&I(r,{resizable:!0,autoResize:!0}),I(n,{options:r}),n}};Ur.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),r={x:i.x+i.width/2,y:i.y+i.height/2},a={x:i.x,y:i.y},o=t.zoom(),s=this._textRenderer.getDefaultStyle(),u=this._textRenderer.getExternalStyle(),c=u.fontSize*o,l=u.lineHeight,p=s.fontSize*o,h=s.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};(v(e,"bpmn:Lane")||Xw(e))&&(I(a,{width:i.height,height:30*o,x:i.x-i.height/2+15*o,y:r.y-30*o/2}),I(f,{fontSize:p+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px",transform:"rotate(-90deg)"})),(ye(e,["bpmn:Task","bpmn:CallActivity"])||Kw(e)||ac(e))&&(I(a,{width:i.width,height:i.height}),I(f,{fontSize:p+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px"})),qw(e)&&(I(a,{width:i.width,x:i.x}),I(f,{fontSize:p+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px"}));var d=90*o,y=7*o,x=4*o;if(n.labelTarget&&(I(a,{width:d,height:i.height+y+x,x:r.x-d/2,y:i.y-y}),I(f,{fontSize:c+"px",lineHeight:l,paddingTop:y+"px",paddingBottom:x+"px"})),Bi(n)&&!Co(n)&&!Je(n)){var M=To(e),P=t.getAbsoluteBBox({x:M.x,y:M.y,width:0,height:0}),w=c+y+x;I(a,{width:d,height:w,x:P.x-d/2,y:P.y-w/2}),I(f,{fontSize:c+"px",lineHeight:l,paddingTop:y+"px",paddingBottom:x+"px"})}return v(e,"bpmn:TextAnnotation")&&(I(a,{width:i.width,height:i.height,minWidth:30*o,minHeight:10*o}),I(f,{textAlign:"left",paddingTop:5*o+"px",paddingBottom:7*o+"px",paddingLeft:7*o+"px",paddingRight:5*o+"px",fontSize:p+"px",lineHeight:h})),{bounds:a,style:f}};Ur.prototype.update=function(e,t,n,i){var r,a;if(v(e,"bpmn:TextAnnotation")&&(a=this._canvas.getAbsoluteBBox(e),r={x:e.x,y:e.y,width:e.width/a.width*i.width,height:e.height/a.height*i.height}),v(e,"bpmn:Group")){var o=Y(e);if(!o.categoryValueRef){var s=this._canvas.getRootElement(),u=Y(s).$parent,c=cu(u,this._bpmnFactory);Y(e).categoryValueRef=c}}Zw(t)&&(t=null),this._modeling.updateLabel(e,t,r)};function ac(e){return v(e,"bpmn:SubProcess")&&!Se(e)}function qw(e){return v(e,"bpmn:SubProcess")&&Se(e)}function Kw(e){return v(e,"bpmn:Participant")&&!Se(e)}function Xw(e){return v(e,"bpmn:Participant")&&Se(e)}function Zw(e){return!e||!e.trim()}var Jp="djs-element-hidden",Qp="djs-label-hidden";function _m(e,t,n,i){var r=this,a=t.getDefaultLayer(),o,s,u;e.on("directEditing.activate",function(c){var l=c.active;if(o=l.element.label||l.element,v(o,"bpmn:TextAnnotation")){s=t.getAbsoluteBBox(o),u=J("g");var p=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:o.height,position:{mx:0,my:0}}),h=r.path=J("path");H(h,{d:p,strokeWidth:2,stroke:Jw(o)}),ne(u,h),ne(a,u),mt(u,o.x,o.y)}v(o,"bpmn:TextAnnotation")||o.labelTarget?t.addMarker(o,Jp):(v(o,"bpmn:Task")||v(o,"bpmn:CallActivity")||v(o,"bpmn:SubProcess")||v(o,"bpmn:Participant"))&&t.addMarker(o,Qp)}),e.on("directEditing.resize",function(c){if(v(o,"bpmn:TextAnnotation")){var l=c.height,p=c.dy,h=Math.max(o.height/s.height*(l+p),0),f=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:h,position:{mx:0,my:0}});H(r.path,{d:f})}}),e.on(["directEditing.complete","directEditing.cancel"],function(c){var l=c.active;l&&(t.removeMarker(l.element.label||l.element,Jp),t.removeMarker(o,Qp)),o=void 0,s=void 0,u&&(ke(u),u=void 0)})}_m.$inject=["eventBus","canvas","elementRegistry","pathMap"];function Jw(e,t){var n=Y(e);return n.di.get("stroke")||t||"black"}var Qw={__depends__:[ym,xm,Qd],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",Ur],labelEditingPreview:["type",_m]},oc=["top","bottom","left","right"],Ra=10;function sc(e,t){U.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(r){var a=r.context,o=a.connection,s=o.source,u=o.target,c=a.hints||{};c.createElementsBehavior!==!1&&(n(s),n(u))}),this.postExecuted(["label.create"],function(r){var a=r.context,o=a.shape,s=a.hints||{};s.createElementsBehavior!==!1&&n(o.labelTarget)}),this.postExecuted(["elements.create"],function(r){var a=r.context,o=a.elements,s=a.hints||{};s.createElementsBehavior!==!1&&o.forEach(function(u){n(u)})});function n(r){if(!!Co(r)){var a=nS(r);!a||i(r,a)}}function i(r,a){var o=ue(r),s=r.label,u=ue(s);if(!!s.parent){var c=ee(r),l;switch(a){case"top":l={x:o.x,y:c.top-Ra-s.height/2};break;case"left":l={x:c.left-Ra-s.width/2,y:o.y};break;case"bottom":l={x:o.x,y:c.bottom+Ra+s.height/2};break;case"right":l={x:c.right+Ra+s.width/2,y:o.y};break}var p=nn(l,u);t.moveShape(s,p)}}}Z(sc,U);sc.$inject=["eventBus","modeling"];function eS(e){var t=e.host,n=ue(e),i=tt(n,t),r;i.indexOf("-")>=0?r=i.split("-"):r=[i];var a=oc.filter(function(o){return r.indexOf(o)===-1});return a}function tS(e){var t=ue(e),n=[].concat(e.incoming.map(function(i){return i.waypoints[i.waypoints.length-2]}),e.outgoing.map(function(i){return i.waypoints[1]})).map(function(i){return wm(t,i)});return n}function nS(e){var t=ue(e.label),n=ue(e),i=wm(n,t);if(!!iS(i)){var r=tS(e);if(e.host){var a=eS(e);r=r.concat(a)}var o=oc.filter(function(s){return r.indexOf(s)===-1});if(o.indexOf(i)===-1)return o[0]}}function wm(e,t){return tt(t,e,5)}function iS(e){return oc.indexOf(e)!==-1}function uc(e,t,n){U.call(this,e),this.preExecute("shape.append",function(i){var r=i.source,a=i.shape;i.position||(v(a,"bpmn:TextAnnotation")?i.position={x:r.x+r.width/2+75,y:r.y-50-a.height/2}:i.position={x:r.x+r.width+80+a.width/2,y:r.y+r.height/2})},!0)}Z(uc,U);uc.$inject=["eventBus","elementFactory","bpmnRules"];function cc(e,t){e.invoke(U,this),this.postExecute("shape.move",function(n){var i=n.newParent,r=n.shape,a=se(r.incoming.concat(r.outgoing),function(o){return v(o,"bpmn:Association")});A(a,function(o){t.moveConnection(o,{x:0,y:0},i)})},!0)}Z(cc,U);cc.$inject=["injector","modeling"];var ef=500;function $o(e,t){t.invoke(U,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",ef,function(i){var r=i.elements;r=r.filter(function(a){var o=a.host;return tf(a,o)}),r.length===1&&r.map(function(a){return r.indexOf(a)}).forEach(function(a){var o=r[a];i.elements[a]=n.replaceShape(r[a],o)})},!0),this.preExecute("elements.move",ef,function(i){var r=i.shapes,a=i.newHost;if(r.length===1){var o=r[0];tf(o,a)&&(i.shapes=[n.replaceShape(o,a)])}},!0)}$o.$inject=["bpmnReplace","injector"];Z($o,U);$o.prototype.replaceShape=function(e,t){var n=rS(e),i={type:"bpmn:BoundaryEvent",host:t};return n&&(i.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,i,{layoutConnection:!1})};function rS(e){var t=Y(e),n=t.eventDefinitions;return n&&n[0]}function tf(e,t){return!Je(e)&&ye(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}var aS=2e3;function lc(e,t,n){U.call(this,e);function i(r){return se(r.attachers,function(a){return v(a,"bpmn:BoundaryEvent")})}this.postExecute("connection.create",function(r){var a=r.context.source,o=r.context.target,s=i(o);v(a,"bpmn:EventBasedGateway")&&v(o,"bpmn:ReceiveTask")&&s.length>0&&n.removeElements(s)}),this.postExecute("connection.reconnect",function(r){var a=r.context.oldSource,o=r.context.newSource;v(a,"bpmn:Gateway")&&v(o,"bpmn:EventBasedGateway")&&A(o.outgoing,function(s){var u=s.target,c=i(u);v(u,"bpmn:ReceiveTask")&&c.length>0&&n.removeElements(c)})}),e.on("moddleCopy.canCopyProperty",aS,function(r){var a=r.parent,o=r.property,s=r.propertyName,u=t.getPropertyDescriptor(a,s);u&&u.isReference&&v(o,"bpmn:RootElement")&&a.set(s,o)})}lc.$inject=["eventBus","moddle","modeling"];Z(lc,U);var oS=500;function pc(e,t,n,i,r){n.invoke(U,this);function a(l){return ye(l,["bpmn:ReceiveTask","bpmn:SendTask"])||sS(l,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function o(l){var p=e.getDefinitions(),h=p.get("rootElements");return!!_e(h,Gt({id:l.id}))}function s(l){if(v(l,"bpmn:ErrorEventDefinition"))return"errorRef";if(v(l,"bpmn:EscalationEventDefinition"))return"escalationRef";if(v(l,"bpmn:MessageEventDefinition"))return"messageRef";if(v(l,"bpmn:SignalEventDefinition"))return"signalRef"}function u(l){if(ye(l,["bpmn:ReceiveTask","bpmn:SendTask"]))return l.get("messageRef");var p=l.get("eventDefinitions"),h=p[0];return h.get(s(h))}function c(l,p){if(ye(l,["bpmn:ReceiveTask","bpmn:SendTask"]))return l.set("messageRef",p);var h=l.get("eventDefinitions"),f=h[0];return f.set(s(f),p)}this.executed("shape.create",function(l){var p=l.shape;if(!!a(p)){var h=Y(p),f=u(h),d;f&&!o(f)&&(d=e.getDefinitions().get("rootElements"),Fe(d,f),l.addedRootElement=f)}},!0),this.reverted("shape.create",function(l){var p=l.addedRootElement;if(!!p){var h=e.getDefinitions().get("rootElements");Ne(h,p)}},!0),t.on("copyPaste.copyElement",function(l){var p=l.descriptor,h=l.element;if(!!a(h)){var f=Y(h),d=u(f);d&&(p.referencedRootElement=d)}}),t.on("copyPaste.pasteElement",oS,function(l){var p=l.descriptor,h=p.businessObject;if(!!a(h)){var f=p.referencedRootElement;!f||(o(f)||(f=i.copyElement(f,r.create(f.$type))),c(h,f))}})}pc.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"];Z(pc,U);function sS(e,t){return he(t)||(t=[t]),ci(t,function(n){return _o(e,n)})}function fc(e){e.invoke(U,this),this.preExecute("shape.create",1500,function(t){var n=t.context,i=n.parent,r=n.shape;v(i,"bpmn:Lane")&&!v(r,"bpmn:Lane")&&(n.parent=no(i,"bpmn:Participant"))})}fc.$inject=["injector"];Z(fc,U);var Pa=1500,uS=2e3;function Sm(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],Pa,function(i){var r=i.context,a=r.shape||i.shape,o=i.hover;v(o,"bpmn:Lane")&&!ye(a,["bpmn:Lane","bpmn:Participant"])&&(i.hover=zt(o),i.hoverGfx=e.getGraphics(i.hover));var s=n.getRootElement();o!==s&&(a.labelTarget||v(a,"bpmn:Group"))&&(i.hover=s,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],Pa,function(i){var r=i.hover;v(r,"bpmn:Lane")&&(i.hover=zt(r)||r,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["bendpoint.move.hover"],Pa,function(i){var r=i.context,a=i.hover,o=r.type;v(a,"bpmn:Lane")&&/reconnect/.test(o)&&(i.hover=zt(a)||a,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.start"],Pa,function(i){var r=i.context,a=r.start;v(a,"bpmn:Lane")&&(r.start=zt(a)||a)}),t.on("shape.move.start",uS,function(i){var r=i.shape;v(r,"bpmn:Lane")&&(i.shape=zt(r)||r)})}Sm.$inject=["elementRegistry","eventBus","canvas"];function hc(e,t,n){U.call(this,e),this.preExecute("shape.create",function(i){var r=i.context,a=r.shape;if(v(a,"bpmn:DataObjectReference")&&a.type!=="label"){var o=t.create("bpmn:DataObject");a.businessObject.dataObjectRef=o}})}hc.$inject=["eventBus","bpmnFactory","moddle"];Z(hc,U);var lu=20,pu=20,Cm=30,Da=2e3;function dc(e,t,n){U.call(this,t),t.on(["create.start","shape.move.start"],Da,function(r){var a=r.context,o=a.shape,s=e.getRootElement();if(!(!v(o,"bpmn:Participant")||!v(s,"bpmn:Process")||!s.children.length)){var u=s.children.filter(function(p){return!v(p,"bpmn:Group")&&!Je(p)&&!pS(p)});if(!!u.length){var c=et(u),l=cS(o,c);I(o,l),a.createConstraints=lS(o,c)}}}),t.on("create.start",Da,function(r){var a=r.context,o=a.shape,s=e.getRootElement(),u=e.getGraphics(s);function c(l){l.element=s,l.gfx=u}v(o,"bpmn:Participant")&&v(s,"bpmn:Process")&&(t.on("element.hover",Da,c),t.once("create.cleanup",function(){t.off("element.hover",c)}))});function i(){var r=e.getRootElement();return v(r,"bpmn:Collaboration")?r:n.makeCollaboration()}this.preExecute("elements.create",Da,function(r){var a=r.elements,o=r.parent,s=fS(a),u;s&&v(o,"bpmn:Process")&&(r.parent=i(),u=r.hints=r.hints||{},u.participant=s,u.process=o,u.processRef=Y(s).get("processRef"))},!0),this.preExecute("shape.create",function(r){var a=r.parent,o=r.shape;v(o,"bpmn:Participant")&&v(a,"bpmn:Process")&&(r.parent=i(),r.process=a,r.processRef=Y(o).get("processRef"))},!0),this.execute("shape.create",function(r){var a=r.hints||{},o=r.process||a.process,s=r.shape,u=a.participant;o&&(!u||s===u)&&Y(s).set("processRef",Y(o))},!0),this.revert("shape.create",function(r){var a=r.hints||{},o=r.process||a.process,s=r.processRef||a.processRef,u=r.shape,c=a.participant;o&&(!c||u===c)&&Y(u).set("processRef",s)},!0),this.postExecute("shape.create",function(r){var a=r.hints||{},o=r.process||r.hints.process,s=r.shape,u=a.participant;if(o){var c=o.children.slice();u?s===u&&n.moveElements(c,{x:0,y:0},u):n.moveElements(c,{x:0,y:0},s)}},!0)}dc.$inject=["canvas","eventBus","modeling"];Z(dc,U);function cS(e,t){t={width:t.width+lu*2+Cm,height:t.height+pu*2};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}function lS(e,t){return t=ee(t),{bottom:t.top+e.height/2-pu,left:t.right-e.width/2+lu,top:t.bottom-e.height/2+pu,right:t.left+e.width/2-lu-Cm}}function pS(e){return!!e.waypoints}function fS(e){return _e(e,function(t){return v(t,"bpmn:Participant")})}var nf="__targetRef_placeholder";function mc(e,t){U.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],rf(a)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],rf(a));function n(o,s,u){var c=o.get("dataInputAssociations");return _e(c,function(l){return l!==u&&l.targetRef===s})}function i(o,s){var u=o.get("properties"),c=_e(u,function(l){return l.name===nf});return!c&&s&&(c=t.create("bpmn:Property",{name:nf}),Fe(u,c)),c}function r(o,s){var u=i(o);!u||n(o,u,s)||Ne(o.get("properties"),u)}function a(o){var s=o.context,u=s.connection,c=u.businessObject,l=u.target,p=l&&l.businessObject,h=s.newTarget,f=h&&h.businessObject,d=s.oldTarget||s.target,y=d&&d.businessObject,x=u.businessObject,M;y&&y!==p&&r(y,c),f&&f!==p&&r(f,c),p?(M=i(p,!0),x.targetRef=M):x.targetRef=null}}mc.$inject=["eventBus","bpmnFactory"];Z(mc,U);function rf(e){return function(t){var n=t.context,i=n.connection;if(v(i,"bpmn:DataInputAssociation"))return e(t)}}function jo(e){this._bpmnUpdater=e}jo.$inject=["bpmnUpdater"];jo.prototype.execute=function(e){var t=e.dataStoreBo,n=e.newSemanticParent,i=e.newDiParent;e.oldSemanticParent=t.$parent,e.oldDiParent=t.di.$parent,this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)};jo.prototype.revert=function(e){var t=e.dataStoreBo,n=e.oldSemanticParent,i=e.oldDiParent;this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)};function vc(e,t,n,i){U.call(this,i),t.registerHandler("dataStore.updateContainment",jo);function r(){return n.filter(function(s){return v(s,"bpmn:Participant")&&Y(s).processRef})[0]}function a(s){return s.children.filter(function(u){return v(u,"bpmn:DataStoreReference")&&!u.labelTarget})}function o(s,u){var c=s.businessObject||s;if(u=u||r(),u){var l=u.businessObject||u;t.execute("dataStore.updateContainment",{dataStoreBo:c,newSemanticParent:l.processRef||l,newDiParent:l.di})}}this.preExecute("shape.create",function(s){var u=s.context,c=u.shape;v(c,"bpmn:DataStoreReference")&&c.type!=="label"&&(u.hints||(u.hints={}),u.hints.autoResize=!1)}),this.preExecute("elements.move",function(s){var u=s.context,c=u.shapes,l=c.filter(function(p){return v(p,"bpmn:DataStoreReference")});l.length&&(u.hints||(u.hints={}),u.hints.autoResize=c.filter(function(p){return!v(p,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(s){var u=s.context,c=u.shape,l=c.parent;v(c,"bpmn:DataStoreReference")&&c.type!=="label"&&v(l,"bpmn:Collaboration")&&o(c)}),this.postExecute("shape.move",function(s){var u=s.context,c=u.shape,l=u.oldParent,p=c.parent;if(!v(l,"bpmn:Collaboration")&&v(c,"bpmn:DataStoreReference")&&c.type!=="label"&&v(p,"bpmn:Collaboration")){var h=v(l,"bpmn:Participant")?l:dS(l,"bpmn:Participant");o(c,h)}}),this.postExecute("shape.delete",function(s){var u=s.context,c=u.shape,l=e.getRootElement();ye(c,["bpmn:Participant","bpmn:SubProcess"])&&v(l,"bpmn:Collaboration")&&a(l).filter(function(p){return hS(p,c)}).forEach(function(p){o(p)})}),this.postExecute("canvas.updateRoot",function(s){var u=s.context,c=u.oldRoot,l=u.newRoot,p=a(c);p.forEach(function(h){v(l,"bpmn:Process")&&o(h,l)})})}vc.$inject=["canvas","commandStack","elementRegistry","eventBus"];Z(vc,U);function hS(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}function dS(e,t){for(;e.parent;){if(v(e.parent,t))return e.parent;e=e.parent}}var mS=500;function gc(e,t,n){U.call(this,e);function i(r,a){var o=di(a),s=[],u=[];if(pi(o,function(h){return h.y>r.y?u.push(h):s.push(h),h.children}),!!o.length){var c;u.length&&s.length?c=r.height/2:c=r.height;var l,p;s.length&&(l=n.calculateAdjustments(s,"y",c,r.y-10),n.makeSpace(l.movingShapes,l.resizingShapes,{x:0,y:c},"s")),u.length&&(p=n.calculateAdjustments(u,"y",-c,r.y+r.height+10),n.makeSpace(p.movingShapes,p.resizingShapes,{x:0,y:-c},"n"))}}this.postExecuted("shape.delete",mS,function(r){var a=r.context,o=a.hints,s=a.shape,u=a.oldParent;!v(s,"bpmn:Lane")||o&&o.nested||i(s,u)})}gc.$inject=["eventBus","modeling","spaceTool"];Z(gc,U);var af=500;function Ho(e,t){t.invoke(U,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",af,function(i){var r=i.elements;r.filter(function(a){var o=a.host;return of(a,o)}).map(function(a){return r.indexOf(a)}).forEach(function(a){i.elements[a]=n.replaceShape(r[a])})},!0),this.preExecute("elements.move",af,function(i){var r=i.shapes,a=i.newHost;r.forEach(function(o,s){var u=o.host;of(o,gS(r,u)?u:a)&&(r[s]=n.replaceShape(o))})},!0)}Ho.$inject=["bpmnReplace","injector"];Z(Ho,U);Ho.prototype.replaceShape=function(e){var t=vS(e),n;return t?n={type:"bpmn:IntermediateCatchEvent",eventDefinitionType:t.$type}:n={type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,n,{layoutConnection:!1})};function vS(e){var t=Y(e),n=t.eventDefinitions;return n&&n[0]}function of(e,t){return!Je(e)&&v(e,"bpmn:BoundaryEvent")&&!t}function gS(e,t){return e.indexOf(t)!==-1}function yc(e,t,n){U.call(this,e);function i(r,a,o){var s=a.waypoints,u,c,l,p,h,f,d,y=r.outgoing.slice(),x=r.incoming.slice(),M;ae(o.width)?M=ue(o):M=o;var P=nu(s,M);if(P){if(u=s.slice(0,P.index),c=s.slice(P.index+(P.bendpoint?1:0)),!u.length||!c.length)return;l=P.bendpoint?s[P.index]:M,(u.length===1||!sf(r,u[u.length-1]))&&u.push(uf(l)),(c.length===1||!sf(r,c[0]))&&c.unshift(uf(l))}p=a.source,h=a.target,t.canConnect(p,r,a)&&(n.reconnectEnd(a,r,u||M),f=a),t.canConnect(r,h,a)&&(f?d=n.connect(r,h,{type:a.type,waypoints:c}):(n.reconnectStart(a,r,c||M),d=a));var w=[].concat(f&&se(x,function(b){return b.source===f.source})||[],d&&se(y,function(b){return b.target===d.target})||[]);w.length&&n.removeElements(w)}this.preExecute("elements.move",function(r){var a=r.newParent,o=r.shapes,s=r.delta,u=o[0];if(!(!u||!a)){a&&a.waypoints&&(r.newParent=a=a.parent);var c=ue(u),l={x:c.x+s.x,y:c.y+s.y},p=_e(a.children,function(h){var f=t.canInsert(o,h);return f&&nu(h.waypoints,l)});p&&(r.targetFlow=p,r.position=l)}},!0),this.postExecuted("elements.move",function(r){var a=r.shapes,o=r.targetFlow,s=r.position;o&&i(a[0],o,s)},!0),this.preExecute("shape.create",function(r){var a=r.parent,o=r.shape;t.canInsert(o,a)&&(r.targetFlow=a,r.parent=a.parent)},!0),this.postExecuted("shape.create",function(r){var a=r.shape,o=r.targetFlow,s=r.position;o&&i(a,o,s)},!0)}Z(yc,U);yc.$inject=["eventBus","bpmnRules","modeling"];function sf(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function uf(e){return I({},e)}function Ec(e,t){U.call(this,e),this.preExecuted("connection.create",function(n){var i=n.context,r=i.source,a=i.target,o=a.incoming.slice();i.hints&&i.hints.createElementsBehavior===!1||v(r,"bpmn:EventBasedGateway")&&a.incoming.length&&o.filter(As).forEach(function(s){t.removeConnection(s)})}),this.preExecuted("shape.replace",function(n){var i=n.context.newShape,r,a;!v(i,"bpmn:EventBasedGateway")||(r=i.outgoing.filter(As).map(function(o){return o.target}),a=r.reduce(function(o,s){var u=s.incoming.filter(As);return o.concat(u)},[]),a.forEach(function(o){o.source!==i&&t.removeConnection(o)}))})}Ec.$inject=["eventBus","modeling"];Z(Ec,U);function As(e){return v(e,"bpmn:SequenceFlow")}var yS=2e3;function bc(e,t,n,i,r,a){r.invoke(U,this);function o(){var p=t.getRootElement(),h=Y(p);return h.$parent}function s(p){var h=Y(p),f=h.categoryValueRef;if(!!f){var d=f.$parent;!f||(Ne(d.categoryValue,f),d&&!d.categoryValue.length&&u(d))}}function u(p){var h=o();Ne(h.get("rootElements"),p)}function c(){return n.filter(function(p){return v(p,"bpmn:Group")})}function l(p,h){return p.some(function(f){var d=Y(f);return d.categoryValueRef&&d.categoryValueRef===h})}this.executed("shape.delete",function(p){var h=p.context,f=h.shape;if(v(f,"bpmn:Group")){var d=Y(f),y=d.categoryValueRef,x=c();l(x,y)||s(f)}}),this.reverted("shape.delete",function(p){var h=p.context,f=h.shape;if(v(f,"bpmn:Group")){var d=Y(f),y=d.categoryValueRef,x=o(),M=y?y.$parent:null;Fe(M.get("categoryValue"),y),Fe(x.get("rootElements"),M)}}),this.execute("shape.create",function(p){var h=p.context,f=h.shape,d=Y(f);if(v(d,"bpmn:Group")&&!d.categoryValueRef){var y=o(),x=cu(y,e);d.categoryValueRef=x}}),this.revert("shape.create",function(p){var h=p.context,f=h.shape;v(f,"bpmn:Group")&&(s(f),delete Y(f).categoryValueRef)}),i.on("moddleCopy.canCopyProperty",yS,function(p){var h=p.property,f;if(v(h,"bpmn:CategoryValue"))return f=cu(o(),e),a.copyElement(h,f)})}bc.$inject=["bpmnFactory","canvas","elementRegistry","eventBus","injector","moddleCopy"];Z(bc,U);function fu(e,t,n,i){var r,a,o,s,u;return r=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y),r==0?null:(a=e.y-n.y,o=e.x-n.x,u=(i.x-n.x)*a-(i.y-n.y)*o,s=u/r,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function Tm(e){function t(i,r,a){var o={x:a.x,y:a.y-50},s={x:a.x-50,y:a.y},u=fu(i,r,a,o),c=fu(i,r,a,s),l;u&&c?cf(u,a)>cf(c,a)?l=c:l=u:l=u||c,i.original=l}function n(i){var r=i.waypoints;t(r[0],r[1],ue(i.source)),t(r[r.length-1],r[r.length-2],ue(i.target))}e.on("bpmnElement.added",function(i){var r=i.element;r.waypoints&&n(r)})}Tm.$inject=["eventBus"];function cf(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function xc(e){U.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(n){var i=Y(n.context.shape);ye(i,t)&&!i.di.get("isHorizontal")&&i.di.set("isHorizontal",!0)})}xc.$inject=["eventBus"];Z(xc,U);function Am(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function lf(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function ES(e,t){return t?{x:Math.cos(t)*e.x-Math.sin(t)*e.y,y:Math.sin(t)*e.x+Math.cos(t)*e.y}:e}function bS(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}],r=i[0].n*t[0]+i[1].n*t[1],a=i[0].lambda*t[0]+i[1].lambda*t[1];return-r/a}function Rm(e,t){var n=t[0],i=t[1],r={x:i.x-n.x,y:i.y-n.y},a=bS([n.x,n.y],[r.x,r.y],[e.x,e.y]);return{x:n.x+a*r.x,y:n.y+a*r.y}}function xS(e,t){var n=Rm(e,t),i={x:n.x-e.x,y:n.y-e.y};return Am(i)}function oo(e,t){return Am({x:e.x-t.x,y:e.y-t.y})}var Pm=Math.sqrt,Dm=Math.min,_S=Math.max,pf=Math.abs;function ff(e){return Math.pow(e,2)}function lr(e,t){return Pm(ff(e.x-t.x)+ff(e.y-t.y))}function wS(e,t){var n=0,i,r,a,o,s,u,c,l,p,h,f;for(n=0;n<t.length-1;n++){if(i=t[n],r=t[n+1],df(i,r)?c=[i]:(a=lr(e,i),o=lr(e,r),u=Dm(a,o),c=SS(i,r,e,u)),c.length<1)throw new Error("expected between [1, 2] circle -> line intersections");c.length===1&&(l={type:"bendpoint",position:c[0],segmentIndex:n,bendpointIndex:df(i,c[0])?n:n+1}),c.length===2&&(s=TS(c[0],c[1]),l={type:"segment",position:s,segmentIndex:n,relativeLocation:lr(i,s)/lr(i,r)}),p=lr(l.position,e),(!f||h>p)&&(f=l,h=p)}return f}function SS(e,t,n,i){var r=t.x-e.x,a=t.y-e.y,o=n.x-e.x,s=n.y-e.y,u=r*r+a*a,c=r*o+a*s,l=o*o+s*s-i*i,p=c/u,h=l/u,f=p*p-h;if(f<0&&f>-1e-6&&(f=0),f<0)return[];var d=Pm(f),y=-p+d,x=-p-d,M={x:e.x-r*y,y:e.y-a*y};if(f===0)return[M];var P={x:e.x-r*x,y:e.y-a*x};return[M,P].filter(function(w){return CS(w,e,t)})}function CS(e,t,n){return hf(e.x,t.x,n.x)&&hf(e.y,t.y,n.y)}function hf(e,t,n){return e>=Dm(t,n)-so&&e<=_S(t,n)+so}function TS(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var so=.1;function df(e,t){return pf(e.x-t.x)<=so&&pf(e.y-t.y)<=so}function AS(e,t,n,i){var r=n.segmentIndex,a=t.length-e.length;if(i.segmentMove){var o=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return r===o?s:r>=s?r+a<s?s:r+a:r}if(i.bendpointMove){var u=i.bendpointMove.insert,c=i.bendpointMove.bendpointIndex,l;if(a===0)return r;if(r>=c&&(l=u?r+1:r-1),r<c&&(l=r,u&&n.type!=="bendpoint"&&c-1===r)){var p=Mm(t,c);p<n.relativeLocation&&l++}return l}return a===0?r:i.connectionStart?r===0?0:null:i.connectionEnd&&r===e.length-2?t.length-2:null}function RS(e,t,n,i){var r=0,a=0,o=PS(e),s=wS(o,n),u=s.segmentIndex,c=AS(n,t,s,i);if(c===null)return{x:r,y:a};if(c<0||c>t.length-2)return{x:r,y:a};var l=mf(n,u),p=mf(t,c),h=s.position,f=MS(l,h),d=DS(l,p);if(s.type==="bendpoint"){var y=t.length-n.length,x=s.bendpointIndex,M=n[x];if(t.indexOf(M)!==-1)return{x:r,y:a};if(y===0){var P=t[x];return{x:P.x-s.position.x,y:P.y-s.position.y}}y<0&&x!==0&&x<n.length-1&&(f=Mm(n,x))}var w={x:(p[1].x-p[0].x)*f+p[0].x,y:(p[1].y-p[0].y)*f+p[0].y},b=ES({x:o.x-h.x,y:o.y-h.y},d);return r=w.x+b.x-o.x,a=w.y+b.y-o.y,On({x:r,y:a})}function Mm(e,t){var n=oo(e[t-1],e[t]),i=oo(e[t],e[t+1]),r=n/(n+i);return r}function PS(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function DS(e,t){var n=lf(e),i=lf(t);return i-n}function mf(e,t){return[e[t],e[t+1]]}function MS(e,t){var n=oo(e[0],e[1]),i=oo(e[0],t);return n===0?0:i/n}function Yr(e,t,n){var i=gr(t),r=gr(n),a=nn(e,i),o={x:a.x*(n.width/t.width),y:a.y*(n.height/t.height)};return On({x:r.x+o.x,y:r.y+o.y})}function vf(e,t,n){var i=gr(e),r=gr(t),a=gr(n),o=nn(e,i),s=nn(i,r),u=BS(i,t,n);if(u)return u;var c={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},l={x:a.x+c.x,y:a.y+c.y};return On({x:l.x+o.x-e.x,y:l.y+o.y-e.y})}function BS(e,t,n){var i=ee(t),r=ee(n);if(OS(i,r))return null;var a=tt(t,e),o,s,u;if(a==="top")o={x:0,y:r.bottom-i.bottom};else if(a==="bottom")o={x:0,y:r.top-i.top};else if(a==="right")o={x:r.left-i.left,y:0};else if(a==="left")o={x:r.right-i.right,y:0};else return null;return s={x:e.x+o.x,y:e.y+o.y},u=tt(n,s),u!==a?null:o}function OS(e,t){return IS(e,t)||NS(e,t)}function IS(e,t){return e.right!==t.right&&e.left!==t.left}function NS(e,t){return e.top!==t.top&&e.bottom!==t.bottom}var FS={width:90,height:20},gf="name",yf="text";function _c(e,t,n,i){U.call(this,e),this.postExecute("element.updateProperties",function(a){var o=a.context,s=o.element,u=o.properties;if(gf in u&&t.updateLabel(s,u[gf]),yf in u&&v(s,"bpmn:TextAnnotation")){var c=i.getTextAnnotationBounds({x:s.x,y:s.y,width:s.width,height:s.height},u[yf]||"");t.updateLabel(s,u.text,c)}}),this.postExecute(["shape.create","connection.create"],function(a){var o=a.context,s=o.hints||{};if(s.createElementsBehavior!==!1){var u=o.shape||o.connection,c=u.businessObject;if(!(Je(u)||!Bi(u))&&!!Ut(u)){var l=To(u),p=i.getExternalLabelBounds(FS,Ut(u));t.createLabel(u,l,{id:c.id+"_label",businessObject:c,width:p.width,height:p.height})}}}),this.postExecute("shape.delete",function(a){var o=a.context,s=o.labelTarget,u=o.hints||{};s&&u.unsetLabel!==!1&&t.updateLabel(s,null,null,{removeShape:!1})}),this.postExecute(["label.create"],function(a){var o=a.context,s=o.shape,u,c;!s.labelTarget||!v(s.labelTarget||s,"bpmn:BaseElement")||(u=s.businessObject,c=u.di,c.label||(c.label=n.create("bpmndi:BPMNLabel",{bounds:n.create("dc:Bounds")})),I(c.label.bounds,{x:s.x,y:s.y,width:s.width,height:s.height}))});function r(a){var o=a.context,s=o.connection,u=s.label,c=I({},o.hints),l=o.newWaypoints||s.waypoints,p=o.oldWaypoints;return typeof c.startChanged=="undefined"&&(c.startChanged=!!c.connectionStart),typeof c.endChanged=="undefined"&&(c.endChanged=!!c.connectionEnd),RS(u,l,p,c)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(a){var o=a.context,s=o.hints||{};if(s.labelBehavior!==!1){var u=o.connection,c=u.label,l;!c||!c.parent||(l=r(a),t.moveShape(c,l))}}),this.postExecute(["shape.replace"],function(a){var o=a.context,s=o.newShape,u=o.oldShape,c=Y(s);c&&Bi(c)&&u.label&&s.label&&(s.label.x=u.label.x,s.label.y=u.label.y)}),this.postExecute("shape.resize",function(a){var o=a.context,s=o.shape,u=o.newBounds,c=o.oldBounds;if(Co(s)){var l=s.label,p=ue(l),h=$S(c),f=LS(p,h),d=kS(f,c,u);t.moveShape(l,d)}})}Z(_c,U);_c.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];function kS(e,t,n){var i=Yr(e,t,n);return On(nn(i,e))}function LS(e,t){if(!!t.length){var n=jS(e,t);return Rm(e,n)}}function $S(e){return[[{x:e.x,y:e.y},{x:e.x+(e.width||0),y:e.y}],[{x:e.x+(e.width||0),y:e.y},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y+(e.height||0)},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y},{x:e.x,y:e.y+(e.height||0)}]]}function jS(e,t){var n=t.map(function(r){return{line:r,distance:xS(e,r)}}),i=Vt(n,"distance");return i[0].line}function zo(e,t,n){var i=Vo(e),r=Om(i,t),a=i[0];return r.length?r[r.length-1]:Yr(a.original||a,n,t)}function Go(e,t,n){var i=Vo(e),r=Om(i,t),a=i[i.length-1];return r.length?r[0]:Yr(a.original||a,n,t)}function wc(e,t,n){var i=Vo(e),r=Bm(t,n),a=i[0];return Yr(a.original||a,r,t)}function Sc(e,t,n){var i=Vo(e),r=Bm(t,n),a=i[i.length-1];return Yr(a.original||a,r,t)}function Bm(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Vo(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function Om(e,t){var n=Ye(e,zS);return se(n,function(i){return HS(i,t)})}function HS(e,t){return tt(t,e,1)==="intersect"}function zS(e){return e.original||e}function Cc(e,t){U.call(this,e),this.postExecute("shape.replace",function(n){var i=n.oldShape,r=n.newShape;if(!!GS(i,r)){var a=VS(i);a.incoming.forEach(function(o){var s=Go(o,r,i);t.reconnectEnd(o,r,s)}),a.outgoing.forEach(function(o){var s=zo(o,r,i);t.reconnectStart(o,r,s)})}},!0)}Cc.$inject=["eventBus","modeling"];Z(Cc,U);function GS(e,t){return v(e,"bpmn:Participant")&&Se(e)&&v(t,"bpmn:Participant")&&!Se(t)}function VS(e){var t=ho([e],!1),n=[],i=[];return t.forEach(function(r){r!==e&&(r.incoming.forEach(function(a){v(a,"bpmn:MessageFlow")&&n.push(a)}),r.outgoing.forEach(function(a){v(a,"bpmn:MessageFlow")&&i.push(a)}))},[]),{incoming:n,outgoing:i}}var WS="flow elements must be children of pools/participants";function Im(e,t,n){function i(r,a,o){t.add({position:{x:r.x+5,y:r.y+5},type:"error",timeout:o||2e3,html:"<div>"+a+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(r){var a=r.context,o=a.shape,s=a.target;v(s,"bpmn:Collaboration")&&v(o,"bpmn:FlowNode")&&i(r,n(WS))})}Im.$inject=["eventBus","tooltips","translate"];function Tc(e,t,n,i){U.call(this,e);var r=i.get("dragging",!1);function a(u){var c=u.source,l=u.target,p=u.parent;if(!!p){var h,f;v(u,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(c,l)||(f=!0),n.canConnectMessageFlow(c,l)&&(h="bpmn:MessageFlow")),v(u,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(c,l)||(f=!0),n.canConnectSequenceFlow(c,l)&&(h="bpmn:SequenceFlow")),v(u,"bpmn:Association")&&!n.canConnectAssociation(c,l)&&(f=!0),f&&t.removeConnection(u),h&&t.connect(c,l,{type:h,waypoints:u.waypoints.slice()})}}function o(u){var c=u.context,l=c.connection,p=c.newSource||l.source,h=c.newTarget||l.target,f,d;f=n.canConnect(p,h),!(!f||f.type===l.type)&&(d=t.connect(p,h,{type:f.type,waypoints:l.waypoints.slice()}),t.removeConnection(l),c.connection=d,r&&s(l,d))}function s(u,c){var l=r.context(),p=l&&l.payload.previousSelection,h;!p||!p.length||(h=p.indexOf(u),h!==-1&&p.splice(h,1,c))}this.postExecuted("elements.move",function(u){var c=u.closure,l=c.allConnections;A(l,a)},!0),this.preExecute("connection.reconnect",o),this.postExecuted("element.updateProperties",function(u){var c=u.context,l=c.properties,p=c.element,h=p.businessObject,f;l.default&&(f=_e(p.outgoing,Gt({id:p.businessObject.default.id})),f&&t.updateProperties(f,{conditionExpression:void 0})),l.conditionExpression&&h.sourceRef.default===h&&t.updateProperties(p.source,{default:void 0})})}Z(Tc,U);Tc.$inject=["eventBus","modeling","bpmnRules","injector"];function Ac(e,t){U.call(this,e),this.preExecute("shape.delete",function(n){var i=n.shape,r=i.parent;v(i,"bpmn:Participant")&&(n.collaborationRoot=r)},!0),this.postExecute("shape.delete",function(n){var i=n.collaborationRoot;i&&!i.businessObject.participants.length&&t.makeProcess()},!0)}Ac.$inject=["eventBus","modeling"];Z(Ac,U);function Wo(e,t,n,i,r,a){i.invoke(U,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=a,this.postExecuted(["elements.create"],500,function(o){var s=o.context,u=s.parent,c=s.elements,l=t.canReplace(c,u);l&&this.replaceElements(c,l.replacements)},this),this.postExecuted(["elements.move"],500,function(o){var s=o.context,u=s.newParent,c=s.newHost,l=[];A(s.closure.topLevel,function(h){_t(h)?l=l.concat(h.children):l=l.concat(h)}),l.length===1&&c&&(u=c);var p=t.canReplace(l,u);p&&this.replaceElements(l,p.replacements,c)},this),this.postExecute(["shape.replace"],1500,function(o){var s=o.context,u=s.oldShape,c=s.newShape,l=u.attachers,p;l&&l.length&&(p=t.canReplace(l,c),this.replaceElements(l,p.replacements))},this),this.postExecuted(["shape.replace"],1500,function(o){var s=o.context,u=s.oldShape,c=s.newShape;r.unclaimId(u.businessObject.id,u.businessObject),r.updateProperties(c,{id:u.id})})}Z(Wo,U);Wo.prototype.replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,r=this._selection;A(t,function(a){var o={type:a.newElementType},s=n.get(a.oldElementId),u=e.indexOf(s);e[u]=i.replaceElement(s,o,{select:!1})}),t&&r.select(e)};Wo.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var US=1500,oi={width:300,height:60},Tr={width:300,height:150},Nm={width:140,height:120},Fm={width:50,height:30};function km(e){e.on("resize.start",US,function(t){var n=t.context,i=n.shape,r=n.direction,a=n.balanced;(v(i,"bpmn:Lane")||v(i,"bpmn:Participant"))&&(n.resizeConstraints=QS(i,r,a)),v(i,"bpmn:Participant")&&(n.minDimensions=Tr),v(i,"bpmn:SubProcess")&&Se(i)&&(n.minDimensions=Nm),v(i,"bpmn:TextAnnotation")&&(n.minDimensions=Fm)})}km.$inject=["eventBus"];var Ma=Math.abs,YS=Math.min,qS=Math.max;function Lm(e,t,n,i){var r=e[t];e[t]=r===void 0?n:i(n,r)}function Ba(e,t,n){return Lm(e,t,n,YS)}function Oa(e,t,n){return Lm(e,t,n,qS)}var KS=20,XS=50,ZS=20,JS=20;function QS(e,t,n){var i=zt(e),r=!0,a=!0,o=No(i,[i]),s=ee(e),u={},c={};/e/.test(t)?c.right=s.left+oi.width:/w/.test(t)&&(c.left=s.right-oi.width),o.forEach(function(p){var h=ee(p);/n/.test(t)&&(h.top<s.top-10&&(r=!1),n&&Ma(s.top-h.bottom)<10&&Oa(u,"top",h.top+oi.height),Ma(s.top-h.top)<5&&Ba(c,"top",h.bottom-oi.height)),/s/.test(t)&&(h.bottom>s.bottom+10&&(a=!1),n&&Ma(s.bottom-h.top)<10&&Ba(u,"bottom",h.bottom-oi.height),Ma(s.bottom-h.bottom)<5&&Oa(c,"bottom",h.top+oi.height))});var l=i.children.filter(function(p){return!p.hidden&&!p.waypoints&&(v(p,"bpmn:FlowElement")||v(p,"bpmn:Artifact"))});return l.forEach(function(p){var h=ee(p);r&&/n/.test(t)&&Ba(c,"top",h.top-ZS),/e/.test(t)&&Oa(c,"right",h.right+KS),a&&/s/.test(t)&&Oa(c,"bottom",h.bottom+JS),/w/.test(t)&&Ba(c,"left",h.left-XS)}),{min:c,max:u}}var Ef=1001;function $m(e,t){e.on("resize.start",Ef+500,function(n){var i=n.context,r=i.shape;(v(r,"bpmn:Lane")||v(r,"bpmn:Participant"))&&(i.balanced=!Oi(n))}),e.on("resize.end",Ef,function(n){var i=n.context,r=i.shape,a=i.canExecute,o=i.newBounds;if(v(r,"bpmn:Lane")||v(r,"bpmn:Participant"))return a&&(o=Oh(o),t.resizeLane(r,o,i.balanced)),!1})}$m.$inject=["eventBus","modeling"];function Rc(e,t,n){U.call(this,e),this.preExecute("shape.delete",function(i){var r=i.context.shape;if(!(r.incoming.length!==1||r.outgoing.length!==1)){var a=r.incoming[0],o=r.outgoing[0];if(!(!v(a,"bpmn:SequenceFlow")||!v(o,"bpmn:SequenceFlow"))&&t.canConnect(a.source,o.target,a)){var s=e1(a.waypoints,o.waypoints);n.reconnectEnd(a,o.target,s)}}})}Z(Rc,U);Rc.$inject=["eventBus","bpmnRules","modeling"];function Ci(e){return e.original||e}function e1(e,t){var n=fu(Ci(e[e.length-2]),Ci(e[e.length-1]),Ci(t[1]),Ci(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[Ci(e[0]),Ci(t[t.length-1])]}var t1=Math.max;function jm(e){e.on("spaceTool.getMinDimensions",function(t){var n=t.shapes,i=t.axis,r=t.start,a={};return A(n,function(o){var s=o.id;v(o,"bpmn:Participant")&&(n1(i)?a[s]=Tr:a[s]={width:Tr.width,height:i1(o,r)}),v(o,"bpmn:SubProcess")&&Se(o)&&(a[s]=Nm),v(o,"bpmn:TextAnnotation")&&(a[s]=Fm)}),a})}jm.$inject=["eventBus"];function n1(e){return e==="x"}function i1(e,t){var n;return r1(e)?(n=a1(e,t),t1(Tr.height,n)):Tr.height}function r1(e){return!!di(e).length}function a1(e,t){var n=di(e),i;return i=Hm(n,t),e.height-i.height+oi.height}function Hm(e,t){var n,i,r;for(n=0;n<e.length;n++)if(i=e[n],t>=i.y&&t<=i.y+i.height)return r=di(i),r.length?Hm(r,t):i}function Pc(e,t){e.invoke(U,this),this.postExecuted("shape.replace",function(n){var i=n.context.oldShape,r=n.context.newShape;if(!(!v(r,"bpmn:SubProcess")||!v(i,"bpmn:Task")||!Se(r))){var a=o1(r);t.createShape({type:"bpmn:StartEvent"},a,r)}})}Pc.$inject=["injector","modeling"];Z(Pc,U);function o1(e){return{x:e.x+e.width/6,y:e.y+e.height/2}}var Rs=500;function Dc(e,t,n,i){U.call(this,e);function r(s){s.length&&s.forEach(function(u){u.type==="label"&&!u.businessObject.name&&(u.hidden=!0)})}function a(s,u){var c=s.children,l=u,p,h;return p=s1(c).concat([s]),h=cm(p),h?(l.width=Math.max(h.width,l.width),l.height=Math.max(h.height,l.height),l.x=h.x+(h.width-l.width)/2,l.y=h.y+(h.height-l.height)/2):(l.x=s.x+(s.width-l.width)/2,l.y=s.y+(s.height-l.height)/2),l}function o(s,u){return{x:s.x+(s.width-u.width)/2,y:s.y+(s.height-u.height)/2,width:u.width,height:u.height}}this.executed(["shape.toggleCollapse"],Rs,function(s){var u=s.context,c=u.shape;!v(c,"bpmn:SubProcess")||(c.collapsed?Y(c).di.isExpanded=!1:(r(c.children),Y(c).di.isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],Rs,function(s){var u=s.context,c=u.shape;c.collapsed?Y(c).di.isExpanded=!1:Y(c).di.isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],Rs,function(s){var u=s.context.shape,c=t._getDefaultSize(u),l;u.collapsed?l=o(u,c):l=a(u,c),n.resizeShape(u,l,null,{autoResize:u.collapsed?!1:"nwse"})})}Z(Dc,U);Dc.$inject=["eventBus","elementFactory","modeling"];function s1(e){return e.filter(function(t){return!t.hidden})}function Mc(e,t,n,i){t.invoke(U,this),this.preExecute("shape.delete",function(r){var a=r.context,o=a.shape,s=o.businessObject;Je(o)||(v(o,"bpmn:Participant")&&Se(o)&&n.ids.unclaim(s.processRef.id),i.unclaimId(s.id,s))}),this.preExecute("connection.delete",function(r){var a=r.context,o=a.connection,s=o.businessObject;i.unclaimId(s.id,s)}),this.preExecute("canvas.updateRoot",function(){var r=e.getRootElement(),a=r.businessObject;v(r,"bpmn:Collaboration")&&n.ids.unclaim(a.id)})}Z(Mc,U);Mc.$inject=["canvas","injector","moddle","modeling"];var u1=500,c1=5e3;function Bc(e,t,n){U.call(this,e);var i;function r(){return i=i||new l1,i.enter(),i}function a(){if(!i)throw new Error(n("out of bounds release"));return i}function o(){if(!i)throw new Error(n("out of bounds release"));var u=i.leave();return u&&(t.updateLaneRefs(i.flowNodes,i.lanes),i=null),u}var s=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(s,c1,function(u){r()}),this.postExecuted(s,u1,function(u){o()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(u){var c=u.context,l=c.shape,p=a();l.labelTarget||(v(l,"bpmn:Lane")&&p.addLane(l),v(l,"bpmn:FlowNode")&&p.addFlowNode(l))})}Bc.$inject=["eventBus","modeling","translate"];Z(Bc,U);function l1(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function Oc(e,t){U.call(this,e),this.preExecute("connection.delete",function(n){var i=n.context,r=i.connection,a=r.source;p1(r,a)&&t.updateProperties(a,{default:null})})}Z(Oc,U);Oc.$inject=["eventBus","modeling"];function p1(e,t){if(!v(e,"bpmn:SequenceFlow"))return!1;var n=Y(t),i=Y(e);return n.get("default")===i}var f1={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataStoreBehavior","dataInputAssociationBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","messageFlowBehavior","modelingFeedback","removeElementBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","unsetDefaultFlowBehavior","updateFlowNodeRefsBehavior"],adaptiveLabelPositioningBehavior:["type",sc],appendBehavior:["type",uc],associationBehavior:["type",cc],attachEventBehavior:["type",$o],boundaryEventBehavior:["type",lc],rootElementReferenceBehavior:["type",pc],createBehavior:["type",fc],fixHoverBehavior:["type",Sm],createDataObjectBehavior:["type",hc],createParticipantBehavior:["type",dc],dataInputAssociationBehavior:["type",mc],dataStoreBehavior:["type",vc],deleteLaneBehavior:["type",gc],detachEventBehavior:["type",Ho],dropOnFlowBehavior:["type",yc],eventBasedGatewayBehavior:["type",Ec],groupBehavior:["type",bc],importDockingFix:["type",Tm],isHorizontalFix:["type",xc],labelBehavior:["type",_c],messageFlowBehavior:["type",Cc],modelingFeedback:["type",Im],replaceConnectionBehavior:["type",Tc],removeParticipantBehavior:["type",Ac],replaceElementBehaviour:["type",Wo],resizeBehavior:["type",km],resizeLaneBehavior:["type",$m],removeElementBehavior:["type",Rc],toggleElementCollapseBehaviour:["type",Dc],spaceToolBehavior:["type",jm],subProcessStartEventBehavior:["type",Pc],unclaimIdBehavior:["type",Mc],updateFlowNodeRefsBehavior:["type",Bc],unsetDefaultFlowBehavior:["type",Oc]};function zm(e,t){var n=tt(e,t,-15);return n!=="intersect"?n:null}function nt(e){Vn.call(this,e)}Z(nt,Vn);nt.$inject=["eventBus"];nt.prototype.init=function(){this.addRule("connection.start",function(e){var t=e.source;return h1(t)}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},r=i.targetParent,a=i.targetAttach;if(a)return!1;r&&(n.parent=r);try{return Wa(t,n)}finally{r&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection,n=e.source,i=e.target;return Wa(n,i,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){var t=e.shape,n=e.newBounds;return Km(t,n)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return uo(i)&&!co(t,i)?!1:Fi(t,function(r){return uo(r)?Wa(r.source,r.target,r):r.host?Er(r,r.host,null,n):vu(r,i,null)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return Er(n,t,null,i)||Ym(n,t,i)||qm(n,t)||co(n,t)}),this.addRule("shape.create",function(e){return vu(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return Er(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element,n=e.elements;return Qm(n,t)})};nt.prototype.canConnectMessageFlow=Zm;nt.prototype.canConnectSequenceFlow=Jm;nt.prototype.canConnectDataAssociation=Fc;nt.prototype.canConnectAssociation=Xm;nt.prototype.canMove=qm;nt.prototype.canAttach=Er;nt.prototype.canReplace=Ym;nt.prototype.canDrop=Ni;nt.prototype.canInsert=co;nt.prototype.canCreate=vu;nt.prototype.canConnect=Wa;nt.prototype.canResize=Km;nt.prototype.canCopy=Qm;function h1(e){return hu(e)?null:ye(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}function hu(e){return!e||Je(e)}function d1(e,t){return e===t}function bf(e){do{if(v(e,"bpmn:Process"))return Y(e);if(v(e,"bpmn:Participant"))return Y(e).processRef||Y(e)}while(e=e.parent)}function du(e){return v(e,"bpmn:TextAnnotation")}function Ic(e){return v(e,"bpmn:Group")&&!e.labelTarget}function Nc(e){return v(e,"bpmn:BoundaryEvent")&&en(e,"bpmn:CompensateEventDefinition")}function Xi(e){return Y(e).isForCompensation}function m1(e,t){var n=bf(e),i=bf(t);return n===i}function v1(e){return v(e,"bpmn:InteractionNode")&&!v(e,"bpmn:BoundaryEvent")&&(!v(e,"bpmn:Event")||v(e,"bpmn:ThrowEvent")&&Gm(e,"bpmn:MessageEventDefinition"))}function g1(e){return v(e,"bpmn:InteractionNode")&&!Xi(e)&&(!v(e,"bpmn:Event")||v(e,"bpmn:CatchEvent")&&Gm(e,"bpmn:MessageEventDefinition"))&&!(v(e,"bpmn:BoundaryEvent")&&!en(e,"bpmn:MessageEventDefinition"))}function xf(e){for(var t=e;t=t.parent;){if(v(t,"bpmn:FlowElementsContainer"))return Y(t);if(v(t,"bpmn:Participant"))return Y(t).processRef}return null}function y1(e,t){var n=xf(e),i=xf(t);return n===i}function en(e,t){var n=Y(e);return!!_e(n.eventDefinitions||[],function(i){return v(i,t)})}function Gm(e,t){var n=Y(e);return(n.eventDefinitions||[]).every(function(i){return v(i,t)})}function E1(e){return v(e,"bpmn:FlowNode")&&!v(e,"bpmn:EndEvent")&&!_t(e)&&!(v(e,"bpmn:IntermediateThrowEvent")&&en(e,"bpmn:LinkEventDefinition"))&&!Nc(e)&&!Xi(e)}function b1(e){return v(e,"bpmn:FlowNode")&&!v(e,"bpmn:StartEvent")&&!v(e,"bpmn:BoundaryEvent")&&!_t(e)&&!(v(e,"bpmn:IntermediateCatchEvent")&&en(e,"bpmn:LinkEventDefinition"))&&!Xi(e)}function _f(e){return v(e,"bpmn:ReceiveTask")||v(e,"bpmn:IntermediateCatchEvent")&&(en(e,"bpmn:MessageEventDefinition")||en(e,"bpmn:TimerEventDefinition")||en(e,"bpmn:ConditionalEventDefinition")||en(e,"bpmn:SignalEventDefinition"))}function uo(e){return e.waypoints}function x1(e){for(var t=[];e;)e=e.parent,e&&t.push(e);return t}function mu(e,t){var n=x1(t);return n.indexOf(e)!==-1}function Wa(e,t,n){if(hu(e)||hu(t))return null;if(!v(n,"bpmn:DataAssociation")){if(Zm(e,t))return{type:"bpmn:MessageFlow"};if(Jm(e,t))return{type:"bpmn:SequenceFlow"}}var i=Fc(e,t);return i||(Nc(e)&&Xi(t)?{type:"bpmn:Association",associationDirection:"One"}:Xm(e,t)?{type:"bpmn:Association"}:!1)}function Ni(e,t,n){return Je(e)||Ic(e)?!0:v(t,"bpmn:Participant")&&!Se(t)?!1:v(e,"bpmn:Participant")?v(t,"bpmn:Process")||v(t,"bpmn:Collaboration"):ye(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:v(e,"bpmn:Lane")?v(t,"bpmn:Participant")||v(t,"bpmn:Lane"):v(e,"bpmn:BoundaryEvent")&&!_1(e)?!1:v(e,"bpmn:FlowElement")&&!v(e,"bpmn:DataStoreReference")?v(t,"bpmn:FlowElementsContainer")?Se(t):ye(t,["bpmn:Participant","bpmn:Lane"]):v(e,"bpmn:DataStoreReference")&&v(t,"bpmn:Collaboration")?ci(Y(t).get("participants"),function(i){return!!i.get("processRef")}):ye(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?ye(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):v(e,"bpmn:MessageFlow")?v(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t:!1}function _1(e){return Y(e).cancelActivity&&(Vm(e)||Wm(e))}function w1(e){return!Je(e)&&v(e,"bpmn:BoundaryEvent")}function S1(e){return v(e,"bpmn:Lane")}function C1(e){return w1(e)||v(e,"bpmn:IntermediateThrowEvent")&&Vm(e)?!0:v(e,"bpmn:IntermediateCatchEvent")&&Wm(e)}function Vm(e){var t=Y(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function Wm(e){return Um(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function Um(e,t){return t.some(function(n){return en(e,n)})}function T1(e){return v(e,"bpmn:ReceiveTask")&&_e(e.incoming,function(t){return v(t.source,"bpmn:EventBasedGateway")})}function Er(e,t,n,i){if(Array.isArray(e)||(e=[e]),e.length!==1)return!1;var r=e[0];return Je(r)||!C1(r)||_t(t)||!v(t,"bpmn:Activity")||Xi(t)||i&&!zm(i,t)||T1(t)?!1:"attach"}function Ym(e,t,n){if(!t)return!1;var i={replacements:[]};return A(e,function(r){_t(t)||v(r,"bpmn:StartEvent")&&r.type!=="label"&&Ni(r,t)&&(Lb(r)||i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),($b(r)||jb(r)||Hb(r))&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),Um(r,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&v(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"})),v(t,"bpmn:Transaction")||en(r,"bpmn:CancelEventDefinition")&&r.type!=="label"&&(v(r,"bpmn:EndEvent")&&Ni(r,t)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:EndEvent"}),v(r,"bpmn:BoundaryEvent")&&Er(r,t,null,n)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:BoundaryEvent"}))}),i.replacements.length?i:!1}function qm(e,t){return ci(e,S1)?!1:t?e.every(function(n){return Ni(n,t)}):!0}function vu(e,t,n,i){return t?Je(e)||Ic(e)?!0:d1(n,t)||n&&mu(n,t)?!1:Ni(e,t)||co(e,t):!1}function Km(e,t){return v(e,"bpmn:SubProcess")?Se(e)&&(!t||t.width>=100&&t.height>=80):v(e,"bpmn:Lane")?!t||t.width>=130&&t.height>=60:v(e,"bpmn:Participant")?!t||t.width>=250&&t.height>=50:!!(du(e)||Ic(e))}function A1(e,t){var n=du(e),i=du(t);return(n||i)&&n!==i}function Xm(e,t){return uo(e)||uo(t)?!1:Nc(e)&&Xi(t)?!0:mu(t,e)||mu(e,t)?!1:A1(e,t)?!0:!!Fc(e,t)}function Zm(e,t){return wf(e)&&!wf(t)?!1:v1(e)&&g1(t)&&!m1(e,t)}function Jm(e,t){return _f(t)&&t.incoming.length>0&&D1(t.incoming)&&!v(e,"bpmn:EventBasedGateway")?!1:E1(e)&&b1(t)&&y1(e,t)&&!(v(e,"bpmn:EventBasedGateway")&&!_f(t))}function Fc(e,t){return ye(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ye(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:ye(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ye(e,["bpmn:Activity","bpmn:CatchEvent"])?{type:"bpmn:DataOutputAssociation"}:!1}function co(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(e.length!==1)return!1;e=e[0]}return t.source===e||t.target===e?!1:ye(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!Je(t)&&v(e,"bpmn:FlowNode")&&!v(e,"bpmn:BoundaryEvent")&&Ni(e,t.parent)}function R1(e,t){return e&&t&&e.indexOf(t)!==-1}function Qm(e,t){return Je(t)?!0:!(v(t,"bpmn:Lane")&&!R1(e,t.parent))}function P1(e){if(e&&e.source)return v(e.source,"bpmn:EventBasedGateway")}function D1(e){return e=e||[],e.some(P1)}function wf(e){return no(e,"bpmn:Process")||no(e,"bpmn:Collaboration")}var M1={__depends__:[cn],__init__:["bpmnRules"],bpmnRules:["type",nt]},B1=2e3;function ev(e,t){e.on("saveXML.start",B1,n);function n(){var i=t.getRootElement(),r=Y(i).di,a,o;a=ho([i],!1),a=se(a,function(s){return s!==i&&!s.labelTarget}),o=Ye(a,Mi),r.set("planeElement",o)}}ev.$inject=["eventBus","canvas"];var O1={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",ev]};function Uo(e){U.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(n){var i=n.context,r=i.shape||i.connection,a=i.parent,o=t.getOrdering(r,a);o&&(o.parent!==void 0&&(i.parent=o.parent),i.parentIndex=o.index)}),this.preExecute(["shape.move","connection.move"],function(n){var i=n.context,r=i.shape||i.connection,a=i.newParent||r.parent,o=t.getOrdering(r,a);o&&(o.parent!==void 0&&(i.newParent=o.parent),i.newParentIndex=o.index)})}Uo.prototype.getOrdering=function(e,t){return null};Z(Uo,U);function kc(e,t,n){Uo.call(this,e);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function r(s){if(s.labelTarget)return{level:10};var u=_e(i,function(c){return ye(s,[c.type])});return u&&u.order||{level:1}}function a(s){var u=s.order;if(u||(s.order=u=r(s)),!u)throw new Error("no order for <"+s.id+">");return u}function o(s,u,c){for(var l=u;l&&!ye(l,c);)l=l.parent;if(!l)throw new Error("no parent for <"+s.id+"> in <"+(u&&u.id)+">");return l}this.getOrdering=function(s,u){if(s.labelTarget)return{parent:t.getRootElement(),index:-1};var c=a(s);c.containers&&(u=o(s,u,c.containers));var l=u.children.indexOf(s),p=Rg(u.children,function(h){return!s.labelTarget&&h.labelTarget?!1:c.level<a(h).level});return p!==-1&&l!==-1&&l<p&&(p-=1),{index:p,parent:u}}}kc.$inject=["eventBus","canvas","translate"];Z(kc,Uo);var I1={__depends__:[So],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",kc]};function Me(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}Me.$inject=["eventBus","injector"];Me.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)};Me.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),r=this._fire(e,"canExecute",n);if(r===void 0){if(!i)return!1;i.canExecute&&(r=i.canExecute(t))}return r};Me.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,e!==!1&&this._fire("changed",{trigger:"clear"})};Me.prototype.undo=function(){var e=this._getUndoAction(),t;if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),t=this._getUndoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};Me.prototype.redo=function(){var e=this._getRedoAction(),t;if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),t=this._getRedoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};Me.prototype.register=function(e,t){this._setHandler(e,t)};Me.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)};Me.prototype.canUndo=function(){return!!this._getUndoAction()};Me.prototype.canRedo=function(){return!!this._getRedoAction()};Me.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]};Me.prototype._getUndoAction=function(){return this._stack[this._stackIdx]};Me.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,r=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),r.revert&&t._markDirty(r.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})};Me.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i=t?[e+"."+t,t]:[e],r,a,o;for(n=this._eventBus.createEvent(n),r=0;(a=i[r])&&(o=this._eventBus.fire("commandStack."+a,n),!n.cancelBubble);r++);return o};Me.prototype._createId=function(){return this._uid++};Me.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}};Me.prototype._internalExecute=function(e,t){var n=this,i=e.command,r=e.context,a=this._getHandler(i);if(!a)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),a.preExecute&&a.preExecute(r),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),a.execute&&n._markDirty(a.execute(r)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),a.postExecute&&a.postExecute(r),this._fire(i,"postExecuted",e)),this._popAction(e)};Me.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)};Me.prototype._popAction=function(){var e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:fh("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)};Me.prototype._markDirty=function(e){var t=this._currentExecution;!e||(e=he(e)?e:[e],t.dirty=t.dirty.concat(e))};Me.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)};Me.prototype._revertedAction=function(e){this._stackIdx--};Me.prototype._getHandler=function(e){return this._handlerMap[e]};Me.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};var N1={commandStack:["type",Me]},F1=new Vu("tt");function k1(e){var t=Ae('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />');return e.insertBefore(t,e.firstChild),t}function L1(e,t,n){I(e.style,{left:t+"px",top:n+"px"})}function Lc(e,t){e.style.display=t===!1?"none":""}var tv="djs-tooltip",Ps="."+tv;function ht(e,t){this._eventBus=e,this._canvas=t,this._ids=F1,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=k1(t.getContainer());var n=this;xt.bind(this._tooltipRoot,Ps,"mousedown",function(i){i.stopPropagation()}),xt.bind(this._tooltipRoot,Ps,"mouseover",function(i){n.trigger("mouseover",i)}),xt.bind(this._tooltipRoot,Ps,"mouseout",function(i){n.trigger("mouseout",i)}),this._init()}ht.$inject=["eventBus","canvas"];ht.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=I({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t};ht.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get(St(n,"data-tooltip-id"));!i||(e==="mouseover"&&i.timeout&&this.clearTimeout(i),e==="mouseout"&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))};ht.prototype.get=function(e){return typeof e!="string"&&(e=e.id),this._tooltips[e]};ht.prototype.clearTimeout=function(e){if(e=this.get(e),!!e){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}};ht.prototype.setTimeout=function(e){if(e=this.get(e),!!e){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}};ht.prototype.remove=function(e){var t=this.get(e);t&&(on(t.html),on(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])};ht.prototype.show=function(){Lc(this._tooltipRoot)};ht.prototype.hide=function(){Lc(this._tooltipRoot,!1)};ht.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i};ht.prototype._addTooltip=function(e){var t=e.id,n=e.html,i,r=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),Dt(n)&&(n=Ae(n)),i=Ae('<div data-tooltip-id="'+t+'" class="'+tv+'" style="position: absolute">'),i.appendChild(n),e.type&&ze(i).add("djs-tooltip-"+e.type),e.className&&ze(i).add(e.className),e.htmlContainer=i,r.appendChild(i),this._tooltips[t]=e,this._updateTooltip(e)};ht.prototype._updateTooltip=function(e){var t=e.position,n=e.htmlContainer;L1(n,t.x,t.y)};ht.prototype._updateTooltipVisibilty=function(e){A(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,r=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(r=!1),Lc(i,r))})};ht.prototype._init=function(){var e=this;function t(n){e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()}this._eventBus.on("canvas.viewbox.changing",function(n){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(n){t(n.viewbox)})};var $1={__init__:["tooltips"],tooltips:["type",ht]};function Ai(e,t){if(typeof t!="function")throw new Error("removeFn iterator must be a function");if(!!e){for(var n;n=e[0];)t(n);return e}}var j1=250,Sf=1400;function $c(e,t,n){U.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",Sf,function(r){var a=r.context,o=a.shapes,s=a.validatedShapes;a.shapes=Cf(o),a.validatedShapes=Cf(s)}),i&&t.on("shape.move.start",j1,function(r){var a=r.context,o=a.shapes,s=[];A(o,function(u){A(u.labels,function(c){!c.hidden&&a.shapes.indexOf(c)===-1&&s.push(c),u.labelTarget&&s.push(u)})}),A(s,function(u){i.makeDraggable(a,u,!0)})}),this.preExecuted("elements.move",Sf,function(r){var a=r.context,o=a.closure,s=o.enclosedElements,u=[];A(s,function(c){A(c.labels,function(l){s[l.id]||u.push(l)})}),o.addAll(u)}),this.preExecute(["connection.delete","shape.delete"],function(r){var a=r.context,o=a.connection||a.shape;Ai(o.labels,function(s){n.removeShape(s,{nested:!0})})}),this.execute("shape.delete",function(r){var a=r.context,o=a.shape,s=o.labelTarget;s&&(a.labelTargetIndex=Mu(s.labels,o),a.labelTarget=s,o.labelTarget=null)}),this.revert("shape.delete",function(r){var a=r.context,o=a.shape,s=a.labelTarget,u=a.labelTargetIndex;s&&(Fe(s.labels,o,u),o.labelTarget=s)})}Z($c,U);$c.$inject=["injector","eventBus","modeling"];function Cf(e){return se(e,function(t){return e.indexOf(t.labelTarget)===-1})}var H1={__init__:["labelSupport"],labelSupport:["type",$c]},z1=251,Tf=1401,Af="attach-ok";function jc(e,t,n,i,r){U.call(this,t);var a=e.get("movePreview",!1);t.on("shape.move.start",Tf,function(o){var s=o.context,u=s.shapes,c=s.validatedShapes;s.shapes=G1(u),s.validatedShapes=V1(c)}),a&&t.on("shape.move.start",z1,function(o){var s=o.context,u=s.shapes,c=gu(u);A(c,function(l){a.makeDraggable(s,l,!0),A(l.labels,function(p){a.makeDraggable(s,p,!0)})})}),a&&t.on("shape.move.start",function(o){var s=o.context,u=s.shapes;if(u.length===1){var c=u[0],l=c.host;l&&(n.addMarker(l,Af),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(l,Af)}))}}),this.preExecuted("elements.move",Tf,function(o){var s=o.context,u=s.closure,c=s.shapes,l=gu(c);A(l,function(p){u.add(p,u.topLevel[p.host.id])})}),this.postExecuted("elements.move",function(o){var s=o.context,u=s.shapes,c=s.newHost,l;c&&u.length!==1||(c?l=u:l=se(u,function(p){var h=p.host;return W1(p)&&!U1(u,h)}),A(l,function(p){r.updateAttachment(p,c)}))}),this.postExecuted("elements.move",function(o){var s=o.context.shapes;A(s,function(u){A(u.attachers,function(c){A(c.outgoing.slice(),function(l){var p=i.allowed("connection.reconnect",{connection:l,source:l.source,target:l.target});p||r.removeConnection(l)}),A(c.incoming.slice(),function(l){var p=i.allowed("connection.reconnect",{connection:l,source:l.source,target:l.target});p||r.removeConnection(l)})})})}),this.postExecute("shape.create",function(o){var s=o.context,u=s.shape,c=s.host;c&&r.updateAttachment(u,c)}),this.postExecute("shape.replace",function(o){var s=o.context,u=s.oldShape,c=s.newShape;Ai(u.attachers,function(l){var p=i.allowed("elements.move",{target:c,shapes:[l]});p==="attach"?r.updateAttachment(l,c):r.removeShape(l)}),c.attachers.length&&A(c.attachers,function(l){var p=vf(l,u,c);r.moveShape(l,p,l.parent)})}),this.postExecute("shape.resize",function(o){var s=o.context,u=s.shape,c=s.oldBounds,l=s.newBounds,p=u.attachers,h=s.hints||{};h.attachSupport!==!1&&A(p,function(f){var d=vf(f,c,l);r.moveShape(f,d,f.parent),A(f.labels,function(y){r.moveShape(y,d,y.parent)})})}),this.preExecute("shape.delete",function(o){var s=o.context.shape;Ai(s.attachers,function(u){r.removeShape(u)}),s.host&&r.updateAttachment(s,null)})}Z(jc,U);jc.$inject=["injector","eventBus","canvas","rules","modeling"];function gu(e){return Ya(Ye(e,function(t){return t.attachers||[]}))}function G1(e){var t=gu(e);return Dg("id",e,t)}function V1(e){var t=ki(e,"id");return se(e,function(n){for(;n;){if(n.host&&t[n.host.id])return!1;n=n.parent}return!0})}function W1(e){return!!e.host}function U1(e,t){return e.indexOf(t)!==-1}var Y1={__depends__:[cn],__init__:["attachSupport"],attachSupport:["type",jc]},q1=250;function vi(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}vi.$inject=["eventBus","dragging"];vi.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error(`A tool has to be registered with it's "events"`);n.push(e),this.bindEvents(e,t)};vi.prototype.isActive=function(e){return e&&this._active===e};vi.prototype.length=function(e){return this._tools.length};vi.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))};vi.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,r=[];n.on(t.tool+".init",function(a){var o=a.context;if(!o.reactivate&&this.isActive(e)){this.setActive(null),i.cancel();return}this.setActive(e)},this),A(t,function(a){r.push(a+".ended"),r.push(a+".canceled")}),n.on(r,q1,function(a){!this._active||K1(a)||this.setActive(null)},this)};function K1(e){var t=e.originalEvent&&e.originalEvent.target;return t&&li(t,'.group[data-group="tools"]')}var Yo={__depends__:[wn],__init__:["toolManager"],toolManager:["type",vi]};function X1(e,t){if(e==="x"){if(t>0)return"e";if(t<0)return"w"}if(e==="y"){if(t>0)return"s";if(t<0)return"n"}return null}function Z1(e,t){var n=[];return A(e.concat(t),function(i){var r=i.incoming,a=i.outgoing;A(r.concat(a),function(o){var s=o.source,u=o.target;(pr(e,s)||pr(e,u)||pr(t,s)||pr(t,u))&&(pr(n,o)||n.push(o))})}),n}function pr(e,t){return e.indexOf(t)!==-1}function J1(e,t,n){var i=e.x,r=e.y,a=e.width,o=e.height,s=n.x,u=n.y;switch(t){case"n":return{x:i,y:r+u,width:a,height:o-u};case"s":return{x:i,y:r,width:a,height:o+u};case"w":return{x:i+s,y:r,width:a-s,height:o};case"e":return{x:i,y:r,width:a+s,height:o};default:throw new Error("unknown direction: "+t)}}var Ds=Math.abs,Q1=Math.round,dn={x:"width",y:"height"},nv="crosshair",Ia={n:"top",w:"left",s:"bottom",e:"right"},eC=1500,Rf={n:"s",w:"e",s:"n",e:"w"},Na=20;function Tn(e,t,n,i,r,a,o){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=r,this._toolManager=a,this._mouse=o;var s=this;a.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(u){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(u.originalEvent)})}),n.on("spaceTool.move",eC,function(u){var c=u.context,l=c.initialized;l||(l=c.initialized=s.init(u,c)),l&&Df(u)}),n.on("spaceTool.end",function(u){var c=u.context,l=c.axis,p=c.direction,h=c.movingShapes,f=c.resizingShapes,d=c.start;if(!!c.initialized){Df(u);var y={x:0,y:0};y[l]=Q1(u["d"+l]),s.makeSpace(h,f,y,p,d),n.once("spaceTool.ended",function(x){s.activateSelection(x.originalEvent,!0,!0)})}})}Tn.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"];Tn.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:nv,data:{context:{reactivate:n}},trapClick:!1})};Tn.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:nv,data:{context:{}}})};Tn.prototype.makeSpace=function(e,t,n,i,r){return this._modeling.createSpace(e,t,n,i,r)};Tn.prototype.init=function(e,t){var n=Ds(e.dx)>Ds(e.dy)?"x":"y",i=e["d"+n],r=e[n]-i;if(Ds(i)<5)return!1;i<0&&(i*=-1),Oi(e)&&(i*=-1);var a=X1(n,i),o=this._canvas.getRootElement(),s=ho(o,!0),u=this.calculateAdjustments(s,n,i,r),c=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:a,shapes:u.resizingShapes,start:r}),l=tC(u,n,a,r,c);return I(t,u,{axis:n,direction:a,spaceToolConstraints:l,start:r}),Po("resize-"+(n==="x"?"ew":"ns")),!0};Tn.prototype.calculateAdjustments=function(e,t,n,i){var r=this._rules,a=[],o=[];return A(e,function(s){if(!(!s.parent||yu(s))){var u=s[t],c=u+s[dn[t]];if(n>0&&u>i||n<0&&c<i)return a.push(s);if(u<i&&c>i&&r.allowed("shape.resize",{shape:s}))return o.push(s)}}),{movingShapes:a,resizingShapes:o}};Tn.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};Tn.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};function Pf(e){return{top:e.top-Na,right:e.right+Na,bottom:e.bottom+Na,left:e.left-Na}}function Df(e){var t=e.context,n=t.spaceToolConstraints;if(!!n){var i,r;ae(n.left)&&(i=Math.max(e.x,n.left),e.dx=e.dx+i-e.x,e.x=i),ae(n.right)&&(i=Math.min(e.x,n.right),e.dx=e.dx+i-e.x,e.x=i),ae(n.top)&&(r=Math.max(e.y,n.top),e.dy=e.dy+r-e.y,e.y=r),ae(n.bottom)&&(r=Math.min(e.y,n.bottom),e.dy=e.dy+r-e.y,e.y=r)}}function tC(e,t,n,i,r){var a=e.movingShapes,o=e.resizingShapes;if(!!o.length){var s={},u,c;return A(o,function(l){var p=ee(l),h=se(l.children,function(P){return!yu(P)&&!Mf(P)&&!Ms(a,P)&&!Ms(o,P)}),f=se(l.children,function(P){return!yu(P)&&!Mf(P)&&Ms(a,P)}),d,y,x;h.length&&(y=Pf(ee(et(h))),d=i-p[Ia[n]]+y[Ia[n]],n==="n"?s.bottom=c=ae(c)?Math.min(c,d):d:n==="w"?s.right=c=ae(c)?Math.min(c,d):d:n==="s"?s.top=u=ae(u)?Math.max(u,d):d:n==="e"&&(s.left=u=ae(u)?Math.max(u,d):d)),f.length&&(x=Pf(ee(et(f))),d=i-x[Ia[Rf[n]]]+p[Ia[Rf[n]]],n==="n"?s.bottom=c=ae(c)?Math.min(c,d):d:n==="w"?s.right=c=ae(c)?Math.min(c,d):d:n==="s"?s.top=u=ae(u)?Math.max(u,d):d:n==="e"&&(s.left=u=ae(u)?Math.max(u,d):d));var M=r&&r[l.id];M&&(n==="n"?(d=i+l[dn[t]]-M[dn[t]],s.bottom=c=ae(c)?Math.min(c,d):d):n==="w"?(d=i+l[dn[t]]-M[dn[t]],s.right=c=ae(c)?Math.min(c,d):d):n==="s"?(d=i-l[dn[t]]+M[dn[t]],s.top=u=ae(u)?Math.max(u,d):d):n==="e"&&(d=i-l[dn[t]]+M[dn[t]],s.left=u=ae(u)?Math.max(u,d):d))}),s}}function Ms(e,t){return e.indexOf(t)!==-1}function yu(e){return!!e.waypoints}function Mf(e){return!!e.labelTarget}var Bs="djs-dragging",Bf="djs-resizing",nC=250,Fa=Math.max;function iv(e,t,n,i,r){function a(o,s){A(o,function(u){r.addDragger(u,s),n.addMarker(u,Bs)})}e.on("spaceTool.selection.start",function(o){var s=n.getLayer("space"),u=o.context,c={x:"M 0,-10000 L 0,10000",y:"M -10000,0 L 10000,0"},l=J("g");H(l,i.cls("djs-crosshair-group",["no-events"])),ne(s,l);var p=J("path");H(p,"d",c.x),fe(p).add("djs-crosshair"),ne(l,p);var h=J("path");H(h,"d",c.y),fe(h).add("djs-crosshair"),ne(l,h),u.crosshairGroup=l}),e.on("spaceTool.selection.move",function(o){var s=o.context.crosshairGroup;mt(s,o.x,o.y)}),e.on("spaceTool.selection.cleanup",function(o){var s=o.context,u=s.crosshairGroup;u&&ke(u)}),e.on("spaceTool.move",nC,function(o){var s=o.context,u=s.line,c=s.axis,l=s.movingShapes,p=s.resizingShapes;if(!!s.initialized){if(!s.dragGroup){var h=n.getLayer("space");u=J("path"),H(u,"d","M0,0 L0,0"),fe(u).add("djs-crosshair"),ne(h,u),s.line=u;var f=J("g");H(f,i.cls("djs-drag-group",["no-events"])),ne(n.getActiveLayer(),f),a(l,f);var d=s.movingConnections=t.filter(function(b){var _=!1;A(l,function(L){A(L.outgoing,function(z){b===z&&(_=!0)})});var D=!1;A(l,function(L){A(L.incoming,function(z){b===z&&(D=!0)})});var B=!1;A(p,function(L){A(L.outgoing,function(z){b===z&&(B=!0)})});var R=!1;return A(p,function(L){A(L.incoming,function(z){b===z&&(R=!0)})}),iC(b)&&(_||B)&&(D||R)});a(d,f),s.dragGroup=f}if(!s.frameGroup){var y=J("g");H(y,i.cls("djs-frame-group",["no-events"])),ne(n.getActiveLayer(),y);var x=[];A(p,function(b){var _=r.addFrame(b,y),D=_.getBBox();x.push({element:_,initialBounds:D}),n.addMarker(b,Bf)}),s.frameGroup=y,s.frames=x}var M={x:"M"+o.x+", -10000 L"+o.x+", 10000",y:"M -10000, "+o.y+" L 10000, "+o.y};H(u,{d:M[c]});var P={x:"y",y:"x"},w={x:o.dx,y:o.dy};w[P[s.axis]]=0,mt(s.dragGroup,w.x,w.y),A(s.frames,function(b){var _=b.element,D=b.initialBounds,B,R;s.direction==="e"?H(_,{width:Fa(D.width+w.x,5)}):(B=Fa(D.width-w.x,5),H(_,{width:B,x:D.x+D.width-B})),s.direction==="s"?H(_,{height:Fa(D.height+w.y,5)}):(R=Fa(D.height-w.y,5),H(_,{height:R,y:D.y+D.height-R}))})}}),e.on("spaceTool.cleanup",function(o){var s=o.context,u=s.movingShapes,c=s.movingConnections,l=s.resizingShapes,p=s.line,h=s.dragGroup,f=s.frameGroup;A(u,function(d){n.removeMarker(d,Bs)}),A(c,function(d){n.removeMarker(d,Bs)}),h&&(ke(p),ke(h)),A(l,function(d){n.removeMarker(d,Bf)}),f&&ke(f)})}iv.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];function iC(e){return e.waypoints}var rv={__init__:["spaceToolPreview"],__depends__:[wn,cn,Yo,jr,zr],spaceTool:["type",Tn],spaceToolPreview:["type",iv]};function kt(e){this._model=e}kt.$inject=["moddle"];kt.prototype._needsId=function(e){return ye(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])};kt.prototype._ensureId=function(e){if(e.id){this._model.ids.claim(e.id,e);return}var t;v(e,"bpmn:Activity")?t="Activity":v(e,"bpmn:Event")?t="Event":v(e,"bpmn:Gateway")?t="Gateway":ye(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?t="Flow":t=(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))};kt.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n};kt.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})};kt.prototype.createDiShape=function(e,t,n){return this.create("bpmndi:BPMNShape",I({bpmnElement:e,bounds:this.createDiBounds(t)},n))};kt.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)};kt.prototype.createDiWaypoints=function(e){var t=this;return Ye(e,function(n){return t.createDiWaypoint(n)})};kt.prototype.createDiWaypoint=function(e){return this.create("dc:Point",Wt(e,["x","y"]))};kt.prototype.createDiEdge=function(e,t,n){return this.create("bpmndi:BPMNEdge",I({bpmnElement:e,waypoint:this.createDiWaypoints(t)},n))};kt.prototype.createDiPlane=function(e){return this.create("bpmndi:BPMNPlane",{bpmnElement:e})};function gt(e,t,n,i){U.call(this,e),this._bpmnFactory=t,this._translate=i;var r=this;function a(f){var d=f.context,y=d.hints||{},x;!d.cropped&&y.createElementsBehavior!==!1&&(x=d.connection,x.waypoints=n.getCroppedWaypoints(x),d.cropped=!0)}this.executed(["connection.layout","connection.create"],a),this.reverted(["connection.layout"],function(f){delete f.context.cropped});function o(f){var d=f.context;r.updateParent(d.shape||d.connection,d.oldParent)}function s(f){var d=f.context,y=d.shape||d.connection,x=d.parent||d.newParent;r.updateParent(y,x)}this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Rt(o)),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Rt(s));function u(f){var d=f.context,y=d.oldRoot,x=y.children;A(x,function(M){v(M,"bpmn:BaseElement")&&r.updateParent(M)})}this.executed(["canvas.updateRoot"],u),this.reverted(["canvas.updateRoot"],u);function c(f){var d=f.context.shape;!v(d,"bpmn:BaseElement")||r.updateBounds(d)}this.executed(["shape.move","shape.create","shape.resize"],Rt(function(f){f.context.shape.type!=="label"&&c(f)})),this.reverted(["shape.move","shape.create","shape.resize"],Rt(function(f){f.context.shape.type!=="label"&&c(f)})),e.on("shape.changed",function(f){f.element.type==="label"&&c({context:{shape:f.element}})});function l(f){r.updateConnection(f.context)}this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],Rt(l)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],Rt(l));function p(f){r.updateConnectionWaypoints(f.context.connection)}this.executed(["connection.layout","connection.move","connection.updateWaypoints"],Rt(p)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],Rt(p)),this.executed("connection.reconnect",Rt(function(f){var d=f.context,y=d.connection,x=d.oldSource,M=d.newSource,P=Y(y),w=Y(x),b=Y(M);P.conditionExpression&&!ye(b,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(d.oldConditionExpression=P.conditionExpression,delete P.conditionExpression),x!==M&&w.default===P&&(d.oldDefault=w.default,delete w.default)})),this.reverted("connection.reconnect",Rt(function(f){var d=f.context,y=d.connection,x=d.oldSource,M=d.newSource,P=Y(y),w=Y(x),b=Y(M);d.oldConditionExpression&&(P.conditionExpression=d.oldConditionExpression),d.oldDefault&&(w.default=d.oldDefault,delete b.default)}));function h(f){r.updateAttachment(f.context)}this.executed(["element.updateAttachment"],Rt(h)),this.reverted(["element.updateAttachment"],Rt(h))}Z(gt,U);gt.$inject=["eventBus","bpmnFactory","connectionDocking","translate"];gt.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject};gt.prototype.updateParent=function(e,t){if(!(e instanceof vo)&&!(v(e,"bpmn:DataStoreReference")&&e.parent&&v(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,r=n&&n.businessObject,a=r&&r.di;v(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,r,t&&t.businessObject),v(e,"bpmn:DataOutputAssociation")&&(e.source?r=e.source.businessObject:r=null),v(e,"bpmn:DataInputAssociation")&&(e.target?r=e.target.businessObject:r=null),this.updateSemanticParent(i,r),v(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,r),this.updateDiParent(i.di,a)}};gt.prototype.updateBounds=function(e){var t=e.businessObject.di,n=e instanceof vo?this._getLabel(t):t,i=n.bounds;i||(i=this._bpmnFactory.createDiBounds(),n.set("bounds",i)),I(i,{x:e.x,y:e.y,width:e.width,height:e.height})};gt.prototype.updateFlowNodeRefs=function(e,t,n){if(n!==t){var i,r;v(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),Ne(i,e)),v(t,"bpmn:Lane")&&(r=t.get("flowNodeRef"),Fe(r,e))}};gt.prototype.updateDiConnection=function(e,t,n){e.sourceElement&&e.sourceElement.bpmnElement!==t&&(e.sourceElement=t&&t.di),e.targetElement&&e.targetElement.bpmnElement!==n&&(e.targetElement=n&&n.di)};gt.prototype.updateDiParent=function(e,t){if(t&&!v(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(Ne(n,e),e.$parent=null)}};function rC(e){for(;e&&!v(e,"bpmn:Definitions");)e=e.$parent;return e}gt.prototype.getLaneSet=function(e){var t,n;return v(e,"bpmn:Lane")?(t=e.childLaneSet,t||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(v(e,"bpmn:Participant")&&(e=e.processRef),n=e.get("laneSets"),t=n[0],t||(t=this._bpmnFactory.create("bpmn:LaneSet"),t.$parent=e,n.push(t)),t)};gt.prototype.updateSemanticParent=function(e,t,n){var i,r=this._translate;if(e.$parent!==t&&!((v(e,"bpmn:DataInput")||v(e,"bpmn:DataOutput"))&&(v(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),"ioSpecification"in t&&t.ioSpecification===e.$parent))){if(v(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if(v(e,"bpmn:FlowElement")){if(t){if(v(t,"bpmn:Participant"))t=t.processRef;else if(v(t,"bpmn:Lane"))do t=t.$parent.$parent;while(v(t,"bpmn:Lane"))}i="flowElements"}else if(v(e,"bpmn:Artifact")){for(;t&&!v(t,"bpmn:Process")&&!v(t,"bpmn:SubProcess")&&!v(t,"bpmn:Collaboration");)if(v(t,"bpmn:Participant")){t=t.processRef;break}else t=t.$parent;i="artifacts"}else if(v(e,"bpmn:MessageFlow"))i="messageFlows";else if(v(e,"bpmn:Participant")){i="participants";var a=e.processRef,o;a&&(o=rC(e.$parent||t),e.$parent&&(Ne(o.get("rootElements"),a),a.$parent=null),t&&(Fe(o.get("rootElements"),a),a.$parent=o))}else v(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":v(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(r("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var s;if(e.$parent&&(s=e.$parent.get(i),Ne(s,e)),t?(s=t.get(i),s.push(e),e.$parent=t):e.$parent=null,n){var u=n.get(i);Ne(s,e),t&&(u||(u=[],t.set(i,u)),u.push(e))}}};gt.prototype.updateConnectionWaypoints=function(e){e.businessObject.di.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))};gt.prototype.updateConnection=function(e){var t=e.connection,n=Y(t),i=Y(t.source),r=Y(t.target),a;if(v(n,"bpmn:DataAssociation"))v(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=i,a=e.parent||e.newParent||r,this.updateSemanticParent(n,r,a)):v(n,"bpmn:DataOutputAssociation")&&(a=e.parent||e.newParent||i,this.updateSemanticParent(n,i,a),n.targetRef=r);else{var o=v(n,"bpmn:SequenceFlow");n.sourceRef!==i&&(o&&(Ne(n.sourceRef&&n.sourceRef.get("outgoing"),n),i&&i.get("outgoing")&&i.get("outgoing").push(n)),n.sourceRef=i),n.targetRef!==r&&(o&&(Ne(n.targetRef&&n.targetRef.get("incoming"),n),r&&r.get("incoming")&&r.get("incoming").push(n)),n.targetRef=r)}this.updateConnectionWaypoints(t),this.updateDiConnection(n.di,i,r)};gt.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};function Rt(e){return function(t){var n=t.context,i=n.shape||n.connection;v(i,"bpmn:BaseElement")&&e(t)}}function Yn(e,t,n){bn.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}Z(Yn,bn);Yn.$inject=["bpmnFactory","moddle","translate"];Yn.prototype.baseCreate=bn.prototype.create;Yn.prototype.create=function(e,t){return e==="label"?this.baseCreate(e,I({type:"label"},Sr,t)):this.createBpmnElement(e,t)};Yn.prototype.createBpmnElement=function(e,t){var n,i=this._translate;t=t||{};var r=t.businessObject;if(!r){if(!t.type)throw new Error(i("no shape type specified"));r=this._bpmnFactory.create(t.type)}r.di||(e==="root"?r.di=this._bpmnFactory.createDiPlane(r,[],{id:r.id+"_di"}):e==="connection"?r.di=this._bpmnFactory.createDiEdge(r,[],{id:r.id+"_di"}):r.di=this._bpmnFactory.createDiShape(r,{},{id:r.id+"_di"})),v(r,"bpmn:Group")&&(t=I({isFrame:!0},t)),t.di&&(I(r.di,t.di),delete t.di),aC(r,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&av(r.di,t,"isExpanded"),v(r,"bpmn:ExclusiveGateway")&&(r.di.isMarkerVisible=!0);var a,o;return t.eventDefinitionType&&(a=r.get("eventDefinitions")||[],o=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),t.eventDefinitionType==="bpmn:ConditionalEventDefinition"&&(o.condition=this._bpmnFactory.create("bpmn:FormalExpression")),a.push(o),o.$parent=r,r.eventDefinitions=a,delete t.eventDefinitionType),n=this._getDefaultSize(r),t=I({businessObject:r,id:r.id},n,t),this.baseCreate(e,t)};Yn.prototype._getDefaultSize=function(e){return v(e,"bpmn:SubProcess")?Se(e)?{width:350,height:200}:{width:100,height:80}:v(e,"bpmn:Task")?{width:100,height:80}:v(e,"bpmn:Gateway")?{width:50,height:50}:v(e,"bpmn:Event")?{width:36,height:36}:v(e,"bpmn:Participant")?Se(e)?{width:600,height:250}:{width:400,height:60}:v(e,"bpmn:Lane")?{width:400,height:100}:v(e,"bpmn:DataObjectReference")?{width:36,height:50}:v(e,"bpmn:DataStoreReference")?{width:50,height:50}:v(e,"bpmn:TextAnnotation")?{width:100,height:30}:v(e,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}};Yn.prototype.createParticipantShape=function(e){return Qe(e)||(e={isExpanded:e}),e=I({type:"bpmn:Participant"},e||{}),e.isExpanded!==!1&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)};function aC(e,t,n){A(n,function(i){t[i]!==void 0&&av(e,t,i)})}function av(e,t,n){e[n]=t[n],delete t[n]}function qo(e,t){this._modeling=e,this._canvas=t}qo.$inject=["modeling","canvas"];qo.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;A(n,function(r){var a={x:0,y:0};i.left?a.x=i.left-r.x:i.right?a.x=i.right-r.width-r.x:i.center?a.x=i.center-Math.round(r.width/2)-r.x:i.top?a.y=i.top-r.y:i.bottom?a.y=i.bottom-r.height-r.y:i.middle&&(a.y=i.middle-Math.round(r.height/2)-r.y),t.moveElements([r],a,r.parent)})};qo.prototype.postExecute=function(e){};function Ko(e){this._modeling=e}Ko.$inject=["modeling"];Ko.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,r=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:r.attach}),e.shape=i};Ko.prototype.postExecute=function(e){var t=e.hints||{};oC(e.source,e.shape)||(t.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))};function oC(e,t){return ci(e.outgoing,function(n){return n.target===t})}function Xo(e,t){this._canvas=e,this._layouter=t}Xo.$inject=["canvas","layouter"];Xo.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,a=e.parentIndex,o=e.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,o)),this._canvas.addConnection(t,r,a),t};Xo.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var ka=Math.round;function Hc(e){this._modeling=e}Hc.$inject=["modeling"];Hc.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,r=e.position,a=e.hints,o=this._modeling;A(t,function(l){ae(l.x)||(l.x=0),ae(l.y)||(l.y=0)});var s=et(t);A(t,function(l){Of(l)&&(l.waypoints=Ye(l.waypoints,function(p){return{x:ka(p.x-s.x-s.width/2+r.x),y:ka(p.y-s.y-s.height/2+r.y)}})),I(l,{x:ka(l.x-s.x-s.width/2+r.x),y:ka(l.y-s.y-s.height/2+r.y)})});var u=Ch(t),c={};A(t,function(l){if(Of(l)){c[l.id]=ae(i)?o.createConnection(c[l.source.id],c[l.target.id],i,l,l.parent||n,a):o.createConnection(c[l.source.id],c[l.target.id],l,l.parent||n,a);return}var p=I({},a);u.indexOf(l)===-1&&(p.autoResize=!1),c[l.id]=ae(i)?o.createShape(l,Wt(l,["x","y","width","height"]),l.parent||n,i,p):o.createShape(l,Wt(l,["x","y","width","height"]),l.parent||n,p)}),e.elements=wu(c)};function Of(e){return!!e.waypoints}var If=Math.round;function qn(e){this._canvas=e}qn.$inject=["canvas"];qn.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,r=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return n.width!==void 0?I(t,n):I(t,{x:n.x-If(t.width/2),y:n.y-If(t.height/2)}),this._canvas.addShape(t,i,r),t};qn.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t};function qr(e){qn.call(this,e)}Z(qr,qn);qr.$inject=["canvas"];var sC=qn.prototype.execute;qr.prototype.execute=function(e){var t=e.shape;return cC(t),t.labelTarget=e.labelTarget,sC.call(this,e)};var uC=qn.prototype.revert;qr.prototype.revert=function(e){return e.shape.labelTarget=null,uC.call(this,e)};function cC(e){["width","height"].forEach(function(t){typeof e[t]=="undefined"&&(e[t]=0)})}function Zo(e,t){this._canvas=e,this._modeling=t}Zo.$inject=["canvas","modeling"];Zo.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=Mu(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t};Zo.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,Fe(n.children,t,i),this._canvas.addConnection(t,n),t};function zc(e,t){this._modeling=e,this._elementRegistry=t}zc.$inject=["modeling","elementRegistry"];zc.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;A(i,function(r){!n.get(r.id)||(r.waypoints?t.removeConnection(r):t.removeShape(r))})};function Kr(e,t){this._canvas=e,this._modeling=t}Kr.$inject=["canvas","modeling"];Kr.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;Ai(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),Ai(n.outgoing,function(i){t.removeConnection(i,{nested:!0})}),Ai(n.children,function(i){lC(i)?t.removeConnection(i,{nested:!0}):t.removeShape(i,{nested:!0})})};Kr.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=Mu(i.children,n),t.removeShape(n),n};Kr.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,r=e.oldParentIndex;return Fe(i.children,n,r),t.addShape(n,i),n};function lC(e){return e.waypoints}function Jo(e){this._modeling=e}Jo.$inject=["modeling"];var Nf={x:"y",y:"x"};Jo.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,r=e.dimension;function a(x,M){x.range.min=Math.min(M[i],x.range.min),x.range.max=Math.max(M[i]+M[r],x.range.max)}function o(x){return x[i]+x[r]/2}function s(x){return x.length-1}function u(x){return x.max-x.min}function c(x,M){var P={y:0};P[i]=x-o(M),P[i]&&(P[Nf[i]]=0,t.moveElements([M],P,M.parent))}var l=n[0],p=s(n),h=n[p],f,d,y=0;A(n,function(x,M){var P,w,b;if(x.elements.length<2){M&&M!==n.length-1&&(a(x,x.elements[0]),y+=u(x.range));return}P=Vt(x.elements,i),w=P[0],M===p&&(w=P[s(P)]),b=o(w),x.range=null,A(P,function(_){if(c(b,_),x.range===null){x.range={min:_[i],max:_[i]+_[r]};return}a(x,_)}),M&&M!==n.length-1&&(y+=u(x.range))}),d=Math.abs(h.range.min-l.range.max),f=Math.round((d-y)/(n.length-1)),!(f<n.length-1)&&A(n,function(x,M){var P={},w;x===l||x===h||(w=n[M-1],x.range.max=0,A(x.elements,function(b,_){P[Nf[i]]=0,P[i]=w.range.max-b[i]+f,x.range.min!==b[i]&&(P[i]+=b[i]-x.range.min),P[i]&&t.moveElements([b],P,b.parent),x.range.max=Math.max(b[i]+b[r],_?x.range.max:0)}))})};Jo.prototype.postExecute=function(e){};function Qo(e,t){this._layouter=e,this._canvas=t}Qo.$inject=["layouter","canvas"];Qo.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return I(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t};Qo.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};function Gc(){}Gc.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,a=t.parent;return e.oldParent=a,e.oldParentIndex=Ne(a.children,t),Fe(i.children,t,r),t.parent=i,A(t.waypoints,function(o){o.x+=n.x,o.y+=n.y,o.original&&(o.original.x+=n.x,o.original.y+=n.y)}),t};Gc.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,a=e.delta;return Ne(n.children,t),Fe(i.children,t,r),t.parent=i,A(t.waypoints,function(o){o.x-=a.x,o.y-=a.y,o.original&&(o.original.x-=a.x,o.original.y-=a.y)}),t};function Vc(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Vc.prototype.add=function(e,t){return this.addAll([e],t)};Vc.prototype.addAll=function(e,t){var n=dy(e,!!t,this);return I(this,n),this};function Xr(e){this._modeling=e}Xr.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]};Xr.prototype.moveClosure=function(e,t,n,i,r){var a=this._modeling,o=e.allShapes,s=e.allConnections,u=e.enclosedConnections,c=e.topLevel,l=!1;r&&r.parent===n&&(l=!0),A(o,function(p){a.moveShape(p,t,c[p.id]&&!l&&n,{recurse:!1,layout:!1})}),A(s,function(p){var h=!!o[p.source.id],f=!!o[p.target.id];u[p.id]&&h&&f?a.moveConnection(p,t,c[p.id]&&!l&&n):a.layoutConnection(p,{connectionStart:h&&wc(p,p.source,t),connectionEnd:f&&Sc(p,p.target,t)})})};Xr.prototype.getClosure=function(e){return new Vc().addAll(e,!0)};function es(e){this._helper=new Xr(e)}es.$inject=["modeling"];es.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)};es.prototype.postExecute=function(e){var t=e.hints,n;t&&t.primaryShape&&(n=t.primaryShape,t.oldParent=n.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,n)};function gi(e){this._modeling=e,this._helper=new Xr(e)}gi.$inject=["modeling"];gi.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,a=t.parent;return e.oldBounds=Wt(t,["x","y","width","height"]),e.oldParent=a,e.oldParentIndex=Ne(a.children,t),Fe(i.children,t,r),I(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t};gi.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;i.layout!==!1&&(A(t.incoming,function(a){r.layoutConnection(a,{connectionEnd:Sc(a,t,n)})}),A(t.outgoing,function(a){r.layoutConnection(a,{connectionStart:wc(a,t,n)})})),i.recurse!==!1&&this.moveChildren(e)};gi.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,r=e.delta;return Fe(n.children,t,i),I(t,{parent:n,x:t.x-r.x,y:t.y-r.y}),t};gi.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)};gi.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};function Zr(e){this._modeling=e}Zr.$inject=["modeling"];Zr.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return he(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};Zr.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,r=e.dockingOrPoints,a=e.hints||{},o={};a.connectionStart&&(o.connectionStart=a.connectionStart),a.connectionEnd&&(o.connectionEnd=a.connectionEnd),a.layoutConnection!==!1&&(n&&(!i||a.docking==="source")&&(o.connectionStart=o.connectionStart||Ff(he(r)?r[0]:r)),i&&(!n||a.docking==="target")&&(o.connectionEnd=o.connectionEnd||Ff(he(r)?r[r.length-1]:r)),a.newWaypoints&&(o.waypoints=a.newWaypoints),this._modeling.layoutConnection(t,o))};Zr.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,r=e.connection;return t&&(r.source=t),n&&(r.target=n),i&&(r.waypoints=i),r};function Ff(e){return e.original||e}function An(e,t){this._modeling=e,this._rules=t}An.$inject=["modeling","rules"];An.prototype.preExecute=function(e){var t=this,n=this._modeling,i=this._rules,r=e.oldShape,a=e.newData,o=e.hints||{},s;function u(d,y,x){return i.allowed("connection.reconnect",{connection:x,source:d,target:y})}var c={x:a.x,y:a.y},l={x:r.x,y:r.y,width:r.width,height:r.height};s=e.newShape=e.newShape||t.createShape(a,c,r.parent,o),r.host&&n.updateAttachment(s,r.host);var p;o.moveChildren!==!1&&(p=r.children.slice(),n.moveElements(p,{x:0,y:0},s,o));var h=r.incoming.slice(),f=r.outgoing.slice();A(h,function(d){var y=d.source,x=u(y,s,d);x&&t.reconnectEnd(d,s,Go(d,s,l),o)}),A(f,function(d){var y=d.target,x=u(s,y,d);x&&t.reconnectStart(d,s,zo(d,s,l),o)})};An.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)};An.prototype.execute=function(e){};An.prototype.revert=function(e){};An.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)};An.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)};An.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)};function Jr(e){this._modeling=e}Jr.$inject=["modeling"];Jr.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},I(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};Jr.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds,r=e.hints||{};r.layout!==!1&&(A(n.incoming,function(a){t.layoutConnection(a,{connectionEnd:Go(a,n,i)})}),A(n.outgoing,function(a){t.layoutConnection(a,{connectionStart:zo(a,n,i)})}))};Jr.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return I(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};function Kn(e){this._modeling=e}Kn.$inject=["modeling"];Kn.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,r=e.resizingShapes,a=e.start,o={};this.moveShapes(i,t),A(r,function(s){o[s.id]=fC(s)}),this.resizeShapes(r,t,n),this.updateConnectionWaypoints(Z1(i,r),t,n,a,i,r,o)};Kn.prototype.execute=function(){};Kn.prototype.revert=function(){};Kn.prototype.moveShapes=function(e,t){var n=this;A(e,function(i){n._modeling.moveShape(i,t,null,{autoResize:!1,layout:!1,recurse:!1})})};Kn.prototype.resizeShapes=function(e,t,n){var i=this;A(e,function(r){var a=J1(r,n,t);i._modeling.resizeShape(r,a,null,{attachSupport:!1,autoResize:!1,layout:!1})})};Kn.prototype.updateConnectionWaypoints=function(e,t,n,i,r,a,o){var s=this,u=r.concat(a);A(e,function(c){var l=c.source,p=c.target,h=pC(c),f=ov(n),d={labelBehavior:!1};Mn(u,l)&&Mn(u,p)?(h=Ye(h,function(y){return Lf(y,i,n)&&(y[f]=y[f]+t[f]),y.original&&Lf(y.original,i,n)&&(y.original[f]=y.original[f]+t[f]),y}),s._modeling.updateWaypoints(c,h,{labelBehavior:!1})):(Mn(u,l)||Mn(u,p))&&(Mn(r,l)?d.connectionStart=wc(c,l,t):Mn(r,p)?d.connectionEnd=Sc(c,p,t):Mn(a,l)?d.connectionStart=zo(c,l,o[l.id]):Mn(a,p)&&(d.connectionEnd=Go(c,p,o[p.id])),s._modeling.layoutConnection(c,d))})};function kf(e){return I({},e)}function pC(e){return Ye(e.waypoints,function(t){return t=kf(t),t.original&&(t.original=kf(t.original)),t})}function ov(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function Lf(e,t,n){var i=ov(n);if(/e|s/.test(n))return e[i]>t;if(/n|w/.test(n))return e[i]<t}function Mn(e,t){return e.indexOf(t)!==-1}function fC(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}function ts(e){this._modeling=e}ts.$inject=["modeling"];ts.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=sv(n),t.collapsed=!t.collapsed;var i=uv(n,t.collapsed);return[t].concat(i)};ts.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=t.children,r=cv(i,n);return t.collapsed=!t.collapsed,[t].concat(r)};function sv(e){var t={};return A(e,function(n){t[n.id]=n.hidden,n.children&&(t=I({},t,sv(n.children)))}),t}function uv(e,t){var n=[];return A(e,function(i){i.hidden=t,n=n.concat(i),i.children&&(n=n.concat(uv(i.children,i.collapsed||t)))}),n}function cv(e,t){var n=[];return A(e,function(i){i.hidden=t[i.id],n=n.concat(i),i.children&&(n=n.concat(cv(i.children,t)))}),n}function ns(e){this._modeling=e}ns.$inject=["modeling"];ns.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=lv(i,t),pv(n,t),t.host=n,t};ns.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,r=e.attacherIdx;return t.host=i,lv(n,t),pv(i,t,r),t};function lv(e,t){return Ne(e&&e.attachers,t)}function pv(e,t,n){if(!!e){var i=e.attachers;i||(e.attachers=i=[]),Fe(i,t,n)}}function Wc(){}Wc.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t};Wc.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};function Ce(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Ce.$inject=["eventBus","elementFactory","commandStack"];Ce.prototype.getHandlers=function(){return{"shape.append":Ko,"shape.create":qn,"shape.delete":Kr,"shape.move":gi,"shape.resize":Jr,"shape.replace":An,"shape.toggleCollapse":ts,spaceTool:Kn,"label.create":qr,"connection.create":Xo,"connection.delete":Zo,"connection.move":Gc,"connection.layout":Qo,"connection.updateWaypoints":Wc,"connection.reconnect":Zr,"elements.create":Hc,"elements.move":es,"elements.delete":zc,"elements.distribute":Jo,"elements.align":qo,"element.updateAttachment":ns}};Ce.prototype.registerHandlers=function(e){A(this.getHandlers(),function(t,n){e.registerHandler(n,t)})};Ce.prototype.moveShape=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=null);var a={shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",a)};Ce.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)};Ce.prototype.moveElements=function(e,t,n,i){i=i||{};var r=i.attach,a=n,o;r===!0?(o=n,a=n.parent):r===!1&&(o=null);var s={shapes:e,delta:t,newParent:a,newHost:o,hints:i};this._commandStack.execute("elements.move",s)};Ce.prototype.moveConnection=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=void 0);var a={connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",a)};Ce.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)};Ce.prototype.createConnection=function(e,t,n,i,r,a){typeof n=="object"&&(a=r,r=i,i=n,n=void 0),i=this._create("connection",i);var o={source:e,target:t,parent:r,parentIndex:n,connection:i,hints:a};return this._commandStack.execute("connection.create",o),o.connection};Ce.prototype.createShape=function(e,t,n,i,r){typeof i!="number"&&(r=i,i=void 0),r=r||{};var a=r.attach,o,s;e=this._create("shape",e),a?(o=n.parent,s=n):o=n;var u={position:t,shape:e,parent:o,parentIndex:i,host:s,hints:r};return this._commandStack.execute("shape.create",u),u.shape};Ce.prototype.createElements=function(e,t,n,i,r){he(e)||(e=[e]),typeof i!="number"&&(r=i,i=void 0),r=r||{};var a={position:t,elements:e,parent:n,parentIndex:i,hints:r};return this._commandStack.execute("elements.create",a),a.elements};Ce.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var r={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape};Ce.prototype.appendShape=function(e,t,n,i,r){r=r||{},t=this._create("shape",t);var a={source:e,position:n,target:i,shape:t,connection:r.connection,connectionParent:r.connectionParent,hints:r};return this._commandStack.execute("shape.append",a),a.shape};Ce.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)};Ce.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)};Ce.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)};Ce.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)};Ce.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape};Ce.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)};Ce.prototype.resizeShape=function(e,t,n,i){var r={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",r)};Ce.prototype.createSpace=function(e,t,n,i,r){var a={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:r};this._commandStack.execute("spaceTool",a)};Ce.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)};Ce.prototype.reconnect=function(e,t,n,i,r){var a={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:r||{}};this._commandStack.execute("connection.reconnect",a)};Ce.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,I(i,{docking:"source"}))};Ce.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,I(i,{docking:"target"}))};Ce.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)};Ce.prototype._create=function(e,t){return t instanceof Br?t:this._elementFactory.create(e,t)};Ce.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};function Qr(e){this._elementRegistry=e}Qr.$inject=["elementRegistry"];Qr.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var r=e.changed||this.getVisualReferences(n).concat(t),a=e.oldProperties||hC(n,qa(i));return fv(n,i),e.oldProperties=a,e.changed=r,r};Qr.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return fv(n,t),i};Qr.prototype.getVisualReferences=function(e){var t=this._elementRegistry;return v(e,"bpmn:DataObject")?dC(e,t):[]};function hC(e,t){return wt(t,function(n,i){return n[i]=e.get(i),n},{})}function fv(e,t){A(t,function(n,i){e.set(i,n)})}function dC(e,t){return t.filter(function(n){return v(n,"bpmn:DataObjectReference")&&Y(n).dataObjectRef===e})}var fr="default",yn="id",hv="di",mC={width:0,height:0};function ea(e,t,n,i,r){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=i,this._textRenderer=r}ea.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"];ea.prototype.execute=function(e){var t=e.element,n=[t],i=this._translate;if(!t)throw new Error(i("element required"));var r=this._elementRegistry,a=this._moddle.ids,o=t.businessObject,s=bC(e.properties),u=e.oldProperties||vC(o,s);return dv(s,o)&&(a.unclaim(o[yn]),r.updateId(t,s[yn]),a.claim(s[yn],o)),fr in s&&(s[fr]&&n.push(r.get(s[fr].id)),o[fr]&&n.push(r.get(o[fr].id))),mv(o,s),e.oldProperties=u,e.changed=n,n};ea.prototype.postExecute=function(e){var t=e.element,n=t.label,i=n&&Y(n).name;if(!!i){var r=this._textRenderer.getExternalLabelBounds(n,i);this._modeling.resizeShape(n,r,mC)}};ea.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,r=t.businessObject,a=this._elementRegistry,o=this._moddle.ids;return mv(r,i),dv(n,r)&&(o.unclaim(n[yn]),a.updateId(t,i[yn]),o.claim(i[yn],r)),e.changed};function dv(e,t){return yn in e&&e[yn]!==t[yn]}function vC(e,t){var n=qa(t);return wt(n,function(i,r){return r!==hv?i[r]=e.get(r):i[r]=gC(e.di,qa(t.di)),i},{})}function gC(e,t){return wt(t,function(n,i){return n[i]=e.get(i),n},{})}function mv(e,t){A(t,function(n,i){i!==hv?e.set(i,n):e.di&&yC(e.di,n)})}function yC(e,t){A(t,function(n,i){e.set(i,n)})}var EC=["default"];function bC(e){var t=I({},e);return EC.forEach(function(n){n in e&&(t[n]=Y(t[n]))}),t}function is(e,t){this._canvas=e,this._modeling=t}is.$inject=["canvas","modeling"];is.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=t.getRootElement(),a=r.businessObject,o=a.$parent,s=a.di;t.setRootElement(n,!0),Fe(o.rootElements,i),i.$parent=o,Ne(o.rootElements,a),a.$parent=null,a.di=null,s.bpmnElement=i,i.di=s,e.oldRoot=r};is.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=e.oldRoot,a=r.businessObject,o=i.$parent,s=i.di;t.setRootElement(r,!0),Ne(o.rootElements,i),i.$parent=null,Fe(o.rootElements,a),a.$parent=o,i.di=null,s.bpmnElement=a,a.di=s};function Uc(e,t){this._modeling=e,this._spaceTool=t}Uc.$inject=["modeling","spaceTool"];Uc.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,r=e.location,a=zt(i),o=a===i,s=o?i:i.parent,u=di(s);u.length||n.createShape({type:"bpmn:Lane"},{x:i.x+Ti,y:i.y,width:i.width-Ti,height:i.height},s);var c=[];pi(a,function(y){return c.push(y),y.label&&c.push(y.label),y===i?[]:se(y.children,function(x){return x!==i})});var l=r==="top"?-120:120,p=r==="top"?i.y:i.y+i.height,h=p+(r==="top"?10:-10),f=r==="top"?"n":"s",d=t.calculateAdjustments(c,"y",l,h);t.makeSpace(d.movingShapes,d.resizingShapes,{x:0,y:l},f,h),e.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(o?Ti:0),y:p-(r==="top"?120:0),width:i.width-(o?Ti:0),height:120},s)};function Yc(e,t){this._modeling=e,this._translate=t}Yc.$inject=["modeling","translate"];Yc.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,i=e.shape,r=e.count,a=di(i),o=a.length;if(o>r)throw new Error(n("more than {count} child lanes",{count:r}));var s=Math.round(i.height/r),u,c,l,p,h;for(h=0;h<r;h++)u=i.y+h*s,h===r-1?c=i.height-s*h:c=s,l={x:i.x+Ti,y:u,width:i.width-Ti,height:c},h<o?t.resizeShape(a[h],l):(p={type:"bpmn:Lane"},t.createShape(p,l,i))};function ta(e,t){this._modeling=e,this._spaceTool=t}ta.$inject=["modeling","spaceTool"];ta.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds,i=e.balanced;i!==!1?this.resizeBalanced(t,n):this.resizeSpace(t,n)};ta.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=cw(e,t);n.resizeShape(e,t),i.forEach(function(r){n.resizeShape(r.shape,r.newBounds)})};ta.prototype.resizeSpace=function(e,t){var n=this._spaceTool,i=ee(e),r=ee(t),a=um(r,i),o=zt(e),s=[],u=[];pi(o,function(d){return s.push(d),(v(d,"bpmn:Lane")||v(d,"bpmn:Participant"))&&u.push(d),d.children});var c,l,p,h,f;(a.bottom||a.top)&&(c=a.bottom||a.top,l=e.y+(a.bottom?e.height:0)+(a.bottom?-10:10),p=a.bottom?"s":"n",h=a.top>0||a.bottom<0?-c:c,f=n.calculateAdjustments(s,"y",h,l),n.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:c},p)),(a.left||a.right)&&(c=a.right||a.left,l=e.x+(a.right?e.width:0)+(a.right?-10:100),p=a.right?"e":"w",h=a.left>0||a.right<0?-c:c,f=n.calculateAdjustments(u,"x",h,l),n.makeSpace(f.movingShapes,f.resizingShapes,{x:c,y:0},p))};var Ar="flowNodeRef",qc="lanes";function na(e){this._elementRegistry=e}na.$inject=["elementRegistry"];na.prototype.computeUpdates=function(e,t){var n=[],i=[],r={},a=[];function o(l,p){var h=ee(p),f={x:l.x+l.width/2,y:l.y+l.height/2};return f.x>h.left&&f.x<h.right&&f.y>h.top&&f.y<h.bottom}function s(l){n.indexOf(l)===-1&&(a.push(l),n.push(l))}function u(l){var p=zt(l);return r[p.id]||(r[p.id]=No(p)),r[p.id]}function c(l){if(!l.parent)return[];var p=u(l);return p.filter(function(h){return o(l,h)}).map(function(h){return h.businessObject})}return t.forEach(function(l){var p=zt(l);if(!(!p||n.indexOf(p)!==-1)){var h=p.children.filter(function(f){return v(f,"bpmn:FlowNode")});h.forEach(s),n.push(p)}}),e.forEach(s),a.forEach(function(l){var p=l.businessObject,h=p.get(qc),f=h.slice(),d=c(l);i.push({flowNode:p,remove:f,add:d})}),t.forEach(function(l){var p=l.businessObject;l.parent||p.get(Ar).forEach(function(h){i.push({flowNode:h,remove:[p],add:[]})})}),i};na.prototype.execute=function(e){var t=e.updates;t||(t=e.updates=this.computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(n){var i=n.flowNode,r=i.get(qc);n.remove.forEach(function(a){Ne(r,a),Ne(a.get(Ar),i)}),n.add.forEach(function(a){Fe(r,a),Fe(a.get(Ar),i)})})};na.prototype.revert=function(e){var t=e.updates;t.forEach(function(n){var i=n.flowNode,r=i.get(qc);n.add.forEach(function(a){Ne(r,a),Ne(a.get(Ar),i)}),n.remove.forEach(function(a){Fe(r,a),Fe(a.get(Ar),i)})})};function rs(e){this._moddle=e}rs.$inject=["moddle"];rs.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;r?t.claim(n,i):t.unclaim(n)};rs.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;r?t.unclaim(n):t.claim(n,i)};var xC={fill:void 0,stroke:void 0};function Kc(e){this._commandStack=e,this._normalizeColor=function(t){if(!!t){if(Dt(t)){var n=_C(t);if(n)return n}throw new Error("invalid color value: "+t)}}}Kc.$inject=["commandStack"];Kc.prototype.postExecute=function(e){var t=e.elements,n=e.colors||xC,i=this,r={};"fill"in n&&I(r,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&I(r,{"border-color":this._normalizeColor(n.stroke)}),A(t,function(a){var o=wC(a)?Wt(r,["border-color"]):r;SC(o),a.labelTarget?i._commandStack.execute("element.updateModdleProperties",{element:a,moddleElement:a.businessObject.di.label,properties:{color:r["background-color"]}}):i._commandStack.execute("element.updateProperties",{element:a,properties:{di:o}})})};function _C(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}function wC(e){return!!e.waypoints}function SC(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}var CC={width:0,height:0};function vv(e,t){function n(s,u){var c=s.label||s,l=s.labelTarget||s;return Gb(c,u),[c,l]}function i(s){var u=s.element,c=u.businessObject,l=s.newLabel;if(!Je(u)&&Bi(u)&&!Co(u)&&!$f(l)){var p=7,h=To(u);h={x:h.x,y:h.y+p},e.createLabel(u,h,{id:c.id+"_label",businessObject:c})}}function r(s){return s.oldLabel=Ut(s.element),n(s.element,s.newLabel)}function a(s){return n(s.element,s.oldLabel)}function o(s){var u=s.element,c=u.label||u,l=s.newLabel,p=s.newBounds,h=s.hints||{};if(!(!Je(c)&&!v(c,"bpmn:TextAnnotation"))){if(Je(c)&&$f(l)){h.removeShape!==!1&&e.removeShape(c,{unsetLabel:!1});return}var f=Ut(c);typeof p=="undefined"&&(p=t.getExternalLabelBounds(c,f)),p&&e.resizeShape(c,p,CC)}}this.preExecute=i,this.execute=r,this.revert=a,this.postExecute=o}vv.$inject=["modeling","textRenderer"];function $f(e){return!e||!e.trim()}function it(e,t,n,i){Ce.call(this,e,t,n),this._bpmnRules=i}Z(it,Ce);it.$inject=["eventBus","elementFactory","commandStack","bpmnRules"];it.prototype.getHandlers=function(){var e=Ce.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=Qr,e["element.updateProperties"]=ea,e["canvas.updateRoot"]=is,e["lane.add"]=Uc,e["lane.resize"]=ta,e["lane.split"]=Yc,e["lane.updateRefs"]=na,e["id.updateClaim"]=rs,e["element.setColor"]=Kc,e["element.updateLabel"]=vv,e};it.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})};it.prototype.connect=function(e,t,n,i){var r=this._bpmnRules;if(n||(n=r.canConnect(e,t)),!!n)return this.createConnection(e,t,n,e.parent,i)};it.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})};it.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})};it.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})};it.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane};it.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})};it.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e};it.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})};it.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};this._commandStack.execute("canvas.updateRoot",t)};it.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})};it.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};it.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};function gv(){}gv.prototype.layoutConnection=function(e,t){return t=t||{},[t.connectionStart||ue(t.source||e.source),t.connectionEnd||ue(t.target||e.target)]};var La=20,TC=5,lo=Math.round,jf=20,AC={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function RC(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}function PC(e,t){return{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[e].test(t)}function yv(e,t,n){var i=tt(t,e,TC),r=n.split(":")[0],a=lo((t.x-e.x)/2+e.x),o=lo((t.y-e.y)/2+e.y),s,u,c=PC(r,i),l=/h|r|l/.test(r),p=!1,h=!1;return c?(s=l?{x:a,y:e.y}:{x:e.x,y:o},u=l?"h:h":"v:v"):(p=RC(i,r),u=l?"h:v":"v:h",p?l?(h=o===e.y,s={x:e.x+La*(/l/.test(r)?-1:1),y:h?o+La:o}):(h=a===e.x,s={x:h?a+La:a,y:e.y+La*(/t/.test(r)?-1:1)}):s={x:a,y:o}),{waypoints:Xc(e,s,u).concat(s),directions:u,turnNextDirections:h}}function DC(e,t,n){return yv(e,t,n)}function MC(e,t,n){var i=yv(t,e,Hf(n));return{waypoints:i.waypoints.slice().reverse(),directions:Hf(i.directions),turnNextDirections:i.turnNextDirections}}function BC(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n=n=="h"?"v":"h"),t.turnNextDirections&&(i=i=="h"?"v":"h");var r=n+":"+i,a=Xc(e.waypoints[e.waypoints.length-1],t.waypoints[0],r);return{waypoints:a,directions:r}}function Hf(e){return e.split(":").reverse().join(":")}function OC(e,t,n){var i=lo((t.x-e.x)/2+e.x),r=lo((t.y-e.y)/2+e.y);if(n==="h:v")return[{x:t.x,y:e.y}];if(n==="v:h")return[{x:e.x,y:t.y}];if(n==="h:h")return[{x:i,y:e.y},{x:i,y:t.y}];if(n==="v:v")return[{x:e.x,y:r},{x:t.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}function Xc(e,t,n){if(n=n||"h:h",!zC(n))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Ev(n)){var i=DC(e,t,n),r=MC(e,t,n),a=BC(i,r);return[].concat(i.waypoints,a.waypoints,r.waypoints)}return OC(e,t,n)}function IC(e,t,n){var i=Xc(e,t,n);return i.unshift(e),i.push(t),bv(i)}function NC(e,t,n,i,r){var a=r&&r.preferredLayouts||[],o=Pg(a,"straight")[0]||"h:h",s=AC[o]||0,u=tt(e,t,s),c=HC(u,o);n=n||ue(e),i=i||ue(t);var l=c.split(":"),p=Gf(n,e,l[0],GC(u)),h=Gf(i,t,l[1],u);return IC(p,h,c)}function FC(e,t,n,i,r,a){he(n)&&(r=n,a=i,n=ue(e),i=ue(t)),a=I({preferredLayouts:[]},a),r=r||[];var o=a.preferredLayouts,s=o.indexOf("straight")!==-1,u;return u=s&&LC(e,t,n,i,a),u||(u=a.connectionEnd&&jC(t,e,i,r),u)||(u=a.connectionStart&&$C(e,t,n,r),u)?u:!a.connectionStart&&!a.connectionEnd&&r&&r.length?r:NC(e,t,n,i,a)}function kC(e,t,n){return e>=t&&e<=n}function zf(e,t,n){var i={x:"width",y:"height"};return kC(t[e],n[e],n[e]+n[i[e]])}function LC(e,t,n,i,r){var a={},o,s;return s=tt(e,t),/^(top|bottom|left|right)$/.test(s)?(/top|bottom/.test(s)&&(o="x"),/left|right/.test(s)&&(o="y"),r.preserveDocking==="target"?zf(o,i,e)?(a[o]=i[o],[{x:a.x!==void 0?a.x:n.x,y:a.y!==void 0?a.y:n.y,original:{x:a.x!==void 0?a.x:n.x,y:a.y!==void 0?a.y:n.y}},{x:i.x,y:i.y}]):null:zf(o,n,t)?(a[o]=n[o],[{x:n.x,y:n.y},{x:a.x!==void 0?a.x:i.x,y:a.y!==void 0?a.y:i.y,original:{x:a.x!==void 0?a.x:i.x,y:a.y!==void 0?a.y:i.y}}]):null):null}function $C(e,t,n,i){return Zc(e,t,n,i)}function jC(e,t,n,i){var r=i.slice().reverse();return r=Zc(e,t,n,r),r?r.reverse():null}function Zc(e,t,n,i){function r(l){return l.length<3?!0:l.length>4?!1:!!_e(l,function(p,h){var f=l[h-1];return f&&Mr(p,f)<3})}function a(l,p,h){var f=vn(p,l);switch(f){case"v":return{x:h.x,y:l.y};case"h":return{x:l.x,y:h.y}}return{x:l.x,y:l.y}}function o(l,p,h){var f;for(f=l.length-2;f!==0;f--)if(Bl(l[f],p,jf)||Bl(l[f],h,jf))return l.slice(f);return l}if(r(i))return null;var s=i[0],u=i.slice(),c;return u[0]=n,u[1]=a(u[1],s,n),c=o(u,e,t),c!==u&&(u=Zc(e,t,n,c)),u&&vn(u)?null:u}function HC(e,t){if(Ev(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}function zC(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}function Ev(e){return e&&/t|r|b|l/.test(e)}function GC(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}function Gf(e,t,n,i){if(n==="h"&&(n=/left/.test(i)?"l":"r"),n==="v"&&(n=/top/.test(i)?"t":"b"),n==="t")return{original:e,x:e.x,y:t.y};if(n==="r")return{original:e,x:t.x+t.width,y:e.y};if(n==="b")return{original:e,x:e.x,y:t.y+t.height};if(n==="l")return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function bv(e){return e.reduce(function(t,n,i){var r=t[t.length-1],a=e[i+1];return Bu(r,a,n,0)||t.push(n),t},[])}var VC=-10,WC=40,Jc={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},Ua={top:"t",right:"r",bottom:"b",left:"l"};function Qc(){}Z(Qc,gv);Qc.prototype.layoutConnection=function(e,t){t||(t={});var n=t.source||e.source,i=t.target||e.target,r=t.waypoints||e.waypoints,a=t.connectionStart,o=t.connectionEnd,s,u;return a||(a=Vf(r&&r[0],n)),o||(o=Vf(r&&r[r.length-1],i)),(v(e,"bpmn:Association")||v(e,"bpmn:DataAssociation"))&&r&&!Wf(n,i)?[].concat([a],r.slice(1,-1),[o]):(v(e,"bpmn:MessageFlow")?s=YC(n,i):(v(e,"bpmn:SequenceFlow")||Wf(n,i))&&(n===i?s={preferredLayouts:tT(n,e)}:v(n,"bpmn:BoundaryEvent")?s={preferredLayouts:nT(n,i,o)}:Rr(n)||Rr(i)?s=KC(n):v(n,"bpmn:Gateway")?s={preferredLayouts:["v:h"]}:v(i,"bpmn:Gateway")?s={preferredLayouts:["h:v"]}:s={preferredLayouts:["h:h"]}),s&&(s=I(s,t),u=bv(FC(n,i,a,o,r,s))),u||[a,o])};function UC(e){var t=e.host;return tt(ue(e),t,VC)}function YC(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:qC(e,t)}}function qC(e,t){return v(t,"bpmn:Participant")?"source":v(e,"bpmn:Participant")?"target":Rr(t)?"source":Rr(e)||v(t,"bpmn:Event")?"target":v(e,"bpmn:Event")?"source":null}function KC(e){return{preferredLayouts:["straight","h:h"],preserveDocking:XC(e)}}function XC(e){return Rr(e)?"target":"source"}function Vf(e,t){return e?e.original||e:ue(t)}function Wf(e,t){return v(t,"bpmn:Activity")&&v(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function Rr(e){return v(e,"bpmn:SubProcess")&&Se(e)}function br(e,t){return e===t}function ZC(e,t){return t.indexOf(e)!==-1}function xr(e){var t=/right|left/.exec(e);return t&&t[0]}function si(e){var t=/top|bottom/.exec(e);return t&&t[0]}function JC(e,t){return Jc[e]===t}function QC(e,t){var n=xr(e),i=Jc[n];return t.indexOf(i)!==-1}function eT(e,t){var n=si(e),i=Jc[n];return t.indexOf(i)!==-1}function Eu(e){return e==="right"||e==="left"}function tT(e,t){var n=t.waypoints,i=n&&n.length&&tt(n[0],e);return i==="top"?["t:r"]:i==="right"?["r:b"]:i==="left"?["l:t"]:["b:l"]}function nT(e,t,n){var i=ue(e),r=ue(t),a=UC(e),o,s,u=br(e.host,t),c=ZC(a,["top","right","bottom","left"]),l=tt(r,i,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return u?iT(a,c,e,t,n):(o=rT(a,l,c),s=aT(a,l,c),[o+":"+s])}function iT(e,t,n,i,r){var a=t?e:si(e),o=Ua[a],s;return t?Eu(e)?s=Uf("y",n,i,r)?"h":"b":s=Uf("x",n,i,r)?"v":"l":s="v",[o+":"+s]}function Uf(e,t,n,i){var r=WC;return!(Os(e,i,n,r)||Os(e,i,{x:n.x+n.width,y:n.y+n.height},r)||Os(e,i,ue(t),r))}function Os(e,t,n,i){return Math.abs(t[e]-n[e])<i}function rT(e,t,n){return n?Ua[e]:br(si(e),si(t))||JC(xr(e),xr(t))?Ua[si(e)]:Ua[xr(e)]}function aT(e,t,n){return n?Eu(e)?QC(e,t)||br(e,t)?"h":"v":eT(e,t)||br(e,t)?"v":"h":Eu(t)||br(si(e),si(t))&&xr(t)?"h":"v"}function Yf(e){return I({original:e.point.original||e.point},e.actual)}function Xn(e,t){this._elementRegistry=e,this._graphicsFactory=t}Xn.$inject=["elementRegistry","graphicsFactory"];Xn.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),r=this.getDockingPoint(e,n),a=e.waypoints.slice(i.idx+1,r.idx);return a.unshift(Yf(i)),a.push(Yf(r)),a};Xn.prototype.getDockingPoint=function(e,t,n){var i=e.waypoints,r,a,o;return r=n?0:i.length-1,a=i[r],o=this._getIntersection(t,e,n),{point:a,actual:o||a,idx:r}};Xn.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),r=this._getConnectionPath(t);return qs(i,r,n)};Xn.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)};Xn.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)};Xn.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var oT={__init__:["modeling","bpmnUpdater"],__depends__:[f1,M1,O1,I1,sm,N1,$1,H1,Y1,sn,ym,rv],bpmnFactory:["type",kt],bpmnUpdater:["type",gt],elementFactory:["type",Yn],modeling:["type",it],layouter:["type",Qc],connectionDocking:["type",Xn]},sT=500,uT=1250,cT=1500,po=Math.round;function lT(e){return{x:e.x+po(e.width/2),y:e.y+po(e.height/2)}}function xv(e,t,n,i,r){function a(s,u,c,l){return r.allowed("elements.move",{shapes:s,delta:u,position:c,target:l})}e.on("shape.move.start",cT,function(s){var u=s.context,c=s.shape,l=i.get().slice();l.indexOf(c)===-1&&(l=[c]),l=pT(l),I(u,{shapes:l,validatedShapes:l,shape:c})}),e.on("shape.move.start",uT,function(s){var u=s.context,c=u.validatedShapes,l;if(l=u.canExecute=a(c),!l)return!1}),e.on("shape.move.move",sT,function(s){var u=s.context,c=u.validatedShapes,l=s.hover,p={x:s.dx,y:s.dy},h={x:s.x,y:s.y},f;if(f=a(c,p,h,l),u.delta=p,u.canExecute=f,f===null){u.target=null;return}u.target=l}),e.on("shape.move.end",function(s){var u=s.context,c=u.delta,l=u.canExecute,p=l==="attach",h=u.shapes;if(l===!1)return!1;c.x=po(c.x),c.y=po(c.y),!(c.x===0&&c.y===0)&&n.moveElements(h,c,u.target,{primaryShape:u.shape,attach:p})}),e.on("element.mousedown",function(s){if(!!zn(s)){var u=Wi(s);if(!u)throw new Error("must supply DOM mousedown event");return o(u,s.element)}});function o(s,u,c,l){if(Qe(c)&&(l=c,c=!1),!(u.waypoints||!u.parent)){var p=lT(u);return t.init(s,p,"shape.move",{cursor:"grabbing",autoActivate:c,data:{shape:u,context:l||{}}}),!0}}this.start=o}xv.$inject=["eventBus","dragging","modeling","selection","rules"];function pT(e){var t=ki(e,"id");return se(e,function(n){for(;n=n.parent;)if(t[n.id])return!1;return!0})}var qf=499,Is="djs-dragging",Kf="drop-ok",Xf="drop-not-ok",Zf="new-parent",Jf="attach-ok";function _v(e,t,n,i){function r(u){var c=a(u),l=fT(c);return l}function a(u){var c=ho(u,!0),l=Ye(c,function(p){return(p.incoming||[]).concat(p.outgoing||[])});return Ya(c.concat(l))}function o(u,c){[Jf,Kf,Xf,Zf].forEach(function(l){l===c?t.addMarker(u,l):t.removeMarker(u,l)})}function s(u,c,l){i.addDragger(c,u.dragGroup),l&&t.addMarker(c,Is),u.allDraggedElements?u.allDraggedElements.push(c):u.allDraggedElements=[c]}e.on("shape.move.start",qf,function(u){var c=u.context,l=c.shapes,p=c.allDraggedElements,h=r(l);if(!c.dragGroup){var f=J("g");H(f,n.cls("djs-drag-group",["no-events"]));var d=t.getActiveLayer();ne(d,f),c.dragGroup=f}h.forEach(function(y){i.addDragger(y,c.dragGroup)}),p?p=Ya([p,a(l)]):p=a(l),A(p,function(y){t.addMarker(y,Is)}),c.allDraggedElements=p,c.differentParents=hT(l)}),e.on("shape.move.move",qf,function(u){var c=u.context,l=c.dragGroup,p=c.target,h=c.shape.parent,f=c.canExecute;p&&(f==="attach"?o(p,Jf):c.canExecute&&p&&p.id!==h.id?o(p,Zf):o(p,c.canExecute?Kf:Xf)),mt(l,u.dx,u.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(u){var c=u.context,l=c.target;l&&o(l,null)}),e.on("shape.move.cleanup",function(u){var c=u.context,l=c.allDraggedElements,p=c.dragGroup;A(l,function(h){t.removeMarker(h,Is)}),p&&ke(p)}),this.makeDraggable=s}_v.$inject=["eventBus","canvas","styles","previewSupport"];function fT(e){var t=se(e,function(n){return dT(n)?_e(e,Gt({id:n.source.id}))&&_e(e,Gt({id:n.target.id})):!0});return t}function hT(e){return _r(ki(e,function(t){return t.parent&&t.parent.id}))!==1}function dT(e){return e.waypoints}var mT={__depends__:[kr,sn,md,cn,wn,jr],__init__:["move","movePreview"],move:["type",xv],movePreview:["type",_v]},wv=".djs-palette-toggle",Sv=".entry",vT=wv+", "+Sv,bu="djs-palette-",gT="shown",xu="open",Qf="two-column",yT=1e3;function Le(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(i){var r=i.tool;n.updateToolHighlight(r)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}Le.$inject=["eventBus","canvas"];Le.prototype.registerProvider=function(e,t){t||(t=e,e=yT),this._eventBus.on("palette.getProviders",e,function(n){n.providers.push(t)}),this._rebuild()};Le.prototype.getEntries=function(){var e=this._getProviders();return e.reduce(bT,{})};Le.prototype._rebuild=function(){if(!!this._diagramInitialized){var e=this._getProviders();!e.length||(this._container||this._init(),this._update())}};Le.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=Ae(Le.HTML_MARKUP);n.appendChild(i),ze(n).add(bu+gT),xt.bind(i,vT,"click",function(r){var a=r.delegateTarget;if(Ka(a,wv))return e.toggle();e.trigger("click",r)}),te.bind(i,"mousedown",function(r){r.stopPropagation()}),xt.bind(i,Sv,"dragstart",function(r){e.trigger("dragstart",r)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})};Le.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};Le.prototype._toggleState=function(e){e=e||{};var t=this._getParentContainer(),n=this._container,i=this._eventBus,r,a=ze(n),o=ze(t);"twoColumn"in e?r=e.twoColumn:r=this._needsCollapse(t.clientHeight,this._entries||{}),a.toggle(Qf,r),o.toggle(bu+Qf,r),"open"in e&&(a.toggle(xu,e.open),o.toggle(bu+xu,e.open)),i.fire("palette.changed",{twoColumn:r,open:this.isOpen()})};Le.prototype._update=function(){var e=Oe(".djs-palette-entries",this._container),t=this._entries=this.getEntries();fo(e),A(t,function(n,i){var r=n.group||"default",a=Oe("[data-group="+r+"]",e);a||(a=Ae('<div class="group" data-group="'+r+'"></div>'),e.appendChild(a));var o=n.html||(n.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),s=Ae(o);a.appendChild(s),n.separator||(St(s,"data-action",i),n.title&&St(s,"title",n.title),n.className&&ET(s,n.className),n.imageUrl&&s.appendChild(Ae('<img src="'+n.imageUrl+'">')))}),this.open()};Le.prototype.trigger=function(e,t,n){var i=this._entries,r,a,o,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();r=i[St(s,"data-action")],r&&(a=r.action,o=t.originalEvent||t,ot(a)?e==="click"&&a(o,n):a[e]&&a[e](o,n),t.preventDefault())};Le.prototype._layoutChanged=function(){this._toggleState({})};Le.prototype._needsCollapse=function(e,t){var n=50,i=Object.keys(t).length*46;return e<i+n};Le.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})};Le.prototype.open=function(){this._toggleState({open:!0})};Le.prototype.toggle=function(e){this.isOpen()?this.close():this.open()};Le.prototype.isActiveTool=function(e){return e&&this._activeTool===e};Le.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=Oe(".djs-palette-entries",this._container),this._toolsContainer=Oe("[data-group=tools]",t)),n=this._toolsContainer,A(n.children,function(i){var r=i.getAttribute("data-action");if(!!r){var a=ze(i);r=r.replace("-tool",""),a.contains("entry")&&r===e?a.add("highlighted-entry"):a.remove("highlighted-entry")}})};Le.prototype.isOpen=function(){return ze(this._container).has(xu)};Le.prototype._getParentContainer=function(){return this._canvas.getContainer()};Le.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';function ET(e,t){var n=ze(e),i=he(t)?t:t.split(/\s+/g);i.forEach(function(r){n.add(r)})}function bT(e,t){var n=t.getPaletteEntries();return ot(n)?n(e):(A(n,function(i,r){e[r]=i}),e)}var xT={__init__:["palette"],palette:["type",Le]},Cv="crosshair";function yi(e,t,n,i,r,a,o){this._selection=r,this._dragging=n,this._mouse=o;var s=this,u={create:function(c){var l=t.getActiveLayer(),p;p=c.frame=J("rect"),H(p,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),ne(l,p)},update:function(c){var l=c.frame,p=c.bbox;H(l,{x:p.x,y:p.y,width:p.width,height:p.height})},remove:function(c){c.frame&&ke(c.frame)}};a.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(c){var l=c.originalEvent.target;!c.hover&&!(l instanceof SVGElement)||e.once("lasso.selection.ended",function(){s.activateLasso(c.originalEvent,!0)})}),e.on("lasso.end",function(c){var l=Ns(c),p=i.filter(function(h){return h});s.select(p,l)}),e.on("lasso.start",function(c){var l=c.context;l.bbox=Ns(c),u.create(l)}),e.on("lasso.move",function(c){var l=c.context;l.bbox=Ns(c),u.update(l)}),e.on("lasso.cleanup",function(c){var l=c.context;u.remove(l)}),e.on("element.mousedown",1500,function(c){if(!!hd(c))return s.activateLasso(c.originalEvent),!0})}yi.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"];yi.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:Cv,data:{context:{}}})};yi.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:Cv,data:{context:{}}})};yi.prototype.select=function(e,t){var n=my(e,t);this._selection.select(wu(n))};yi.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};yi.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};function Ns(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y},i;return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?i={x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?i={x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?i={x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?i={x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:i={x:n.x,y:n.y,width:0,height:0},i}var _T={__depends__:[Yo,zr],__init__:["lassoTool"],lassoTool:["type",yi]},Fs=1500,Tv="grab";function Zi(e,t,n,i,r,a){this._dragging=n,this._mouse=a;var o=this,s=i.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",Fs,function(u){if(!!Oi(u))return o.activateMove(u.originalEvent,!0),!1}),s&&s.addListener(Fs,function(u){if(!(!eh(u.keyEvent)||o.isActive())){var c=o._mouse.getLastMoveEvent();o.activateMove(c,!!c)}},"keyboard.keydown"),s&&s.addListener(Fs,function(u){!eh(u.keyEvent)||!o.isActive()||o.toggle()},"keyboard.keyup"),e.on("hand.end",function(u){var c=u.originalEvent.target;if(!u.hover&&!(c instanceof SVGElement))return!1;e.once("hand.ended",function(){o.activateMove(u.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(u){var c=t.viewbox().scale;t.scroll({dx:u.dx*c,dy:u.dy*c})}),e.on("hand.move.end",function(u){var c=u.context,l=c.reactivate;return!Oi(u)&&l&&e.once("hand.move.ended",function(p){o.activateHand(p.originalEvent,!0,!0)}),!1})}Zi.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"];Zi.prototype.activateMove=function(e,t,n){typeof t=="object"&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:Tv,data:{context:n||{}}})};Zi.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:Tv,data:{context:{reactivate:n}}})};Zi.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)};Zi.prototype.isActive=function(){var e=this._dragging.context();return e?/^(hand|hand\.move)$/.test(e.prefix):!1};function eh(e){return jt(" ",e)}var wT={__depends__:[Yo,zr],__init__:["handTool"],handTool:["type",Zi]},th="connect-ok",nh="connect-not-ok";function Ji(e,t,n,i,r,a,o){var s=this;this._dragging=t,this._rules=a,this._mouse=o,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(u){var c=u.context,l=u.hover,p=c.canStartConnect=s.canStartConnect(l);p!==null&&(c.startTarget=l,i.addMarker(l,p?th:nh))}),e.on(["global-connect.out","global-connect.cleanup"],function(u){var c=u.context.startTarget,l=u.context.canStartConnect;c&&i.removeMarker(c,l?th:nh)}),e.on(["global-connect.ended"],function(u){var c=u.context,l=c.startTarget,p={x:u.x,y:u.y},h=s.canStartConnect(l);if(!!h)return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,l,p)}),!1})}Ji.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"];Ji.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})};Ji.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)};Ji.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)};Ji.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};var ST={__depends__:[ec,cn,wn,Yo,zr],globalConnect:["type",Ji]};function el(e,t,n,i,r,a,o,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=r,this._handTool=a,this._globalConnect=o,this._translate=s,e.registerProvider(this)}el.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];el.prototype.getPaletteEntries=function(e){var t={},n=this._create,i=this._elementFactory,r=this._spaceTool,a=this._lassoTool,o=this._handTool,s=this._globalConnect,u=this._translate;function c(h,f,d,y,x){function M(w){var b=i.createShape(I({type:h},x));x&&(b.businessObject.di.isExpanded=x.isExpanded),n.start(w,b)}var P=h.replace(/^bpmn:/,"");return{group:f,className:d,title:y||u("Create {type}",{type:P}),action:{dragstart:M,click:M}}}function l(h){var f=i.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),d=i.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:f});n.start(h,[f,d],{hints:{autoSelect:[f]}})}function p(h){n.start(h,i.createParticipantShape())}return I(t,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:u("Activate the hand tool"),action:{click:function(h){o.activateHand(h)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:u("Activate the lasso tool"),action:{click:function(h){a.activateSelection(h)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:u("Activate the create/remove space tool"),action:{click:function(h){r.activateSelection(h)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:u("Activate the global connect tool"),action:{click:function(h){s.start(h)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":c("bpmn:StartEvent","event","bpmn-icon-start-event-none",u("Create StartEvent")),"create.intermediate-event":c("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",u("Create Intermediate/Boundary Event")),"create.end-event":c("bpmn:EndEvent","event","bpmn-icon-end-event-none",u("Create EndEvent")),"create.exclusive-gateway":c("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",u("Create Gateway")),"create.task":c("bpmn:Task","activity","bpmn-icon-task",u("Create Task")),"create.data-object":c("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",u("Create DataObjectReference")),"create.data-store":c("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",u("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:u("Create expanded SubProcess"),action:{dragstart:l,click:l}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:u("Create Pool/Participant"),action:{dragstart:p,click:p}},"create.group":c("bpmn:Group","artifact","bpmn-icon-group",u("Create Group"))}),t};var CT={__depends__:[xT,Bo,rv,_T,wT,ST,So],__init__:["paletteProvider"],paletteProvider:["type",el]},TT=250;function tl(e,t,n,i,r){U.call(this,e);function a(s){var u=s.canExecute.replacements;A(u,function(c){var l=c.oldElementId,p={type:c.newElementType};if(!s.visualReplacements[l]){var h=t.get(l);I(p,{x:h.x,y:h.y});var f=n.createShape(p);i.addShape(f,h.parent);var d=Oe('[data-element-id="'+ou(h.id)+'"]',s.dragGroup);d&&H(d,{display:"none"});var y=r.addDragger(f,s.dragGroup);s.visualReplacements[l]=y,i.removeShape(f)}})}function o(s){var u=s.visualReplacements;A(u,function(c,l){var p=Oe('[data-element-id="'+ou(l)+'"]',s.dragGroup);p&&H(p,{display:"inline"}),c.remove(),u[l]&&delete u[l]})}e.on("shape.move.move",TT,function(s){var u=s.context,c=u.canExecute;u.visualReplacements||(u.visualReplacements={}),c&&c.replacements?a(u):o(u)})}tl.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"];Z(tl,U);var AT={__depends__:[jr],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",tl]},RT=1250,ks=40,PT=20,DT=10,ih=20,Av=["x","y"],MT=Math.abs;function Rv(e){e.on(["connect.hover","connect.move","connect.end"],RT,function(t){var n=t.context,i=n.canExecute,r=n.start,a=n.hover,o=n.source,s=n.target;t.originalEvent&&bt(t.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),i&&a&&BT(t,a,FT(a)),a&&NT(i,["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"])?(n.connectionStart=Pt(r),ye(a,["bpmn:Event","bpmn:Gateway"])&&rh(t,Pt(a)),ye(a,["bpmn:Task","bpmn:SubProcess"])&&OT(t,a),v(o,"bpmn:BoundaryEvent")&&s===o.host&&IT(t)):Pv(i,"bpmn:MessageFlow")?(v(r,"bpmn:Event")&&(n.connectionStart=Pt(r)),v(a,"bpmn:Event")&&rh(t,Pt(a))):n.connectionStart=n.initialConnectionStart)})}Rv.$inject=["eventBus"];function BT(e,t,n){Av.forEach(function(i){var r=Dv(i,t);e[i]<t[i]+n?He(e,i,t[i]+n):e[i]>t[i]+r-n&&He(e,i,t[i]+r-n)})}function OT(e,t){var n=Pt(t);Av.forEach(function(i){kT(e,t,i)&&He(e,i,n[i])})}function IT(e){var t=e.context,n=t.source,i=t.target;if(!LT(t)){var r=Pt(n),a=tt(r,i,-10),o=[];/top|bottom/.test(a)&&o.push("x"),/left|right/.test(a)&&o.push("y"),o.forEach(function(s){var u=e[s],c;MT(u-r[s])<ks&&(u>r[s]?c=r[s]+ks:c=r[s]-ks,He(e,s,c))})}}function rh(e,t){He(e,"x",t.x),He(e,"y",t.y)}function Pv(e,t){return e&&e.type===t}function NT(e,t){return ci(t,function(n){return Pv(e,n)})}function Dv(e,t){return e==="x"?t.width:t.height}function FT(e){return v(e,"bpmn:Task")?DT:PT}function kT(e,t,n){return e[n]>t[n]+ih&&e[n]<t[n]+Dv(n,t)-ih}function LT(e){var t=e.hover,n=e.source;return t&&n&&t===n}function Zn(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}Zn.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]};Zn.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,this._snapLocations.indexOf(e)===-1&&this._snapLocations.push(e)};Zn.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)};Zn.prototype.getSnapLocations=function(){return this._snapLocations};Zn.prototype.setSnapLocations=function(e){this._snapLocations=e};Zn.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new as,n.initDefaults(this._defaultSnaps)),n};function as(e){this._snapValues={}}as.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),n.x.indexOf(t.x)===-1&&n.x.push(t.x),n.y.indexOf(t.y)===-1&&n.y.push(t.y)};as.prototype.snap=function(e,t,n,i){var r=this._snapValues[t];return r&&Z0(e[n],r[n],i)};as.prototype.initDefaults=function(e){var t=this;A(e||{},function(n,i){A(n,function(r){t.add(i,r)})})};var $T=1250;function ln(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(r){i.initSnap(r)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],$T,function(r){var a=r.context,o=a.shape,s=a.snapContext,u=a.target;if(!(r.originalEvent&&bt(r.originalEvent))&&!(Ii(r)||!u)){var c=s.pointsForTarget(u);c.initialized||(c=i.addSnapTargetPoints(c,o,u),c.initialized=!0),n.snap(r,c)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}ln.$inject=["elementRegistry","eventBus","snapping"];ln.prototype.initSnap=function(e){var t=this._elementRegistry,n=e.context,i=n.shape,r=n.snapContext;r||(r=n.snapContext=new Zn);var a;t.get(i.id)?a=Pt(i,e):a={x:e.x+Pt(i).x,y:e.y+Pt(i).y};var o={x:a.x-i.width/2,y:a.y-i.height/2},s={x:a.x+i.width/2,y:a.y+i.height/2};return r.setSnapOrigin("mid",{x:a.x-e.x,y:a.y-e.y}),_u(i)||(r.setSnapOrigin("top-left",{x:o.x-e.x,y:o.y-e.y}),r.setSnapOrigin("bottom-right",{x:s.x-e.x,y:s.y-e.y})),r};ln.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return A(i,function(r){if(_u(r)){_u(t)&&e.add("mid",Pt(r));return}if(jT(r)){if(r.waypoints.length<3)return;var a=r.waypoints.slice(1,-1);A(a,function(o){e.add("mid",o)});return}e.add("mid",Pt(r))}),!ae(t.x)||!ae(t.y)||this._elementRegistry.get(t.id)&&e.add("mid",Pt(t)),e};ln.prototype.getSnapTargets=function(e,t){return Kd(t).filter(function(n){return!HT(n)})};function jT(e){return!!e.waypoints}function HT(e){return!!e.hidden}function _u(e){return!!e.labelTarget}var ah=1500;function Qi(e,t){t.invoke(ln,this),e.on(["create.move","create.end"],ah,WT),e.on(["create.move","create.end","shape.move.move","shape.move.end"],ah,function(n){var i=n.context,r=i.canExecute,a=i.target,o=r&&(r==="attach"||r.attach);o&&!Ii(n)&&zT(n,a)})}Z(Qi,ln);Qi.$inject=["eventBus","injector"];Qi.prototype.initSnap=function(e){var t=ln.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return A(n.outgoing,function(r){var a=r.waypoints[0];a=a.original||a,t.setSnapOrigin(r.id+"-docking",sh(a,i,e))}),A(n.incoming,function(r){var a=r.waypoints[r.waypoints.length-1];a=a.original||a,t.setSnapOrigin(r.id+"-docking",sh(a,i,e))}),v(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t};Qi.prototype.addSnapTargetPoints=function(e,t,n){ln.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);A(i,function(a){(VT(a)||GT([t,a],"bpmn:TextAnnotation"))&&(e.add("top-left",Yd(a)),e.add("bottom-right",qd(a)))});var r=this._elementRegistry;return A(t.incoming,function(a){if(r.get(t.id)){oh(i,a.source)||e.add("mid",ue(a.source));var o=a.waypoints[0];e.add(a.id+"-docking",o.original||o)}}),A(t.outgoing,function(a){if(r.get(t.id)){oh(i,a.target)||e.add("mid",ue(a.target));var o=a.waypoints[a.waypoints.length-1];e.add(a.id+"-docking",o.original||o)}}),v(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e};Qi.prototype.getSnapTargets=function(e,t){return ln.prototype.getSnapTargets.call(this,e,t).filter(function(n){return!v(n,"bpmn:Lane")})};function zT(e,t){var n=ee(t),i=zm(e,t),r=e.context,a=r.shape,o;a.parent?o={x:0,y:0}:o=ue(a),/top/.test(i)?He(e,"y",n.top-o.y):/bottom/.test(i)&&He(e,"y",n.bottom-o.y),/left/.test(i)?He(e,"x",n.left-o.x):/right/.test(i)&&He(e,"x",n.right-o.x)}function GT(e,t){return e.every(function(n){return v(n,t)})}function VT(e){return v(e,"bpmn:SubProcess")&&Se(e)?!0:v(e,"bpmn:Participant")}function WT(e){var t=e.context,n=t.createConstraints;if(!!n){var i=n.top,r=n.right,a=n.bottom,o=n.left;(o&&o>=e.x||r&&r<=e.x)&&He(e,"x",e.x),(i&&i>=e.y||a&&a<=e.y)&&He(e,"y",e.y)}}function oh(e,t){return e.indexOf(t)!==-1}function sh(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}var UT=1250;function ia(e,t){var n=this;e.on(["resize.start"],function(i){n.initSnap(i)}),e.on(["resize.move","resize.end"],UT,function(i){var r=i.context,a=r.shape,o=a.parent,s=r.direction,u=r.snapContext;if(!(i.originalEvent&&bt(i.originalEvent))&&!Ii(i)){var c=u.pointsForTarget(o);c.initialized||(c=n.addSnapTargetPoints(c,a,o,s),c.initialized=!0),ZT(s)&&He(i,"x",i.x),JT(s)&&He(i,"y",i.y),t.snap(i,c)}}),e.on(["resize.cleanup"],function(){t.hide()})}ia.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,r=t.snapContext;r||(r=t.snapContext=new Zn);var a=Mv(n,i);return r.setSnapOrigin("corner",{x:a.x-e.x,y:a.y-e.y}),r};ia.prototype.addSnapTargetPoints=function(e,t,n,i){var r=this.getSnapTargets(t,n);return A(r,function(a){e.add("corner",qd(a)),e.add("corner",Yd(a))}),e.add("corner",Mv(t,i)),e};ia.$inject=["eventBus","snapping"];ia.prototype.getSnapTargets=function(e,t){return Kd(t).filter(function(n){return!YT(n,e)&&!qT(n)&&!KT(n)&&!XT(n)})};function Mv(e,t){var n=ue(e),i=ee(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function YT(e,t){return e.host===t}function qT(e){return!!e.waypoints}function KT(e){return!!e.hidden}function XT(e){return!!e.labelTarget}function ZT(e){return e==="n"||e==="s"}function JT(e){return e==="e"||e==="w"}var QT=7,eA=1e3;function Jn(e){this._canvas=e,this._asyncHide=hh(ft(this.hide,this),eA)}Jn.$inject=["canvas"];Jn.prototype.snap=function(e,t){var n=e.context,i=n.snapContext,r=i.getSnapLocations(),a={x:Ii(e,"x"),y:Ii(e,"y")};A(r,function(o){var s=i.getSnapOrigin(o),u={x:e.x+s.x,y:e.y+s.y};if(A(["x","y"],function(c){var l;a[c]||(l=t.snap(u,o,c,QT),l!==void 0&&(a[c]={value:l,originValue:l-s[c]}))}),a.x&&a.y)return!1}),this.showSnapLine("vertical",a.x&&a.x.value),this.showSnapLine("horizontal",a.y&&a.y.value),A(["x","y"],function(o){var s=a[o];Qe(s)&&He(e,o,s.originValue)})};Jn.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=J("path");return H(n,{d:"M0,0 L0,0"}),fe(n).add("djs-snap-line"),ne(t,n),{update:function(i){ae(i)?e==="horizontal"?H(n,{d:"M-100000,"+i+" L+100000,"+i,display:""}):H(n,{d:"M "+i+",-100000 L "+i+", +100000",display:""}):H(n,{display:"none"})}}};Jn.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}};Jn.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()};Jn.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]};Jn.prototype.hide=function(){A(this._snapLines,function(e){e.update()})};var tA={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",ln],resizeSnapping:["type",ia],snapping:["type",Jn]},nA={__depends__:[tA],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",Rv],createMoveSnapping:["type",Qi]};function ie(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=Ae(ie.BOX_HTML),this._searchInput=Oe(ie.INPUT_SELECTOR,this._container),this._resultsContainer=Oe(ie.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}ie.$inject=["canvas","eventBus","overlays","selection"];ie.prototype._bindEvents=function(){var e=this;function t(n,i,r,a){e._eventMaps.push({el:n,type:r,listener:xt.bind(n,i,r,a)})}t(document,"html","click",function(n){e.close()}),t(this._container,ie.INPUT_SELECTOR,"click",function(n){n.stopPropagation(),n.delegateTarget.focus()}),t(this._container,ie.RESULT_SELECTOR,"mouseover",function(n){n.stopPropagation(),e._scrollToNode(n.delegateTarget),e._preselect(n.delegateTarget)}),t(this._container,ie.RESULT_SELECTOR,"click",function(n){n.stopPropagation(),e._select(n.delegateTarget)}),t(this._container,ie.INPUT_SELECTOR,"keydown",function(n){n.keyCode===38&&n.preventDefault(),n.keyCode===40&&n.preventDefault()}),t(this._container,ie.INPUT_SELECTOR,"keyup",function(n){if(n.keyCode===27)return e.close();if(n.keyCode===13){var i=e._getCurrentResult();return i?e._select(i):e.close()}if(n.keyCode===38)return e._scrollToDirection(!0);if(n.keyCode===40)return e._scrollToDirection();n.keyCode===37||n.keyCode===39||e._search(n.delegateTarget.value)})};ie.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){xt.unbind(e.el,e.type,e.listener)})};ie.prototype._search=function(e){var t=this;if(this._clearResults(),!(!e||e==="")){var n=this._searchProvider.find(e);if(!!n.length){n.forEach(function(r){var a=r.element.id,o=t._createResultNode(r,a);t._results[a]={element:r.element,node:o}});var i=Oe(ie.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}};ie.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(!!t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}};ie.prototype._scrollToNode=function(e){if(!(!e||e===this._getCurrentResult())){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}};ie.prototype._clearResults=function(){fo(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")};ie.prototype._getCurrentResult=function(){return Oe(ie.RESULT_SELECTED_SELECTOR,this._resultsContainer)};ie.prototype._createResultNode=function(e,t){var n=Ae(ie.RESULT_HTML);return e.primaryTokens.length>0&&uh(n,e.primaryTokens,ie.RESULT_PRIMARY_HTML),uh(n,e.secondaryTokens,ie.RESULT_SECONDARY_HTML),St(n,ie.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n};ie.prototype.registerProvider=function(e){this._searchProvider=e};ie.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,ze(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))};ie.prototype.close=function(){!this.isOpen()||(this._unbindEvents(),this._open=!1,ze(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))};ie.prototype.toggle=function(){this.isOpen()?this.close():this.open()};ie.prototype.isOpen=function(){return this._open};ie.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&ze(t).remove(ie.RESULT_SELECTED_CLASS);var n=St(e,ie.RESULT_ID_ATTRIBUTE),i=this._results[n].element;ze(e).add(ie.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._canvas.scrollToElement(i,{top:400}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}};ie.prototype._select=function(e){var t=St(e,ie.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._canvas.scrollToElement(n,{top:400}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)};ie.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=et(e),n=iA(t);this._overlayId=this._overlays.add(e,n)}};function iA(e){var t=6,n=e.width+t*2,i=e.height+t*2,r=["width: "+n+"px","height: "+i+"px"].join("; ");return{position:{bottom:i-t,right:n-t},show:!0,html:'<div style="'+r+'" class="'+ie.OVERLAY_CLASS+'"></div>'}}function uh(e,t,n){var i=rA(t),r=Ae(n);r.innerHTML=i,e.appendChild(r)}function rA(e){var t="";return e.forEach(function(n){n.matched?t+='<strong class="'+ie.RESULT_HIGHLIGHT_CLASS+'">'+lp(n.matched)+"</strong>":t+=lp(n.normal)}),t!==""?t:null}ie.CONTAINER_SELECTOR=".djs-search-container";ie.INPUT_SELECTOR=".djs-search-input input";ie.RESULTS_CONTAINER_SELECTOR=".djs-search-results";ie.RESULT_SELECTOR=".djs-search-result";ie.RESULT_SELECTED_CLASS="djs-search-result-selected";ie.RESULT_SELECTED_SELECTOR="."+ie.RESULT_SELECTED_CLASS;ie.RESULT_ID_ATTRIBUTE="data-result-id";ie.RESULT_HIGHLIGHT_CLASS="djs-search-highlight";ie.OVERLAY_CLASS="djs-search-overlay";ie.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>';ie.RESULT_HTML='<div class="djs-search-result"></div>';ie.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>';ie.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';var aA={__depends__:[Wu,sn],searchPad:["type",ie]};function nl(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}nl.$inject=["elementRegistry","searchPad","canvas"];nl.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(i){return!i.labelTarget});return n=se(n,function(i){return i!==t}),n=Ye(n,function(i){return{primaryTokens:lh(Ut(i),e),secondaryTokens:lh(i.id,e),element:i}}),n=se(n,function(i){return ch(i.primaryTokens)||ch(i.secondaryTokens)}),n=Vt(n,function(i){return Ut(i.element)+i.element.id}),n};function ch(e){var t=se(e,function(n){return!!n.matched});return t.length>0}function lh(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var r=e.indexOf(t);return r>-1?(r!==0&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,t.length)}),t.length+r<e.length&&n.push({normal:i.substr(t.length+r,e.length)})):n.push({normal:i}),n}var oA={__depends__:[aA],__init__:["bpmnSearch"],bpmnSearch:["type",nl]},sA='<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>';function rn(e){Fr.call(this,e)}Z(rn,Fr);rn.Viewer=Gn;rn.NavigatedViewer=Cr;rn.prototype.createDiagram=Vi(function(){return this.importXML(sA)});rn.prototype._interactionModules=[xd,Cd,o0,Rd];rn.prototype._modelingModules=[u0,S0,F0,D0,Q0,ec,a_,lw,am,Bo,hw,vw,Ow,Fw,kw,zw,Qw,oT,mT,CT,AT,xm,nA,oA];rn.prototype._modules=[].concat(Gn.prototype._modules,rn.prototype._interactionModules,rn.prototype._modelingModules);const Ht=rg({activeElement:null,businessObject:null,activeBindDefine:null,isActive:!1});function ph(e,t){if(!Ht||!t)return;Ht.activeElement=t;const n=e.get(t.element.id);Ht.businessObject=n?n.businessObject:{},Ht.isActive=!0,Ht.activeBindDefine=n?vg[t.element.type]:null}const uA={modeler:null,state:Ht,getState(){return this.state},initModeler(e){this.modeler=new rn(e),this.modeler.get("keyboard").bind(document);const t=this.modeler.get("elementRegistry");["element.click","shape.added"].forEach(n=>{uA.addEventListener(n,function(i){const r=i.element||i.context.element;r&&(!Ht.activeElement||Ht.activeElement.id!==r.id)&&(Ht.businessObject=null,_l().then(()=>{ph(t,i)}))})})},getModeler(){return this.modeler},refresh(){Ht.businessObject=null,_l().then(()=>{ph(this.modeler.get("elementRegistry"),Ht.activeElement)})},getShape(){return this.getShapeById(this.getState().activeElement.element.id)},getShapeById(e){return this.getModeler().get("elementRegistry").get(e)},getBpmnFactory(){return this.modeler.get("bpmnFactory")},createElement(e,t,n,i){const r=this.getBpmnFactory().create(e,n);this.getModeling().updateProperties(this.getShape(),{[t]:i?[r]:r})},importXML(e){return this.modeler.importXML(e)},getXML(){return new Promise((e,t)=>{this.getModeler().saveXML({format:!0}).then(n=>{e(n)}).catch(n=>{t(n)})})},getSVG(){return new Promise((e,t)=>{this.getModeler().saveSVG().then(n=>{e(n)}).catch(n=>{t(n)})})},getModeling(){return this.getModeler().get("modeling")},getActiveElement(){return this.getState().activeElement},getActiveElementName(){const e=this.getBusinessObject();return e?wg(e):""},getBusinessObject(){return this.getState().businessObject},addEventListener(e,t){this.getModeler().get("eventBus").on(e,function(n){t(n)})},updateExtensionElements(e,t){var s,u;const n=this.getModeler().get("moddle"),i=this.getShape(),r=(s=this.getBusinessObject())==null?void 0:s.extensionElements,a=((u=r==null?void 0:r.values)==null?void 0:u.filter(c=>c.$type!==e).map(c=>ag(c)))||[],o=n.create("bpmn:ExtensionElements",{values:a.concat(t instanceof Array?t:[t])});this.getModeling().updateProperties(i,{extensionElements:o})}};export{uA as B,xg as T,hA as a,fA as c,dA as g};
