var ae=Object.defineProperty,oe=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var P=(s,d,p)=>d in s?ae(s,d,{enumerable:!0,configurable:!0,writable:!0,value:p}):s[d]=p,I=(s,d)=>{for(var p in d||(d={}))ne.call(d,p)&&P(s,p,d[p]);if(R)for(var p of R(d))ue.call(d,p)&&P(s,p,d[p]);return s},H=(s,d)=>oe(s,le(d));import{r as se,_ as T,s as E}from"./index.1652784183534.js";import{a as $,m as U,Z as e,a3 as O,ag as W,a2 as r,o as F,R as B,S as t,e as i,u as l,T as X,U as j,b as M,F as de,a7 as ie,W as A,Y as D,az as Y,aA as Z,X as b,ap as re,aB as pe,j as _e,O as ce,l as me}from"./vue.1652784183534.js";import{g as fe,a as he,c as be,B as k}from"./store.1652784183534.js";const G=(s,d)=>{s.mittBus.emit("onCurrentContextmenuClick",Object.assign({},I({contextMenuClickId:1},d)))},ge=async(s,d,p)=>{G(d,p),se.push({path:s.url+"/edit",query:{id:s.form.id}})};var ve=$({name:"Modeler2",emits:["bpmnMounted"],setup(s,{emit:d}){const p=k;return U(()=>{p.initModeler({container:"#modeler-container",additionalModules:[{translate:["value",fe("zh")],paletteProvider:["value",""],labelEditingProvider:["value",""],contextPadProvider:["value",""],bendpoints:["value",{}],zoomScroll:["value",""],move:["value",""]}],moddleExtensions:{activiti:he}});const n="1";p.importXML(be(n,n)).then(a=>{a.length&&console.warn("importSuccess warnings",a)}).catch(a=>{console.warn("importFail errors ",a)}),d("bpmnMounted")}),()=>e("div",{id:"modeler-container"},null)}});const z=s=>(Y("data-v-38ab64ab"),s=s(),Z(),s),xe=z(()=>i("div",{class:"zinput"}," xxxxxx ",-1)),ye={style:{"padding-left":"10px","border-right":"1px solid #ccc"}},we=b("\u663E\u793A\u5BA1\u6279\u8BB0\u5F55"),Fe={style:{"border-right":"1px solid #ccc"}},Ee={key:0},Ce={class:"zinput"},Be=z(()=>i("span",null,"\u4E00\u822C",-1)),Ve=z(()=>i("span",{style:{color:"blue"}},"\u6025",-1)),Ae=z(()=>i("span",{style:{color:"red"}},"\u7D27\u6025",-1)),De={class:"zinput"},ke=b("\u901A\u8FC7"),ze=b("\u9A73\u56DE"),Ne=b("\u8F6C\u529E"),Se=b("\u6C9F\u901A"),Ie=b("\u5E9F\u5F03"),Me={class:"zinput"},$e=b("\u9A73\u56DE\u7684\u8282\u70B9\u901A\u8FC7\u540E\u76F4\u63A5\u8FD4\u56DE\u672C\u8282\u70B9"),Ue={class:"zinput"},Le={class:"zinput",style:{height:"auto"}},qe={class:"au-flex"},Re={class:"au-msg",style:{padding:"3px"}},Pe={class:"au-button"},He=b("\u63D0 \u4EA4"),Xe={class:"zinput",style:{height:"auto"}},je=b("\u4E0A \u4F20"),Te={class:"zinput"},Oe={class:"zinput"},We={style:{"padding-left":"10px","border-right":"1px solid #ccc"}},Ye=b("\u6D41\u7A0B\u56FE"),Ze={style:{padding:"10px","border-right":"1px solid #ccc",height:"1000px"}},Ge=$({props:{proid:String},emits:["submit"],setup(s,{emit:d}){const p=s,n=O({form:{items:[]},params:{path:"",query:""},audits:[],chtag:!1,autag:!0,xml:null,refNodes:[],cutag:!1,hiHamen:"",cuExmen:"",toExmen:""}),{form:a,params:N,audits:V}=W(n);n.refNodes=[{id:"N2",name:"\u8D77\u8349\u8282\u70B9",exman:"sa"},{id:"N4",name:"\u5F20\u4E09",exman:"z3"},{id:"N5",name:"\u738B\u4E94",exman:"w5"}],U(async()=>{await S()});const S=async()=>{const u=await E({url:"/bpm/proc/main/zbpm/"+p.proid,method:"get"});if(V.value=u.audits,n.hiHamen=u.hiHamen,n.cuExmen=u.cuExmen,n.cutag=u.cutag,a.value=u.zbpm,n.cutag){const o=await E({url:"/bpm/proc/main/target",method:"get",params:{proid:a.value.proid,facno:a.value.facno}});a.value.tarno=o.tarno,a.value.tarna=o.tarna,a.value.tamen=o.tamen,a.value.bacid=o.bacid,o.tarno=="N3"?n.toExmen=o.tarno+"."+o.tarna:n.toExmen=o.tarno+"."+o.tarna+"("+o.tamen+")",a.value.opkey="pass",a.value.opurg="a"}},v=async()=>{if(console.log("86811"),d("submit"),console.log("86822"),a.value.opkey=="pass")await E({url:"/bpm/proc/main/hpass",method:"post",data:a.value});else if(a.value.opkey=="refuse"){const u=re(a.value);u.tarno=u.refno,u.tarna=u.refna,u.exman=u.reman,await E({url:"/bpm/proc/main/hrefuse",method:"post",data:u})}},g=async()=>{if(!n.xml){n.xml=await E({url:"/bpm/proc/main/xml/"+p.proid,method:"get"}),await k.importXML(n.xml);const u=k.getModeler().get("elementRegistry");console.log(u);const o=[];u.forEach(f=>{(f.id=="L7"||f.id=="N1"||f.id=="N2")&&o.push(f)});const h=[];u.forEach(f=>{f.id=="N4"&&h.push(f)});const _=[];u.forEach(f=>{(f.id=="L1"||f.id=="L3")&&_.push(f)});let c=k.modeler.get("modeling");c.setColor(o,{fill:"#e4feef"}),c.setColor(h,{fill:"#fed6d6"}),c.setColor(_,{stroke:"#009900"})}},x=u=>{for(let o=0;o<n.refNodes.length;o++)if(n.refNodes[o].id==u){a.value.refna=n.refNodes[o].name,a.value.reman=n.refNodes[o].exman;break}};return(u,o)=>{const h=r("el-form-item"),_=r("el-col"),c=r("el-row"),f=r("el-checkbox"),y=r("el-table-column"),C=r("el-table"),w=r("el-radio"),L=r("el-radio-group"),J=r("el-option"),K=r("el-select"),Q=r("el-input"),q=r("el-button"),ee=r("el-upload"),te=r("el-form");return F(),B(te,{class:"zform",model:l(a),"label-width":"160px","label-position":"left"},{default:t(()=>[e(c,{style:{"border-top":"1px solid #d2d2d2"}},{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u6D41\u7A0B\u8BF4\u660E",style:{"margin-left":"10px"}},{default:t(()=>[xe]),_:1})]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(_,{span:24},{default:t(()=>[i("div",ye,[e(f,{modelValue:l(n).autag,"onUpdate:modelValue":o[0]||(o[0]=m=>l(n).autag=m)},{default:t(()=>[we]),_:1},8,["modelValue"])])]),_:1})]),_:1}),X(e(c,null,{default:t(()=>[e(_,{span:24,style:{"background-color":"white"}},{default:t(()=>[i("div",Fe,[e(C,{data:l(V),style:{width:"100%"}},{default:t(()=>[e(y,{prop:"crtim",label:"\u65F6\u95F4",width:"160"}),e(y,{prop:"facno",label:"\u8282\u70B9\u7F16\u53F7",width:"80"}),e(y,{prop:"facna",label:"\u8282\u70B9\u540D\u79F0",width:"200"}),e(y,{prop:"haman",label:"\u64CD\u4F5C\u8005",width:"90"}),e(y,{prop:"opinf",label:"\u64CD\u4F5C",width:"300"}),e(y,{prop:"opnot",label:"\u5904\u7406\u610F\u89C1"})]),_:1},8,["data"])])]),_:1})]),_:1},512),[[j,l(n).autag]]),l(n).cutag?(F(),M("div",Ee,[e(c,null,{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u901A\u77E5\u7D27\u6025\u7A0B\u5EA6",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Ce,[e(L,{modelValue:l(a).opurg,"onUpdate:modelValue":o[1]||(o[1]=m=>l(a).opurg=m)},{default:t(()=>[e(w,{label:"a"},{default:t(()=>[Be]),_:1}),e(w,{label:"b"},{default:t(()=>[Ve]),_:1}),e(w,{label:"c"},{default:t(()=>[Ae]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u64CD\u4F5C",style:{"margin-left":"10px"}},{default:t(()=>[i("div",De,[e(L,{modelValue:l(a).opkey,"onUpdate:modelValue":o[2]||(o[2]=m=>l(a).opkey=m)},{default:t(()=>[e(w,{label:"pass"},{default:t(()=>[ke]),_:1}),e(w,{label:"refuse"},{default:t(()=>[ze]),_:1}),e(w,{label:"commission"},{default:t(()=>[Ne]),_:1}),e(w,{label:"communicate"},{default:t(()=>[Se]),_:1}),e(w,{label:"abandon"},{default:t(()=>[Ie]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1}),l(a).opkey=="refuse"?(F(),B(c,{key:0},{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u9A73\u56DE\u5230",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Me,[e(K,{modelValue:l(a).refno,"onUpdate:modelValue":o[3]||(o[3]=m=>l(a).refno=m),placeholder:"\u8BF7\u9009\u62E9",style:{width:"300px","margin-right":"8px"},onChange:x},{default:t(()=>[(F(!0),M(de,null,ie(l(n).refNodes,m=>(F(),B(J,{key:m.id,value:m.id,label:m.id+"."+m.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),e(f,{modelValue:l(a).retag,"onUpdate:modelValue":o[4]||(o[4]=m=>l(a).retag=m)},{default:t(()=>[$e]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1})):A("",!0),l(a).opkey=="pass"?(F(),B(c,{key:1},{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u5373\u5C06\u6D41\u5411",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Ue,D(l(n).toExmen),1)]),_:1})]),_:1})]),_:1})):A("",!0),e(c,null,{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u5904\u7406\u610F\u89C1",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Le,[i("div",qe,[i("div",Re,[e(Q,{modelValue:l(a).opnot,"onUpdate:modelValue":o[5]||(o[5]=m=>l(a).opnot=m),type:"textarea",rows:4,placeholder:" "},null,8,["modelValue"])]),i("div",Pe,[e(q,{type:"primary",onClick:o[6]||(o[6]=m=>v()),style:{width:"94px",height:"94px","margin-top":"3px","margin-left":"6px"}},{default:t(()=>[He]),_:1})])])])]),_:1})]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u9644\u4EF6",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Xe,[e(ee,{class:"upload-demo",action:"https://jsonplaceholder.typicode.com/posts/","file-list":u.fileList},{default:t(()=>[e(q,{type:"primary"},{default:t(()=>[je]),_:1})]),_:1},8,["file-list"])])]),_:1})]),_:1})]),_:1})])):A("",!0),e(c,null,{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u5F53\u524D\u5904\u7406\u4EBA",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Te,D(l(a).facno+"."+l(a).facna+"("+l(n).cuExmen+")"),1)]),_:1})]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(_,{span:24},{default:t(()=>[e(h,{label:"\u5DF2\u7ECF\u5904\u7406\u4EBA",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Oe,D(l(n).hiHamen),1)]),_:1})]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(_,{span:24},{default:t(()=>[i("div",We,[e(f,{modelValue:l(n).chtag,"onUpdate:modelValue":o[7]||(o[7]=m=>l(n).chtag=m),onChange:g},{default:t(()=>[Ye]),_:1},8,["modelValue"])])]),_:1})]),_:1}),X(e(c,null,{default:t(()=>[e(_,{span:24,style:{"background-color":"white"}},{default:t(()=>[i("div",Ze,[e(l(ve))])]),_:1})]),_:1},512),[[j,l(n).chtag]])]),_:1},8,["model"])}}});var Je=T(Ge,[["__scopeId","data-v-38ab64ab"]]);const Ke=s=>(Y("data-v-9deab12e"),s=s(),Z(),s),Qe=Ke(()=>i("div",{style:{"line-height":"32px"}},"\u6D41\u7A0B\u5B9E\u4F8B",-1)),et=b("\u7F16 \u8F91"),tt=b("\u5173 \u95ED"),at={style:{"margin-top":"8px","margin-bottom":"8px"}},ot={class:"zinput"},lt=["src"],nt={name:"oaFlowMainView"},ut=$(H(I({},nt),{setup(s){const d=pe(),{proxy:p}=me(),n=O({url:"/oa/flow/main",params:{path:"",query:""},form:{}}),{form:a}=W(n),N=_e("tab1"),V=async(v,g)=>{var u;v.params=g;let x=(u=v.params.query)==null?void 0:u.id;x&&(v.form=await E({url:v.url+"/one/"+x,method:"get"}))},S=()=>{console.log("submit")};return U(()=>{V(n,d)}),(v,g)=>{const x=r("el-col"),u=r("el-button"),o=r("el-row"),h=r("el-form-item"),_=r("el-tab-pane"),c=r("el-tabs"),f=r("el-form"),y=r("el-card");return F(),M("div",{style:ce({height:"calc(100vh)"}),class:"zpage"},[e(y,{class:"box-card","body-style":{padding:"2px 8px"},shadow:"never"},{header:t(()=>[e(o,null,{default:t(()=>[e(x,{span:10},{default:t(()=>[Qe]),_:1}),e(x,{span:14,style:{"text-align":"right"}},{default:t(()=>[e(u,{type:"success",onClick:g[0]||(g[0]=C=>l(ge)(l(n),l(p),l(d))),plain:""},{default:t(()=>[et]),_:1}),e(u,{type:"info",onClick:g[1]||(g[1]=C=>l(G)(l(p),l(d))),plain:""},{default:t(()=>[tt]),_:1})]),_:1})]),_:1})]),default:t(()=>[i("div",at,[e(f,{class:"zform",model:l(a),"label-width":"140px"},{default:t(()=>[e(c,{type:"card",modelValue:N.value,"onUpdate:modelValue":g[2]||(g[2]=C=>N.value=C)},{default:t(()=>[e(_,{label:"\u5BA1\u6279\u5185\u5BB9",name:"tab1"},{default:t(()=>[e(o,{style:{"border-top":"1px solid #d2d2d2"}},{default:t(()=>[e(x,{span:24},{default:t(()=>[e(h,{label:"\u7533\u8BF7\u6807\u9898\uFF1A",prop:"name",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:t(()=>[i("div",ot,D(l(a).name),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{label:"\u6D41\u7A0B\u5904\u7406",name:"tab2"},{default:t(()=>[l(a).id?(F(),B(Je,{key:0,onSubmit:S,proid:l(a).id},null,8,["proid"])):A("",!0)]),_:1}),e(_,{label:"\u6743\u9650\u4FE1\u606F",name:"tab3"},{default:t(()=>[i("img",{src:v.qx,style:{width:"100%"}},null,8,lt)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])])]),_:1})],4)}}}));var pt=T(ut,[["__scopeId","data-v-9deab12e"]]);export{pt as default};
